"use strict";(self.webpackChunkmy_doc=self.webpackChunkmy_doc||[]).push([[8965],{66323:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>l,default:()=>o,frontMatter:()=>r,metadata:()=>i,toc:()=>d});var a=n(85893),t=n(11151);const r={sidebar_label:"Projet",sidebar_position:91,sidebar_class_name:"hidden"},l="Projet",i={id:"courses/university/gif-7005/projet",title:"Projet",description:"Objectif du projet",source:"@site/docs/courses/university/gif-7005/projet.md",sourceDirName:"courses/university/gif-7005",slug:"/courses/university/gif-7005/projet",permalink:"/docs/courses/university/gif-7005/projet",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/courses/university/gif-7005/projet.md",tags:[],version:"current",sidebarPosition:91,frontMatter:{sidebar_label:"Projet",sidebar_position:91,sidebar_class_name:"hidden"},sidebar:"tutorialSidebar",previous:{title:"Examen final 2016",permalink:"/docs/courses/university/gif-7005/examen-2016"},next:{title:"IFT-7022 Traitement automatique de la langue naturelle",permalink:"/docs/courses/university/ift-7022/"}},c={},d=[{value:"Objectif du projet",id:"objectif-du-projet",level:2},{value:"Donn\xe9es",id:"donn\xe9es",level:2},{value:"D\xe9marche utilis\xe9e",id:"d\xe9marche-utilis\xe9e",level:2},{value:"R\xe9f\xe9rences",id:"r\xe9f\xe9rences",level:2},{value:"\xc9tape 0 - Initialisation",id:"\xe9tape-0---initialisation",level:2},{value:"D\xe9finir les param\xe8tres du mod\xe8le",id:"d\xe9finir-les-param\xe8tres-du-mod\xe8le",level:3},{value:"Ressource GPU",id:"ressource-gpu",level:3},{value:"Installer les biblioth\xe8ques requises",id:"installer-les-biblioth\xe8ques-requises",level:3},{value:"Monter Google Drive dans la machine virtuelle",id:"monter-google-drive-dans-la-machine-virtuelle",level:3},{value:"Cr\xe9er un sous-ensemble des donn\xe9es",id:"cr\xe9er-un-sous-ensemble-des-donn\xe9es",level:3},{value:"Charger le sous-ensemble de donn\xe9es",id:"charger-le-sous-ensemble-de-donn\xe9es",level:3},{value:"\xc9tape 2 - Analyse exploratoire des donn\xe9es (EDA)",id:"\xe9tape-2---analyse-exploratoire-des-donn\xe9es-eda",level:2},{value:"Donn\xe9es de navigation",id:"donn\xe9es-de-navigation",level:3},{value:"Donn\xe9es de recherche",id:"donn\xe9es-de-recherche",level:3},{value:"Donn\xe9es sur les produits",id:"donn\xe9es-sur-les-produits",level:3},{value:"\xc9tape 3 - Nettoyage des donn\xe9es",id:"\xe9tape-3---nettoyage-des-donn\xe9es",level:2},{value:"\xc9tape 4 - Ing\xe9nierie des attributs",id:"\xe9tape-4---ing\xe9nierie-des-attributs",level:2},{value:"\xc9tape 5 - Fusion des donn\xe9es",id:"\xe9tape-5---fusion-des-donn\xe9es",level:2},{value:"Fonctions utilitaires",id:"fonctions-utilitaires",level:3},{value:"Regrouper les produits avec moins de cinq interactions",id:"regrouper-les-produits-avec-moins-de-cinq-interactions",level:3},{value:"Normalisation des vecteurs",id:"normalisation-des-vecteurs",level:3},{value:"\xc9tape 7 - Cr\xe9ation des s\xe9quences et tokenisation",id:"\xe9tape-7---cr\xe9ation-des-s\xe9quences-et-tokenisation",level:2},{value:"Tokenisation des s\xe9quences de texte",id:"tokenisation-des-s\xe9quences-de-texte",level:3},{value:"Cr\xe9ation des tenseurs",id:"cr\xe9ation-des-tenseurs",level:3},{value:"\xc9tape 8 - Division en ensembles d&#39;entra\xeenement, de validation et de test",id:"\xe9tape-8---division-en-ensembles-dentra\xeenement-de-validation-et-de-test",level:2},{value:"\xc9tape 9 - Cr\xe9ation du mod\xe8le",id:"\xe9tape-9---cr\xe9ation-du-mod\xe8le",level:2},{value:"\xc9tape 10 - Cr\xe9ation des DataLoaders",id:"\xe9tape-10---cr\xe9ation-des-dataloaders",level:2},{value:"\xc9tape 11 - \xc9valuations du mod\xe8le",id:"\xe9tape-11---\xe9valuations-du-mod\xe8le",level:2},{value:"Mean Reciprocal Rank (MRR@20)",id:"mean-reciprocal-rank-mrr20",level:3},{value:"Precision@20, Recall@20 et F1 score",id:"precision20-recall20-et-f1-score",level:3},{value:"Fonctions d&#39;\xe9valuation",id:"fonctions-d\xe9valuation",level:3},{value:"\xc9tape 12 - Entra\xeenement du mod\xe8le",id:"\xe9tape-12---entra\xeenement-du-mod\xe8le",level:2},{value:"\xc9tape 13 - \xc9valuation sur l&#39;ensemble de test",id:"\xe9tape-13---\xe9valuation-sur-lensemble-de-test",level:2},{value:"R\xe9f\xe9rences et ressources",id:"r\xe9f\xe9rences-et-ressources",level:2}];function m(e){const s={a:"a",annotation:"annotation",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mover:"mover",mrow:"mrow",mspace:"mspace",msqrt:"msqrt",mstyle:"mstyle",msub:"msub",msubsup:"msubsup",msup:"msup",mtable:"mtable",mtd:"mtd",mtext:"mtext",mtr:"mtr",munderover:"munderover",ol:"ol",p:"p",path:"path",pre:"pre",semantics:"semantics",span:"span",strong:"strong",svg:"svg",ul:"ul",...(0,t.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.h1,{id:"projet",children:"Projet"}),"\n",(0,a.jsx)(s.h2,{id:"objectif-du-projet",children:"Objectif du projet"}),"\n",(0,a.jsx)(s.p,{children:"Le projet vise \xe0 d\xe9velopper un mod\xe8le pr\xe9dictif pour les interactions futures des utilisateurs sur un site de commerce \xe9lectronique, utilisant un large ensemble de donn\xe9es fourni par Coveo. Cette base de donn\xe9es comprend plus de 30 millions d'interactions avec des produits, enrichies de m\xe9tadonn\xe9es catalogu\xe9es et de comportements de recherche d\xe9taill\xe9s. Elle inclut non seulement les clics sur les produits apr\xe8s une recherche, mais aussi les visualisations sans clics, offrant une perspective unique sur la r\xe9troaction n\xe9gative des utilisateurs. L'enjeu principal est de pr\xe9dire les interactions des utilisateurs sur la base de leurs actions pr\xe9c\xe9dentes et de leurs recherches au sein d'une session."}),"\n",(0,a.jsx)(s.h2,{id:"donn\xe9es",children:"Donn\xe9es"}),"\n",(0,a.jsxs)(s.p,{children:["Notre projet utilise les donn\xe9es issues de la comp\xe9tition ",(0,a.jsx)(s.a,{href:"https://github.com/coveooss/SIGIR-ecom-data-challenge",children:"SIGIR eCOM 2021"}),", organis\xe9e par Coveo. Cette base de donn\xe9es, disponible pour des fins de recherche, a \xe9t\xe9 publi\xe9e dans le cadre du Data Challenge SIGIR eCom 2021 et est accessible publiquement pour des utilisations acad\xe9miques et de recherche. Notre utilisation de ces donn\xe9es suit les termes et conditions \xe9tablis par Coveo, comme sp\xe9cifi\xe9 dans leur ",(0,a.jsx)(s.a,{href:"https://www.coveo.com/en/ailabs/sigir-ecom-data-challenge",children:"d\xe9claration de licence"}),". Ces donn\xe9es jouent un r\xf4le essentiel dans notre projet, nous permettant de d\xe9velopper et de tester nos solutions avec un ensemble de donn\xe9es riche et vari\xe9, repr\xe9sentatif des d\xe9fis r\xe9els du domaine du commerce \xe9lectronique."]}),"\n",(0,a.jsx)(s.p,{children:"Ces donn\xe9es sont constitu\xe9es de trois fichiers CSV, chacun offrant des perspectives uniques et compl\xe9mentaires sur le comportement des utilisateurs et les caract\xe9ristiques des produits dans le cadre du commerce \xe9lectronique :"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"browsing_train.csv"})," : Ce fichier contient des donn\xe9es sur le parcours de navigation des utilisateurs sur le site, incluant des informations telles que les clics, les ajouts au panier, et les achats. Il fournit une vue d\xe9taill\xe9e sur le comportement des utilisateurs en interaction avec les produits."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"search_train.csv"})," : Ce fichier se concentre sur les activit\xe9s de recherche des utilisateurs, enregistrant les requ\xeates saisies et les interactions avec les r\xe9sultats de recherche. Il est essentiel pour comprendre comment les utilisateurs cherchent des produits et r\xe9agissent aux r\xe9sultats pr\xe9sent\xe9s."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"sku_to_content.csv"})," : Ce fichier fait le lien entre les identifiants des produits (SKU) et leur contenu descriptif. Il offre une compr\xe9hension d\xe9taill\xe9e des caract\xe9ristiques des produits, essentielle pour analyser la relation entre les attributs des produits et le comportement des utilisateurs."]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["Plus concr\xe8tement, le fichier ",(0,a.jsx)(s.code,{children:"browsing_train.csv"})," compte 36\xa0079\xa0307 \xe9v\xe9nements de navigation dans une session sur un site de commerce \xe9lectronique. Les colonnes de ce fichier sont :"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"session_id_hash"})," (string) : Identifiant hach\xe9 de la session d'achat."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"event_type"})," (enum) : Type d'\xe9v\xe9nement. Soit ",(0,a.jsx)(s.code,{children:"pageview"})," pour la consultation d'une page ou ",(0,a.jsx)(s.code,{children:"event_product"}),"\npour une action sur un produit."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"product_action"})," (enum) : Si ",(0,a.jsx)(s.code,{children:"event-type"})," est \xe9gal \xe0 ",(0,a.jsx)(s.code,{children:"event_product"}),", alors cette colonne contient l'action sur un produit. Soit ",(0,a.jsx)(s.code,{children:"detail"})," pour consulter la fiche descriptive d'un produit, ",(0,a.jsx)(s.code,{children:"add"})," pour ajouter un produit dans un panier d'achat, ",(0,a.jsx)(s.code,{children:"purchase"})," pour acheter un produit, ",(0,a.jsx)(s.code,{children:"remove"})," pour supprimer un produit du panier d'achat."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"product_sku_hash"})," (string) : Si ",(0,a.jsx)(s.code,{children:"product_action"})," non vide, alors cette colonne contient l'identifiant hach\xe9 du produit de l'\xe9v\xe9nement."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"server_timestamp_epoch_ms"})," (int) : Horodatage en millisecondes."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"hashed_url"})," (string) : URL hach\xe9e de la page web."]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["Le fichier ",(0,a.jsx)(s.code,{children:"search_train.csv"})," contient 819\xa0516 interactions bas\xe9es sur la recherche.\nChaque ligne  est un \xe9v\xe9nement de requ\xeate de recherche \xe9mis par un utilisateur, qui comprend un tableau de r\xe9sultats.\nLes colonnes de ce fichier sont :"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"session_id_hash"})," (string) : Identifiant hach\xe9 de la session d'achat."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"server_timestamp_epoch_ms"})," (int) : Horodatage en millisecondes."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"query_vector"})," (vector) : Une repr\xe9sentation dense de la requ\xeate de recherche, obtenue gr\xe2ce \xe0 des techniques standard de mod\xe9lisation pr\xe9-entra\xeen\xe9e et de r\xe9duction de dimensionnalit\xe9."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"product_skus_hash"})," (list) : Identifiants hach\xe9s des produits affich\xe9s dans la r\xe9ponse de recherche."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"clicked_skus_hash"})," (list) : Identifiants hach\xe9s des produits cliqu\xe9s apr\xe8s avoir \xe9mis la requ\xeate de recherche."]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["Le fichier ",(0,a.jsx)(s.code,{children:"sku_to_content.csv"})," contient des informations sur 66\xa0386 produits dont des repr\xe9sentations dense des m\xe9tadonn\xe9es textuelles et images du catalogue r\xe9el. Les colonnes de ce fichier sont :"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"product_sku_hash"})," (string) : Identifiant hach\xe9 du produit."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"category_hash"})," (string) : Les cat\xe9gories sont des repr\xe9sentations hach\xe9es de la hi\xe9rarchie des cat\xe9gories, s\xe9par\xe9es par le caract\xe8re '/'."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"price_bucket"})," (int) : Le prix du produit, fournir sous forme d'entier de 10 quantiles."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"description_vector"})," (vector) : Une repr\xe9sentation dense de m\xe9tadonn\xe9es textuelles, obtenue gr\xe2ce \xe0 des techniques standard de mod\xe9lisation pr\xe9-entra\xeen\xe9e et de r\xe9duction de dimensionnalit\xe9, compatible avec celle du fichier de recherche."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"image_vector"})," (vector) : Une repr\xe9sentation dense des m\xe9tadonn\xe9es d'image, obtenue gr\xe2ce \xe0 des techniques standard de mod\xe9lisation pr\xe9-entra\xeen\xe9e et de r\xe9duction de dimensionnalit\xe9."]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"d\xe9marche-utilis\xe9e",children:"D\xe9marche utilis\xe9e"}),"\n",(0,a.jsx)(s.p,{children:"Ensuite, pour d\xe9velopper notre solution, nous avons r\xe9alis\xe9 les \xe9tapes suivantes :"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"\xc9tape 0 - Initialisation"})," : Importation des librairies requises, d\xe9finition des r\xe9pertoires, d\xe9claration de fonctions utilitaires et cr\xe9ation de sous-ensembles de dimensions g\xe9rables."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"\xc9tape 1 - Chargement des donn\xe9es"})," : Chargement des fichiers ",(0,a.jsx)(s.code,{children:"browsing_train.csv"}),", ",(0,a.jsx)(s.code,{children:"search_train.csv"}),", ",(0,a.jsx)(s.code,{children:"sku_to_content.csv"})," et cr\xe9ation des DataFrames ",(0,a.jsx)(s.code,{children:"browsing"}),", ",(0,a.jsx)(s.code,{children:"search"})," et ",(0,a.jsx)(s.code,{children:"product"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"\xc9tape 2 - Analyse exploratoire des donn\xe9es (EDA)"})," : Exploration des DataFrames, notamment leurs distributions, les valeurs manquantes, les anomalies, etc."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"\xc9tape 3 - Nettoyage des donn\xe9es"})," : Gestion des valeurs manquantes, supression des doublons."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"\xc9tape 4 - Ing\xe9nierie des attributs"})," : Convertion de cha\xeenes de caract\xe8res en listes, cr\xe9ation de caract\xe9ristiques."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"\xc9tape 5 - Fusion des donn\xe9es"})," : Fusion des trois ensembles (navigation, recherche et produits) en un seul ensemble,\no\xf9 chaque ligne repr\xe9sente un \xe9v\xe9nement d'une session."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"\xc9tape 6 - Agr\xe9gation apr\xe8s fusion"})," : Agr\xe9gation des donn\xe9es par session,\no\xf9 chaque ligne contient toutes les s\xe9quences d'\xe9v\xe9nements d'une session. D'autres caract\xe9ristiques sont \xe9galement cr\xe9\xe9es."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"\xc9tape 7 - Cr\xe9ation des s\xe9quences et tokenisation"})," : Cr\xe9ation des s\xe9quences d'interaction pour l'entra\xeenement,\nles interaction suivantes \xe0 pr\xe9dire et les interactions futures pour l'\xe9valation de la performance du mod\xe8le. Tokenisation de ces ensembles."]}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.strong,{children:"\xc9tape 8 - Division en ensembles d'entra\xeenement, de validation et de test"})}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"\xc9tape 9 - Cr\xe9ation du mod\xe8le"})," : Cr\xe9ation d'un mod\xe8le XLNet."]}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.strong,{children:"\xc9tape 10 - Cr\xe9ation des DataLoaders"})}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"\xc9tape 11 - Entra\xeenement du mod\xe8le"})," : Entra\xeenement du mod\xe8le sur l'ensemble d'entra\xeenement et \xe9valuation des performances sur l'ensemble de validation."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"\xc9tape 12 - Hyperparam\xe9trage"})," : Ajustement pour optimiser les performances."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"\xc9tape 13 - \xc9valuation sur l'ensemble de test"})," : Mesurer l'efficacit\xe9 sur des donn\xe9es non vues."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"\xc9tape 14 - Analyse d'erreur post-entra\xeenement"})," : Comprendre et am\xe9liorer les pr\xe9dictions."]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["Chacune des \xe9tapes est d\xe9crite plus en d\xe9tail ci-dessous. Apr\xe8s la plupart des \xe9tapes, nous ",(0,a.jsx)(s.strong,{children:"r\xe9capitulons"})," les transformations, ",(0,a.jsx)(s.strong,{children:"sauvegardons et r\xe9cup\xe9rons"})," les donn\xe9es pour \xe9viter d'avoir \xe0 recommencer depuis le d\xe9but advenant un probl\xe8me."]}),"\n",(0,a.jsx)(s.h2,{id:"r\xe9f\xe9rences",children:"R\xe9f\xe9rences"}),"\n",(0,a.jsx)(s.p,{children:"Pour r\xe9aliser ce projet, nous avons utilis\xe9 les r\xe9f\xe9rences suivantes :"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Coveo, information sur une comp\xe9tition utilisant les m\xeames donn\xe9es","\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"https://github.com/coveooss/SIGIR-ecom-data-challenge",children:"SIGIR eCOM 2021 Data Challenge Dataset"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"https://arxiv.org/abs/2104.09423",children:"SIGIR 2021 E-Commerce Workshop Data Challenge"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["Solution de NVIDIA Merlin","\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"https://medium.com/nvidia-merlin/winning-the-sigir-ecommerce-challenge-on-session-based-recommendation-with-transformers-v2-793f6fac2994",children:"Winning the SIGIR eCommerce Challenge on session-based recommendation with Transformers"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"https://arxiv.org/abs/2107.05124",children:"Paper"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"https://github.com/NVIDIA-Merlin/competitions/tree/main/SIGIR_eCommerce_Challenge_2021",children:"GitHub"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["Mod\xe8le ",(0,a.jsx)(s.a,{href:"https://huggingface.co/xlnet-base-cased",children:"xlnet-base-cased"})," de Hugging Face"]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"\xe9tape-0---initialisation",children:"\xc9tape 0 - Initialisation"}),"\n",(0,a.jsx)(s.h3,{id:"d\xe9finir-les-param\xe8tres-du-mod\xe8le",children:"D\xe9finir les param\xe8tres du mod\xe8le"}),"\n",(0,a.jsxs)(s.p,{children:["Les donn\xe9es sources de la comp\xe9tition doivent \xeatre plac\xe9es dans le r\xe9pertoire ",(0,a.jsx)(s.code,{children:'param["folder"]/train'})," de cette fa\xe7on."]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.code,{children:'folder = Path(params["folder"])'})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.code,{children:"folder/train/browsing_train.csv"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.code,{children:"folder/train/search_train.csv"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.code,{children:"folder/train/sku_to_content.csv"})}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["Dans le code ci-dessous, remplacez ",(0,a.jsx)(s.code,{children:"params['folder']"})," en cons\xe9quence."]}),"\n",(0,a.jsx)(s.p,{children:"Le sous-ensemble de 1000 sessions sera situ\xe9 dans :"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.code,{children:"folder/sample_1000/browsing_train.csv"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.code,{children:"folder/sample_1000/search_train.csv"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.code,{children:"folder/sample_1000/sku_to_content.csv"})}),"\n"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'params = {\n    "folder": "/gdrive/MyDrive/University/GIF-7005",\n    "sample_size": 1000,\n    "max_features": 10,\n    "max_seq_length": 575,\n    "model_name": "xlnet-base-cased",\n    "test_size": 0.2,\n    "validation_size": 0.2,\n    "batch_size": 4,\n    "epochs": 12,\n    "learning_rate": 2e-5,\n    "dropout_rate": 0.5,\n    "l2_reg_lambda": 0.008,\n}\n\nparams[\'folder\'] = "/Users/alain/workspace/SIGIR-ecom-data-challenge"\n'})}),"\n",(0,a.jsx)(s.h3,{id:"ressource-gpu",children:"Ressource GPU"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"gpu_info = !nvidia-smi\ngpu_info = '\\n'.join(gpu_info)\nif gpu_info.find('failed') >= 0:\n  print('Not connected to a GPU')\nelse:\n  print(gpu_info)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"installer-les-biblioth\xe8ques-requises",children:"Installer les biblioth\xe8ques requises"}),"\n",(0,a.jsx)(s.p,{children:"XLNetTokenizer n\xe9cessite la librairie SentencePiece. Les autres librairies requises sont d\xe9j\xe0 disponibles dans Colab. Ces librairies sont :"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"numpy"}),"\n",(0,a.jsx)(s.li,{children:"pandas"}),"\n",(0,a.jsx)(s.li,{children:"scikit-learn"}),"\n",(0,a.jsx)(s.li,{children:"torch"}),"\n",(0,a.jsx)(s.li,{children:"transformers"}),"\n"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"!pip install sentencepiece\n"})}),"\n",(0,a.jsx)(s.h3,{id:"monter-google-drive-dans-la-machine-virtuelle",children:"Monter Google Drive dans la machine virtuelle"}),"\n",(0,a.jsx)(s.p,{children:"Ce notebook est dans Google Colab et les donn\xe9es sont charg\xe9es dans Google Drive."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"from google.colab import drive\ndrive.mount('/gdrive')\n"})}),"\n",(0,a.jsx)(s.h3,{id:"cr\xe9er-un-sous-ensemble-des-donn\xe9es",children:"Cr\xe9er un sous-ensemble des donn\xe9es"}),"\n",(0,a.jsx)(s.p,{children:"Consid\xe9rant la grande dimension des donn\xe9es (plus de 8 Go), nous devons cr\xe9er un sous-ensemble de donn\xe9es pour d\xe9velopper notre projet."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'from pathlib import Path\nimport pandas as pd\n\ndef create_sample(folder: str, nobs: int) -> tuple:\n    """Cr\xe9er un sous-ensemble de donn\xe9es pour le d\xe9veloppement."""\n\n    # Lire les fichiers originaux dans "/SIGIR-ecom-data-challenge/train".\n    train_folder = Path(folder) / "train"\n    browsing = pd.read_csv(train_folder / "browsing_train.csv", sep=",")\n    search = pd.read_csv(train_folder / "search_train.csv", sep=",")\n    product = pd.read_csv(train_folder / "sku_to_content.csv", sep=",")\n\n    # Utiliser \'unique\' pour s\'assurer d\'avoir que des sessions uniques.\n    # Prendre les premi\xe8res NOBS sessions.\n    unique_sessions = browsing["session_id_hash"].unique()[:nobs]\n\n    # Filtrer l\'ensemble des \xe9v\xe9nements pour ne contenir que les \xe9v\xe9nements des NOBS sessions.\n    browsing_sample = browsing[browsing["session_id_hash"].isin(unique_sessions)]\n    print(f"Nombre de sessions: {len(unique_sessions)}")\n    print(f"Nombre d\'\xe9v\xe9nements: {len(browsing_sample)}")\n\n    # Filtrer l\'ensemble des recherches pour ne contenir que les recherches des NOBS sessions.\n    search_sample = search[search["session_id_hash"].isin(unique_sessions)]\n    print(f"Nombre de recherches: {len(search_sample)}")\n\n    # Filtrer l\'ensemble des produits pour ne contenir que les produits pr\xe9sents dans le sous-ensemble.\n    # D\'abord, obtenir les identifiants uniques des produits du sous-ensemble d\'\xe9v\xe9nements.\n    unique_product_skus_from_train = browsing_sample["product_sku_hash"].unique()\n    # Obtenir les identifiants uniques des produits du sous-ensemble de recherches.\n    unique_product_skus_from_search = search_sample["product_skus_hash"].explode().unique().tolist()\n    # Obtenir les identifiants uniques des produits cliqu\xe9s du sous-ensemble de recherches.\n    unique_clicked_skus_from_search = search_sample["clicked_skus_hash"].explode().unique().tolist()\n    # Obtenir une seule listes des identifiants uniques des produits.\n    unique_product_skus = list(set(unique_product_skus_from_train) | set(unique_product_skus_from_search) | set(unique_clicked_skus_from_search))\n    # Filtrer l\'ensemble des produits pour ne contenir que les produits pr\xe9sents dans le sous-enmsemble\n    product_sample = product[product["product_sku_hash"].isin(unique_product_skus)]\n    print(f"Nombre de produits: {len(product_sample)}")\n\n    # Cr\xe9er un dossier pour le sous-ensemble.\n    sample_folder = Path(folder) / f"sample_{nobs}"\n    sample_folder.mkdir(parents=True, exist_ok=True)\n\n    browsing_file_path = sample_folder / "browsing_train.csv"\n    browsing_sample.to_csv(browsing_file_path, index=False)\n\n    search_file_path = sample_folder / "search_train.csv"\n    search_sample.to_csv(search_file_path, index=False)\n\n    product_file_path = sample_folder / "sku_to_content.csv"\n    product_sample.to_csv(product_file_path, index=False)\n\nfolder = params["folder"]\nsample_size = params["sample_size"]\n# Ne pas ex\xe9cuter si le sous-ensemble est d\xe9 cr\xe9\xe9\n# create_sample(folder, sample_size)\n'})}),"\n",(0,a.jsx)(s.p,{children:"V\xe9rifier les fichiers du sous-ensemble."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'import os\nfrom datetime import datetime\n\n# R\xe9pertoire contenant un sous-ensemble de \'sample_size\' sessions.\ndirectory_path = f"{params[\'folder\']}/sample_{params[\'sample_size\']}"\ndirectory_contents = os.listdir(directory_path)\n\nprint(f"Directory path: {directory_path}")\nfor item in directory_contents:\n    full_path = os.path.join(directory_path, item)\n\n    # Obtenir le timestamp de la date de modification\n    modification_timestamp = os.path.getmtime(full_path)\n\n    # Convertir le timestamp en un objet datetime\n    modification_date = datetime.fromtimestamp(modification_timestamp)\n\n    # Formater la date en AAAA-MM-JJ hh:mm:ss\n    formatted_date = modification_date.strftime("%Y-%m-%d %H:%M:%S")\n\n    # Obtenir la taille du fichier en octets\n    size_bytes = os.path.getsize(full_path)\n\n    # Convertir la taille en Mo\n    size_mb = size_bytes / 1048576  # 1 Mo = 1 048 576 octets\n\n    print(f"File Name: {item}")\n    print(f"Last Modification Date: {formatted_date}")\n    print(f"Size: {size_mb:.2f} MB")\n    print()\n\n'})}),"\n",(0,a.jsx)(s.h3,{id:"charger-le-sous-ensemble-de-donn\xe9es",children:"Charger le sous-ensemble de donn\xe9es"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'from pathlib import Path\nimport pandas as pd\n\ndef load_sample(folder: str, nobs: int) -> tuple:\n    """Charger le sous-ensemble."""\n    sample_folder = Path(folder) / f"sample_{nobs}"\n\n    browsing = pd.read_csv(sample_folder / "browsing_train.csv", sep=",")\n    search = pd.read_csv(sample_folder / "search_train.csv", sep=",")\n    product = pd.read_csv(sample_folder / "sku_to_content.csv", sep=",")\n\n    browsing = browsing.sort_values(["session_id_hash", "server_timestamp_epoch_ms"])\n    search = search.sort_values(["session_id_hash", "server_timestamp_epoch_ms"])\n    product = product.sort_values(["product_sku_hash"])\n\n    print(f"Dimensions de \'browsing\': {browsing.shape}")\n    print(f"Dimensions de \'search\': {search.shape}")\n    print(f"Dimensions de \'product\': {product.shape}")\n\n    return browsing, search, product\n\nprint("Charger le sous-ensemble des donn\xe9es")\nfolder = params["folder"]\nnobs = params["sample_size"]\nbrowsing, search, product = load_sample(folder, nobs)\n'})}),"\n",(0,a.jsx)(s.h2,{id:"\xe9tape-2---analyse-exploratoire-des-donn\xe9es-eda",children:"\xc9tape 2 - Analyse exploratoire des donn\xe9es (EDA)"}),"\n",(0,a.jsx)(s.p,{children:"Cette \xe9tape est pour comprendre les donn\xe9es (num\xe9riques, cat\xe9gorielles), identifier les valeurs manquantes, produire des tableaux de fr\xe9quences, etc. On ne cr\xe9e pas de nouveaux DataFrames. On transforme les ensembles de donn\xe9es dans les \xe9tapes subs\xe9quentes."}),"\n",(0,a.jsx)(s.h3,{id:"donn\xe9es-de-navigation",children:"Donn\xe9es de navigation"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'print("Nombre de valeurs NaN dans toutes les colonnes")\nnan_count = browsing.isna().sum()\nprint(nan_count)\n'})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"print(\"Fr\xe9quence de 'event_type'\")\nbrowsing['event_type'].fillna('_missing').value_counts()\n"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"print(\"Fr\xe9quence de 'product_action'\")\nbrowsing['product_action'].fillna('_missing').value_counts()\n"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"print(\"Fr\xe9quence crois\xe9e de 'event_type' et 'product_action'\")\npd.crosstab(browsing['event_type'].fillna('_missing'), browsing['product_action'].fillna('_missing'))\n"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"browsing[['event_type', 'product_action', 'product_sku_hash']].head()\n"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"print(\"Fr\xe9quence du nombre d'\xe9v\xe9nements par session\")\nevents_per_session = browsing.groupby('session_id_hash').size()\n# Regrouper les valeurs de 25 et plus\nevents_per_session_grouped = events_per_session.apply(lambda x: 25 if int(x) >= 25 else x)\n# Calculer la fr\xe9quence des \xe9v\xe9nements par session apr\xe8s regroupement\nfrequency_of_events_per_session = events_per_session_grouped.value_counts().sort_index()\nprint(frequency_of_events_per_session)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"donn\xe9es-de-recherche",children:"Donn\xe9es de recherche"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'print("Nombre de valeurs NaN dans toutes les colonnes")\nnan_count = search.isna().sum()\nprint(nan_count)\n'})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"print(\"Fr\xe9quence du nombre de recherches par session\")\nsearch_per_session = search.groupby('session_id_hash').size()\nfrequency_of_search_per_session = search_per_session.value_counts().sort_index()\nprint(frequency_of_search_per_session)\n"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"nb = len(search['session_id_hash'].value_counts())\nprint(f\"Nombre de sessions: {nb}\")\n"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"from matplotlib import pyplot as plt\n\n# Compter le nombre d'interactions par 'session_id_hash'.\ninteractions_count = browsing['session_id_hash'].value_counts()\n\nplt.figure(figsize=(10, 6))\ninteractions_count.hist(bins=50)  # Adjust the number of bins for better visualization\nplt.xlabel(\"Nombre d'interactions par session\")\nplt.ylabel(\"Fr\xe9quence\")\nplt.title(\"Distribution des interactions par session\")\nplt.grid(True)\nplt.show()\n"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"print(\"Distribution des produits par fr\xe9quence d'apparition dans les interactions\")\nevents_per_product = browsing.groupby('product_sku_hash').size()\n# Calculer la fr\xe9quence des \xe9v\xe9nements par produit.\nfrequency_of_events_per_product = events_per_product.value_counts().sort_index()\nprint(frequency_of_events_per_product)\n# On voit que les produits qui apparaissent souvent sont peu nombreux.\n# Dans nos pr\xe9diction, on pourrait se restreindre qu'au 50% ou 75% des produits\n# qui apparaissent les plus souvent.\n"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"import pandas as pd\n\ndef vector_len_frequency(df: pd.DataFrame, name: str) -> None:\n    print(f\"Fr\xe9quence des longueurs des vecteurs dans '{name}'\")\n    non_nan_vectors = df[name].dropna()\n    nan_vectors = pd.Series([[]] * df[name].isna().sum(), index=df[name].index[df[name].isna()], dtype=object)\n\n    df = pd.concat([non_nan_vectors, nan_vectors]).sort_index()\n    lengths = df.apply(len)\n    frequency = lengths.value_counts().sort_index()\n    print(frequency)\n\n# Fr\xe9quence du nombre d'\xe9l\xe9ments dans 'image_vector'\n# On constate qu'une bonne proportion des vecteurs sont \"vide\", sinon de longueur variable.\nvector_len_frequency(search, 'query_vector')\n"})}),"\n",(0,a.jsx)(s.h3,{id:"donn\xe9es-sur-les-produits",children:"Donn\xe9es sur les produits"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'print("Nombre de valeurs NaN dans toutes les colonnes")\nnan_count = product.isna().sum()\nprint(nan_count)\n'})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"print(\"Fr\xe9quence des quantiles de prix\")\nproduct['price_bucket'].value_counts()\n"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"# Afficher des valeurs.\nprint(\"description_vector\")\nprint(product['description_vector'][0])\nprint(\"category_hash\")\nprint(product['category_hash'][0])\nprint(\"image_vector\")\nprint(product['image_vector'][0])\n"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"import pandas as pd\n\n# Fr\xe9quence du nombre d'\xe9l\xe9ments dans 'image_vector'\n# On constate qu'une bonne proportion des vecteurs sont \"vide\", sinon de longueur variable.\nvector_len_frequency(product, 'image_vector')\n"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"# Fr\xe9quence du nombre d'\xe9l\xe9ments dans 'description_vector'\n# On constate qu'une bonne proportion des vecteurs sont \"vide\", sinon de longueur variable.\nvector_len_frequency(product, 'description_vector')\n"})}),"\n",(0,a.jsx)(s.h2,{id:"\xe9tape-3---nettoyage-des-donn\xe9es",children:"\xc9tape 3 - Nettoyage des donn\xe9es"}),"\n",(0,a.jsx)(s.p,{children:"Cette \xe9tapes vise \xe0 traiter les valeurs manquantes, les erreurs, les doublons, etc. Les ensembles transform\xe9s sont sauvegard\xe9s dans le r\xe9pertoire de sortie pour usage futur."}),"\n",(0,a.jsxs)(s.p,{children:["L'exploration des donn\xe9es nous a r\xe9v\xe9l\xe9 qu'une proportion \xe9lev\xe9e des interactions sont des \xe9v\xe9nements de consultation de pages non li\xe9es \xe0 un produit. Pour ces \xe9v\xe9nements, nous utilisons la page consult\xe9e comme un produit virtuel. Concr\xe8tement, nous cr\xe9ons une nouvelle caract\xe9ristique ",(0,a.jsx)(s.code,{children:"product_url_hash"})," correspondant \xe0 l'identifiant du produit (",(0,a.jsx)(s.code,{children:"product_sku_hash"}),") s'il existe, sinon \xe0 la page consult\xe9e (",(0,a.jsx)(s.code,{children:"hashed_url"}),") dont le mod\xe8le aura pour t\xe2che de pr\xe9dire."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'def clean_browsing(df: pd.DataFrame) -> pd.DataFrame:\n    # Supprimer les lignes dont l\'identifiant est manquant.\n    condition = df["session_id_hash"].isnull()\n    df = df.loc[~condition]\n\n    # Supprimer les doublons en se basant sur plusieurs colonnes, en gardant le dernier.\n    df.drop_duplicates(\n        ["session_id_hash", "server_timestamp_epoch_ms", "event_type"],\n        inplace=True,\n        keep="last",\n    )\n\n    # Remplacer les valeurs manquantes dans \'product_action\' par \'view\'.\n    df["product_action"].fillna("view", inplace=True)\n\n    # Remplir les valeurs manquantes.\n    df["hashed_url"].fillna("none", inplace=True)\n\n    # Si l\'identifiant du produit est manquant, lui attribuer \'hashed_url\'.\n    # Cr\xe9er \'product_url_hash\' correspondant donc \xe0 un produit ou \xe0 un URL.\n    df["product_url_hash"] = df["product_sku_hash"].fillna(df["hashed_url"])\n\n    return df\n\ndef clean_search(df: pd.DataFrame) -> pd.DataFrame:\n    # Supprimer les lignes dont l\'identifiant est manquant.\n    condition = df["session_id_hash"].isnull()\n    df = df.loc[~condition]\n\n    return df\n\ndef clean_product(df: pd.DataFrame) -> pd.DataFrame:\n    # Supprimer les lignes dont l\'identifiant est manquant.\n    condition = df["product_sku_hash"].isnull()\n    df = df.loc[~condition]\n\n    # Supprimer les doublons.\n    df.drop_duplicates(["product_sku_hash"], inplace=True, keep="last")\n\n    return df\n\nprint("Nettoyage des donn\xe9es")\nbrowsing_cleaned = clean_browsing(browsing)\nsearch_cleaned = clean_search(search)\nproduct_cleaned = clean_product(product)\n'})}),"\n",(0,a.jsx)(s.h2,{id:"\xe9tape-4---ing\xe9nierie-des-attributs",children:"\xc9tape 4 - Ing\xe9nierie des attributs"}),"\n",(0,a.jsxs)(s.p,{children:["L'ing\xe9nierie des attributs, ou ",(0,a.jsx)(s.em,{children:"feature engineering"})," en anglais, a pour but de cr\xe9er de nouvelles variables (",(0,a.jsx)(s.em,{children:"features"}),") \xe0 partir de donn\xe9es brutes pour aider \xe0 am\xe9liorer la performance des algorithmes de pr\xe9diction. Ci-dessous, nous avons des fonctions utilitaires et des fonctions qui transforment les ensembles de donn\xe9es de navigation, de recherche et sur les produits."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'import json\nimport pandas as pd\n\ndef convert_str_to_list(x):\n    """Convertir une cha\xeene de caract\xe8res en liste."""\n    if pd.isnull(x):\n        return x\n    return json.loads(x.replace("\'", \'"\'))\n\ndef process_browsing(df: pd.DataFrame) -> pd.DataFrame:\n    # Pour l\'instant, aucune transformation n\'est appliqu\xe9e.\n    # Le DataFrame est inchang\xe9.\n    return df\n\ndef process_search(df: pd.DataFrame) -> pd.DataFrame:\n    # Convertir les cha\xeenes de caract\xe8res en listes.\n    for col in ["product_skus_hash", "clicked_skus_hash", "query_vector"]:\n        df[col] = df[col].apply(convert_str_to_list)\n\n    # Calculer la taille des produits affich\xe9s et des produits cliqu\xe9s.\n    df["product_skus_size"] = df["product_skus_hash"].apply(lambda x: len(x) if isinstance(x, list) else 0)\n    df["clicked_skus_size"] = df["clicked_skus_hash"].apply(lambda x: len(x) if isinstance(x, list) else 0)\n\n    # Ajouter les produits cliqu\xe9s dans les produits affich\xe9s, seulement s\'ils sont absents.\n    def add_clicked(row):\n        if isinstance(row["clicked_skus_hash"], list):\n            return list(set(row["product_skus_hash"] or []) | set(row["clicked_skus_hash"]))\n        return row["product_skus_hash"]\n\n    df["updated_product_skus_hash"] = df.apply(add_clicked, axis=1)\n    df.drop(columns=["product_skus_hash"], inplace=True)\n\n    return df\n\ndef process_product(df: pd.DataFrame) -> pd.DataFrame:\n    # Convertir les cha\xeenes de caract\xe8res en listes.\n    for col in ["description_vector", "image_vector"]:\n        df[col] = df[col].apply(convert_str_to_list)\n\n    return df\n\nprint("Traitement des donn\xe9es")\nbrowsing_processed = process_browsing(browsing_cleaned)\nsearch_processed = process_search(search_cleaned)\nproduct_processed = process_product(product_cleaned)\n'})}),"\n",(0,a.jsx)(s.h2,{id:"\xe9tape-5---fusion-des-donn\xe9es",children:"\xc9tape 5 - Fusion des donn\xe9es"}),"\n",(0,a.jsx)(s.p,{children:"Fusionner les trois ensembles de donn\xe9es en un seul ensemble combin\xe9. Cette t\xe2che est r\xe9alis\xe9e en deux \xe9tapes :"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsx)(s.li,{children:"Ajouter les donn\xe9es de recherche dans les donn\xe9es de navigation."}),"\n",(0,a.jsx)(s.li,{children:"Ensuite, fusionner les produits aux donn\xe9es de navigation"}),"\n"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'import pandas as pd\n\ndef concat(search: pd.DataFrame, browsing: pd.DataFrame) -> pd.DataFrame:\n    # S\xe9lectionner les lignes ayant au moins un clic de recherche.\n    search_clicks = search[search["clicked_skus_size"] > 0].copy()\n\n    # Indiquer le type d\'\xe9v\xe9nement et l\'action.\n    search_clicks["event_type"] = "event_product"\n    search_clicks["product_action"] = "search"\n\n    # Cr\xe9er un DataFrame o\xf9 chaque \'clicked_skus_hash\' devient sa propre ligne.\n    search_clicks_expanded = search_clicks.explode("clicked_skus_hash")\n\n    # Renommer les colonnes pour correspondre \xe0 la structure du DataFrame \'browsing\'.\n    search_clicks_expanded.rename(columns={"clicked_skus_hash": "product_sku_hash"}, inplace=True)\n\n    # Concat\xe9ner le DataFrame \'search_clicks_expanded\' au DataFrame \'browsing\'.\n    combined = pd.concat([browsing, search_clicks_expanded])\n\n    # Filtrer les sessions ayant plus d\'un \xe9v\xe9nement.\n    # On doit avoir au moins deux \xe9v\xe9nements.\n    filtered = combined.groupby("session_id_hash").filter(lambda x: len(x) > 1)\n\n    return filtered\n\ndef merge(browsing: pd.DataFrame, product: pd.DataFrame) -> pd.DataFrame:\n    # Fusionner les donn\xe9es sur les produits avec les donn\xe9es de navigation sur \'product_sku_hash\'.\n    combined = browsing.merge(product, on="product_sku_hash", how="left")\n\n    # Valeurs manquantes.\n    columns = ["price_bucket", "product_skus_size", "clicked_skus_size"]\n    combined[columns] = combined[columns].fillna(0)\n\n    return combined\n\nprint("Fusion des donn\xe9es en un seul ensemble combin\xe9")\nbrowsing_combined = concat(search_processed, browsing_processed)\ncombined = merge(browsing_combined, product_processed)\nprint(f"Dimension de \'combined\': {combined.shape}")\nprint(f"Colonnes de \'combined\': {combined.columns}")\n'})}),"\n",(0,a.jsx)(s.h3,{id:"fonctions-utilitaires",children:"Fonctions utilitaires"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"import numpy as np\n\ndef get_cycled_feature_value_sin(value, max_value):\n    value_scaled = (value + 0.000001) / max_value\n    value_sin = np.sin(2 * np.pi * value_scaled)\n    return value_sin\n\ndef get_cycled_feature_value_cos(value, max_value):\n    value_scaled = (value + 0.000001) / max_value\n    value_cos = np.cos(2 * np.pi * value_scaled)\n    return value_cos\n"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"# Convertir les timestamps en divers formats pour l'extraction de\n# caract\xe9ristiques temporelles.\ndef convert_timestamp(timestamp):\n    # S'assurer que 'timestamp' est un objet pandas Timestamp\n    if not isinstance(timestamp, pd.Timestamp):\n        timestamp = pd.to_datetime(timestamp)\n\n    # Extraire les heures et les minutes.\n    hour = timestamp.hour\n    hour_sin = get_cycled_feature_value_sin(hour, 24)\n    hour_cos = get_cycled_feature_value_cos(hour, 24)\n\n    # Extraire le jour, le jour de la semaine et le mois.\n    day = timestamp.day\n    month = timestamp.month\n    weekday = timestamp.dayofweek + 1  # 1 = Lundi, 7 = Dimanche.\n    weekday_sin = get_cycled_feature_value_sin(weekday, 7)\n    weekday_cos = get_cycled_feature_value_cos(weekday, 7)\n\n    # Ajouts potentiels:\n    # L'ann\xe9e peut \xeatre importante, surtout si les donn\xe9es s'\xe9tendent sur plusieurs ann\xe9es.\n    year = timestamp.year\n\n    # Le num\xe9ro de la semaine dans l'ann\xe9e peut \xeatre utile pour capturer\n    # des tendances saisonni\xe8res.\n    week_of_year = timestamp.isocalendar().week\n\n    # Indicateur pour le weekend.\n    weekend = int(weekday >= 5)\n\n    return (\n        timestamp,\n        hour,\n        hour_sin,\n        hour_cos,\n        day,\n        month,\n        weekday,\n        weekday_sin,\n        weekday_cos,\n        year,\n        week_of_year,\n        weekend,\n    )\n"})}),"\n",(0,a.jsx)(s.h3,{id:"regrouper-les-produits-avec-moins-de-cinq-interactions",children:"Regrouper les produits avec moins de cinq interactions"}),"\n",(0,a.jsxs)(s.p,{children:["L'\xe9quipe NVIDIA Merlin ont expliqu\xe9 dans leur ",(0,a.jsx)(s.a,{href:"https://arxiv.org/abs/2107.05124",children:"article"}),' avoir regroup\xe9 dans un identifiant unique tous les produits qui aparaissaient dans 5 interactions ou moins. Cette technique, appel\xe9e "',(0,a.jsx)(s.em,{children:"frequency capping"}),"\". Elle a \xe9t\xe9 adopt\xe9e parce qu'il est difficile pour un mod\xe8le d'apprendre des repr\xe9sentations (",(0,a.jsx)(s.em,{children:"embeddings"}),") significatives pour les articles peu populaires."]}),"\n",(0,a.jsx)(s.p,{children:"Malheureusement, nous n'avons pas r\xe9ussi \xe0 appliquer cette technique correctement, parce que le mod\xe8le avait tendance \xe0 pr\xe9dire souvent cet identifiant unique, ce qui biaisait la performance du mod\xe8le."}),"\n",(0,a.jsx)(s.p,{children:"N\xe9anmoins, voici le code non utilis\xe9 qui regroupe les produits peu fr\xe9quents."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"def replace_low_interaction_products(df, column_name='product_url_hash', threshold=5, common_id='common_product'):\n    # Comptage des interactions pour chaque produit\n    interaction_counts = df[column_name].value_counts()\n\n    # Identifier les produits avec moins de 'threshold' interactions\n    low_interaction_products = interaction_counts[interaction_counts < threshold].index\n\n    # Remplacer les identifiants de ces produits par un identifiant commun\n    df[column_name] = df[column_name].apply(lambda x: common_id if x in low_interaction_products else x)\n\n    return df\n"})}),"\n",(0,a.jsx)(s.h3,{id:"normalisation-des-vecteurs",children:"Normalisation des vecteurs"}),"\n",(0,a.jsxs)(s.p,{children:["Nous avons ont utilis\xe9 les vecteurs pr\xe9-entra\xeen\xe9s fournis dans le jeu de donn\xe9es, qui comprennent des vecteurs de requ\xeates de recherche (",(0,a.jsx)(s.code,{children:"query_vector"}),"), des descriptions de produits (",(0,a.jsx)(s.code,{children:"description_vector"}),"), et des images de produits (",(0,a.jsx)(s.code,{children:"image_vector"}),"). Nous avons appliqu\xe9 une normalisation L2 aux vecteurs plut\xf4t que d'utiliser les vecteurs originaux avec une normalisation par couche. La normalisation L2 permet de maintenir l'\xe9chelle des caract\xe9ristiques similaire tout en pr\xe9servant les relations de similarit\xe9 entre les produits similaires\u200b\u200b."]}),"\n",(0,a.jsx)(s.p,{children:"La normalisation L2, \xe9galement connue sous le nom de normalisation euclidienne, consiste \xe0 ajuster les valeurs d'un vecteur de sorte que la longueur (ou la norme) du vecteur soit \xe9gale \xe0 1. Elle se fait selon la formule suivante :"}),"\n",(0,a.jsx)(s.span,{className:"katex-display",children:(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mtext,{children:"vecteur"}),(0,a.jsx)(s.mi,{mathvariant:"normal",children:"_"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mtext,{children:"normalis"}),(0,a.jsxs)(s.mover,{accent:"true",children:[(0,a.jsx)(s.mtext,{children:"e"}),(0,a.jsx)(s.mo,{children:"\u02ca"})]})]}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsxs)(s.mfrac,{children:[(0,a.jsx)(s.mtext,{children:"vecteur"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2225"}),(0,a.jsx)(s.mtext,{children:"vecteur"}),(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2225"}),(0,a.jsx)(s.mn,{children:"2"})]})]})]})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\text{vecteur}\\_\\text{normalis\xe9} = \\frac{\\text{vecteur}}{\\| \\text{vecteur} \\|_2}"})]})})}),(0,a.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"1.0044em",verticalAlign:"-0.31em"}}),(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord",children:"vecteur"})}),(0,a.jsx)(s.span,{className:"mord",style:{marginRight:"0.02778em"},children:"_"}),(0,a.jsxs)(s.span,{className:"mord text",children:[(0,a.jsx)(s.span,{className:"mord",children:"normalis"}),(0,a.jsx)(s.span,{className:"mord accent",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsxs)(s.span,{className:"vlist",style:{height:"0.6944em"},children:[(0,a.jsxs)(s.span,{style:{top:"-3em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:"e"})]}),(0,a.jsxs)(s.span,{style:{top:"-3em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"accent-body",style:{left:"-0.25em"},children:(0,a.jsx)(s.span,{className:"mord",children:"\u02ca"})})]})]})})})})]}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(s.span,{className:"mrel",children:"="}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"2.2281em",verticalAlign:"-0.936em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,a.jsx)(s.span,{className:"mfrac",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"1.2921em"},children:[(0,a.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord",children:"\u2225"}),(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord",children:"vecteur"})}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord",children:"\u2225"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3011em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"2"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]})]})]}),(0,a.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,a.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord",children:"vecteur"})})})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.936em"},children:(0,a.jsx)(s.span,{})})})]})}),(0,a.jsx)(s.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,a.jsxs)(s.p,{children:["o\xf9 ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2225"}),(0,a.jsx)(s.mtext,{children:"vecteur"}),(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2225"}),(0,a.jsx)(s.mn,{children:"2"})]})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\| \\text{vecteur} \\|_2"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,a.jsx)(s.span,{className:"mord",children:"\u2225"}),(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord",children:"vecteur"})}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord",children:"\u2225"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3011em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"2"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]})]})})]})," est la norme L2 du vecteur, calcul\xe9e comme la racine carr\xe9e de la somme des carr\xe9s de ses \xe9l\xe9ments. En d'autres termes, pour un vecteur ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{mathvariant:"bold",children:"v"}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsx)(s.mo,{stretchy:"false",children:"["}),(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"v"}),(0,a.jsx)(s.mn,{children:"1"})]}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"v"}),(0,a.jsx)(s.mn,{children:"2"})]}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsx)(s.mo,{children:"\u2026"}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"v"}),(0,a.jsx)(s.mi,{children:"n"})]}),(0,a.jsx)(s.mo,{stretchy:"false",children:"]"})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\mathbf{v} = [v_1, v_2, \\ldots, v_n]"})]})})}),(0,a.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.4444em"}}),(0,a.jsx)(s.span,{className:"mord mathbf",style:{marginRight:"0.01597em"},children:"v"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(s.span,{className:"mrel",children:"="}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,a.jsx)(s.span,{className:"mopen",children:"["}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3011em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"1"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3011em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"2"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"minner",children:"\u2026"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"n"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]}),(0,a.jsx)(s.span,{className:"mclose",children:"]"})]})]})]}),", la norme L2 est calcul\xe9e par :"]}),"\n",(0,a.jsx)(s.span,{className:"katex-display",children:(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2225"}),(0,a.jsx)(s.mi,{mathvariant:"bold",children:"v"}),(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2225"}),(0,a.jsx)(s.mn,{children:"2"})]}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsx)(s.msqrt,{children:(0,a.jsxs)(s.mrow,{children:[(0,a.jsxs)(s.msubsup,{children:[(0,a.jsx)(s.mi,{children:"v"}),(0,a.jsx)(s.mn,{children:"1"}),(0,a.jsx)(s.mn,{children:"2"})]}),(0,a.jsx)(s.mo,{children:"+"}),(0,a.jsxs)(s.msubsup,{children:[(0,a.jsx)(s.mi,{children:"v"}),(0,a.jsx)(s.mn,{children:"2"}),(0,a.jsx)(s.mn,{children:"2"})]}),(0,a.jsx)(s.mo,{children:"+"}),(0,a.jsx)(s.mo,{children:"\u2026"}),(0,a.jsx)(s.mo,{children:"+"}),(0,a.jsxs)(s.msubsup,{children:[(0,a.jsx)(s.mi,{children:"v"}),(0,a.jsx)(s.mi,{children:"n"}),(0,a.jsx)(s.mn,{children:"2"})]})]})})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\| \\mathbf{v} \\|_2 = \\sqrt{v_1^2 + v_2^2 + \\ldots + v_n^2}"})]})})}),(0,a.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,a.jsx)(s.span,{className:"mord",children:"\u2225"}),(0,a.jsx)(s.span,{className:"mord mathbf",style:{marginRight:"0.01597em"},children:"v"}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord",children:"\u2225"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3011em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"2"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(s.span,{className:"mrel",children:"="}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"1.84em",verticalAlign:"-0.5413em"}}),(0,a.jsx)(s.span,{className:"mord sqrt",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"1.2987em"},children:[(0,a.jsxs)(s.span,{className:"svg-align",style:{top:"-3.8em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3.8em"}}),(0,a.jsxs)(s.span,{className:"mord",style:{paddingLeft:"1em"},children:[(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"0.7959em"},children:[(0,a.jsxs)(s.span,{style:{top:"-2.4337em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"1"})})]}),(0,a.jsxs)(s.span,{style:{top:"-3.0448em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"2"})})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.2663em"},children:(0,a.jsx)(s.span,{})})})]})})]}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(s.span,{className:"mbin",children:"+"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"0.7959em"},children:[(0,a.jsxs)(s.span,{style:{top:"-2.4337em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"2"})})]}),(0,a.jsxs)(s.span,{style:{top:"-3.0448em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"2"})})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.2663em"},children:(0,a.jsx)(s.span,{})})})]})})]}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(s.span,{className:"mbin",children:"+"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(s.span,{className:"minner",children:"\u2026"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(s.span,{className:"mbin",children:"+"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"0.7401em"},children:[(0,a.jsxs)(s.span,{style:{top:"-2.453em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"n"})})]}),(0,a.jsxs)(s.span,{style:{top:"-2.989em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"2"})})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.247em"},children:(0,a.jsx)(s.span,{})})})]})})]})]})]}),(0,a.jsxs)(s.span,{style:{top:"-3.2587em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3.8em"}}),(0,a.jsx)(s.span,{className:"hide-tail",style:{minWidth:"1.02em",height:"1.88em"},children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"1.88em",viewBox:"0 0 400000 1944",preserveAspectRatio:"xMinYMin slice",children:(0,a.jsx)(s.path,{d:"M983 90\nl0 -0\nc4,-6.7,10,-10,18,-10 H400000v40\nH1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7\ns-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744\nc-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30\nc26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722\nc56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5\nc53.7,-170.3,84.5,-266.8,92.5,-289.5z\nM1001 80h400000v40h-400000z"})})})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.5413em"},children:(0,a.jsx)(s.span,{})})})]})})]})]})]})}),"\n",(0,a.jsx)(s.p,{children:"Une fois la norme L2 calcul\xe9e, chaque \xe9l\xe9ment du vecteur est divis\xe9 par cette valeur pour obtenir le vecteur normalis\xe9."}),"\n",(0,a.jsxs)(s.p,{children:["Concr\xe8tement, le code calcule d'abord la norme L2 du vecteur ",(0,a.jsx)(s.code,{children:"image_vector"})," \xe0 l'aide de ",(0,a.jsx)(s.code,{children:"np.linalg.norm"})," avec l'ordre 2 (norme euclidienne), puis divise chaque \xe9l\xe9ment du vecteur par cette norme pour obtenir le vecteur normalis\xe9."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"def normalize_vector(vect, max_features: int):\n    # Normaliser un vecteur en utilisant la normalisation L2 et limiter sa longueur\n    # \xe0 'max_features'.\n\n    # G\xe9rer les cas o\xf9 vect est None, un entier, ou autre chose que np.ndarray\n    if vect is None or not isinstance(vect, np.ndarray):\n        return np.zeros(max_features)\n\n    # S'assurer que vect est un tableau NumPy 1D\n    if vect.ndim != 1:\n        raise ValueError(\"Le vecteur doit \xeatre un tableau NumPy 1D.\")\n\n    # S\xe9lectionner les premiers 'max_features' \xe9l\xe9ments\n    if len(vect) > max_features:\n        vect = vect[:max_features]\n    elif len(vect) < max_features:\n        # Compl\xe9ter les vecteurs plus courts avec des z\xe9ros\n        vect = np.pad(vect, (0, max_features - len(vect)), \"constant\")\n\n    # Normalisation L2\n    norm = np.linalg.norm(vect, 2)\n    normalized_vect = vect / norm if norm != 0 else vect\n\n    return normalized_vect\n"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'from sklearn.discriminant_analysis import StandardScaler\nfrom sklearn.preprocessing import LabelEncoder\n\ndef create_sequences(df: pd.DataFrame, max_features: int) -> list:\n    # Trier le DataFrame par session et timestamp.\n    # Faire une copie du DataFrame avant de le modifier.\n    df1 = df.sort_values(["session_id_hash", "server_timestamp_epoch_ms"]).copy()\n\n    # D\xe9finir une fonction pour extraire la cat\xe9gorie principale\n    # \xe0 partir de \'category_hash\'.\n    def product_main_category(x):\n        if pd.isna(x):\n            return x\n        return x.split("/")[0]\n\n    # Appliquer la fonction pour cr\xe9er une nouvelle colonne \'main_category\'.\n    df1["main_category"] = df1["category_hash"].apply(product_main_category)\n\n    # Calculer le prix moyen par cat\xe9gorie principale.\n    main_price = df1.groupby("main_category")["price_bucket"].mean().reset_index()\n    main_price.columns = ["main_category", "mean_price_main"]\n\n    # Calculer le prix moyen par cat\xe9gorie hi\xe9rarchique.\n    hierarchy_price = df1.groupby("category_hash")["price_bucket"].mean().reset_index()\n    hierarchy_price.columns = ["category_hash", "mean_price_hierarchy"]\n\n    # Fusionner les donn\xe9es de prix moyens avec les donn\xe9es sur les produits.\n    df1 = df1.merge(main_price, on="main_category", how="left")\n    df1 = df1.merge(hierarchy_price, on="category_hash", how="left")\n\n    # Remplacer les valeurs NaN par 0.\n    for col in ["mean_price_main", "mean_price_hierarchy"]:\n        df1[col] = df1[col].fillna(0)\n\n    # Encodage des valeurs cat\xe9gorielles.\n    label_encoders = {}\n    categorical_columns = [\n        "event_type",\n        "product_action",\n        "product_url_hash",\n        "main_category",\n    ]\n    for col in categorical_columns:\n        df1[col] = df1[col].apply(lambda x: str(x) if isinstance(x, np.ndarray) else x)\n        le = LabelEncoder()\n        df1[col].fillna("none", inplace=True)\n        df1[col] = le.fit_transform(df1[col])\n        label_encoders[col] = le\n\n    # Transformation de \'server_timestamp_epoch_ms\'.\n    results = df1["server_timestamp_epoch_ms"].apply(convert_timestamp)\n\n    # Cr\xe9er de nouvelles colonnes pour chaque valeur retourn\xe9e.\n    (\n        df1["timestamp"],\n        df1["hour"],\n        df1["hour_sin"],\n        df1["hour_cos"],\n        df1["day"],\n        df1["month"],\n        df1["weekday"],\n        df1["weekday_sin"],\n        df1["weekday_cos"],\n        df1["year"],\n        df1["week_of_year"],\n        df1["weekend"],\n    ) = zip(*results)\n\n    # Calculer le temps depuis le premier \xe9v\xe9nement de la session en secondes.\n    df1["time_since_first"] = df1.groupby("session_id_hash")["timestamp"].transform(lambda x: (x - x.min()))\n    df1["time_since_first"] = df1["time_since_first"].dt.total_seconds()\n\n    # Calculer le temps depuis l\'\xe9v\xe9nement pr\xe9c\xe9dent de la sessions en secondes.\n    df1["time_since_last"] = df1.groupby("session_id_hash")["time_since_first"].diff()\n    # Remplacer les valeurs NaN par 0 pour la premi\xe8re occurrence de chaque session.\n    df1["time_since_last"].fillna(0, inplace=True)\n\n    # Calcul du nombre d\'interactions avec le m\xeame produit au sein de la session\n    df1["product_interaction_count"] = df1.groupby(["session_id_hash", "product_url_hash"]).cumcount() + 1\n\n    # Indicateur de consultation des d\xe9tails du produit\n    df1["viewed_product_detail"] = ((df1["event_type"] == "event_product") & (df1["product_action"] == "detail")).astype(int)\n\n    # Indicateur d\'ajout du produit au panier\n    df1["added_product_to_cart"] = ((df1["event_type"] == "event_product") & (df1["product_action"] == "add")).astype(int)\n\n    # Normaliser les caract\xe9ristiques num\xe9riques.\n    scaler = StandardScaler()\n    numeric_features = [\n        "product_skus_size",\n        "clicked_skus_size",\n        "hour",\n        "hour_sin",\n        "hour_cos",\n        "day",\n        "month",\n        "weekday",\n        "weekday_sin",\n        "weekday_cos",\n        "year",\n        "week_of_year",\n        "weekend",\n        "time_since_first",\n        "time_since_last",\n        "price_bucket",\n        "mean_price_main",\n        "mean_price_hierarchy",\n        "product_interaction_count",\n        "viewed_product_detail",\n        "added_product_to_cart",\n    ]\n    df1[numeric_features] = scaler.fit_transform(df1[numeric_features])\n\n    """\n    # Normaliser L2 et combiner les vecteurs non textuels (query_vector, description_vector\n    # et image_vector).\n    df1["description_vector"] = df1["description_vector"].apply(lambda x: normalize_vector(x, max_features))\n    df1["image_vector"] = df1["image_vector"].apply(lambda x: normalize_vector(x, max_features))\n    df1["query_vector"] = df1["query_vector"].apply(lambda x: normalize_vector(x, max_features))\n\n    # Concat\xe9nation des vecteurs\n    combined_vectors = np.hstack(\n        (\n            df1["description_vector"].tolist(),\n            df1["image_vector"].tolist(),\n            df1["query_vector"].tolist(),\n        )\n    )\n\n    # Ajouter les vecteurs r\xe9duits au DataFrame\n    df1["combined_vectors"] = list(combined_vectors)\n    combined_vectors_length = combined_vectors.shape[1]\n    """\n\n    # Normaliser L2 le \'description_vector\'.\n    df1["description_vector"] = df1["description_vector"].apply(lambda x: normalize_vector(x, max_features))\n\n    # Puisque nous ne consid\xe9rons que \'description_vector\', il n\'est pas n\xe9cessaire de le concat\xe9ner avec d\'autres vecteurs.\n    # On peut directement l\'assigner \xe0 \'combined_vectors\'.\n    df1["combined_vectors"] = df1["description_vector"].tolist()\n\n    # La longueur des vecteurs combin\xe9s correspond \xe0 la longueur des \'description_vector\'.\n    # Comme \'normalize_vector\' assure que tous les vecteurs ont la m\xeame longueur (max_features), on peut utiliser cette valeur.\n    combined_vectors_length = max_features\n\n    # Groupement des donn\xe9es par session et cr\xe9ation des interactions\n    sessions = []\n    non_text_features_all = []\n    for session_id, session_df in df1.groupby("session_id_hash"):\n        # Cr\xe9er une liste pour stocker les interactions\n        interactions = []\n        non_text_features_session = []\n\n        for _, row in session_df.iterrows():\n            # R\xe9cup\xe9rer les caract\xe9ristiques\n            features = row[["product_url_hash", "event_type", "product_action", "main_category"] + numeric_features].tolist()\n            interactions.append(features)\n\n            # Traitement des caract\xe9ristiques non textuelles\n            non_text_vector = row["combined_vectors"].tolist()\n            non_text_features_session.append(non_text_vector)\n\n        # Ajouter la session compl\xe8te\n        sessions.append(np.array(interactions))\n        non_text_features_all.append(np.array(non_text_features_session))\n\n    return sessions, non_text_features_all, label_encoders, combined_vectors_length\n'})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'print("Cr\xe9ation des s\xe9quences d\'interactions par session")\nmax_features = params["max_features"]\nprint(f"max_features: {max_features}")\nsessions, non_text_features_all, label_encoders, \\\ncombined_vectors_length = create_sequences(combined, max_features)\nprint(f"combined_vectors_length: {combined_vectors_length}")\n'})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'print(f"Nombre total de sessions: {len(sessions)}")\nprint(f"Dimension (ni, nc) des 5 premi\xe8res sessions.")\nprint("ni = nombre d\'int\xe9ractions et nc = nombre de caract\xe9ristiques.")\nfor i in range(5):\n    print(f"Dimension de la session {i}: {sessions[i].shape}")\n'})}),"\n",(0,a.jsx)(s.h2,{id:"\xe9tape-7---cr\xe9ation-des-s\xe9quences-et-tokenisation",children:"\xc9tape 7 - Cr\xe9ation des s\xe9quences et tokenisation"}),"\n",(0,a.jsx)(s.p,{children:"Dans cette \xe9tape, nous cr\xe9ons les s\xe9quences d'interaction pour l'entra\xeenement avec les \xe9tapes suivantes :"}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"\xc9tape 1 : Traitement des sessions"})," : Chaque session dans ",(0,a.jsx)(s.code,{children:"sessions"})," est trait\xe9e pour cr\xe9er quatre ensembles distincts :"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"text_sequences"})," : une liste de s\xe9quences textuelles, o\xf9 chaque s\xe9quence est une concat\xe9nation des champs textuels jusqu'\xe0 l'avant-derni\xe8re interaction de la session."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"non_text_features"})," : une liste de vecteurs de caract\xe9ristiques non textuelles (la normalisation L2 et la concatenation des vecteurs ",(0,a.jsx)(s.code,{children:"query_vector"}),", ",(0,a.jsx)(s.code,{children:"description_vector"})," et ",(0,a.jsx)(s.code,{children:"image_vector"}),") pour chaque interaction."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"labels"})," : une liste de labels, o\xf9 chaque label est l'identifiant du produit de l'interaction suivante dans la session."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"futures"})," : une liste des interactions futures dans la session, apr\xe8s l'interaction actuelle."]}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:"Il est important se rappeler de la valeur encod\xe9e de l'identifiant unique des produits que nous avons cr\xe9\xe9 \xe0 l'\xe9tape 6. Cet identifiant unique (nomm\xe9 \"common_product\") regroupe tous les produits apparaissant dans moins de cinq interactions. Cet identifiant unique doit \xeatre retir\xe9 des interactions futures pour \xe9viter de fausser l'\xe9valuation de la performance du mod\xe8le."}),"\n",(0,a.jsxs)(s.p,{children:["Par exemple, supposons ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mtext,{mathvariant:"bold",children:"session"}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsx)(s.mo,{stretchy:"false",children:"["}),(0,a.jsx)(s.mn,{children:"15943"}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsx)(s.mn,{children:"10392"}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsx)(s.mn,{children:"6253"}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsx)(s.mn,{children:"15943"}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsx)(s.mn,{children:"7528"}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsx)(s.mn,{children:"9841"}),(0,a.jsx)(s.mo,{stretchy:"false",children:"]"})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\textbf{session} = [15943, 10392, 6253, 15943, 7528, 9841]"})]})})}),(0,a.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.6944em"}}),(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord textbf",children:"session"})}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(s.span,{className:"mrel",children:"="}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,a.jsx)(s.span,{className:"mopen",children:"["}),(0,a.jsx)(s.span,{className:"mord",children:"15943"}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"10392"}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"6253"}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"15943"}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"7528"}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"9841"}),(0,a.jsx)(s.span,{className:"mclose",children:"]"})]})]})]})," repr\xe9sentant une s\xe9quence d'interaction au cours d'une m\xeame, les ensembles ",(0,a.jsx)(s.code,{children:"text_sequences"}),", ",(0,a.jsx)(s.code,{children:"labels"})," et ",(0,a.jsx)(s.code,{children:"futures"})," seront cr\xe9\xe9s de la fa\xe7on suivante :"]}),"\n",(0,a.jsx)(s.span,{className:"katex-display",children:(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mtext,{mathvariant:"bold",children:"text"}),(0,a.jsx)(s.mi,{mathvariant:"normal",children:"_"}),(0,a.jsx)(s.mtext,{children:"sequences"}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{fence:"true",children:"["}),(0,a.jsxs)(s.mtable,{rowspacing:"0.16em",columnalign:"left",columnspacing:"1em",children:[(0,a.jsx)(s.mtr,{children:(0,a.jsx)(s.mtd,{children:(0,a.jsx)(s.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,a.jsxs)(s.mrow,{children:[(0,a.jsxs)(s.msup,{children:[(0,a.jsx)(s.mrow,{}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"}),(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"})]})]}),(0,a.jsx)(s.mn,{children:"1594"}),(0,a.jsxs)(s.msup,{children:[(0,a.jsx)(s.mn,{children:"3"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"}),(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"})]})]})]})})})}),(0,a.jsx)(s.mtr,{children:(0,a.jsx)(s.mtd,{children:(0,a.jsx)(s.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,a.jsxs)(s.mrow,{children:[(0,a.jsxs)(s.msup,{children:[(0,a.jsx)(s.mrow,{}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"}),(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"})]})]}),(0,a.jsx)(s.mn,{children:"15943"}),(0,a.jsx)(s.mo,{separator:"true",children:";"}),(0,a.jsx)(s.mn,{children:"1039"}),(0,a.jsxs)(s.msup,{children:[(0,a.jsx)(s.mn,{children:"2"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"}),(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"})]})]})]})})})}),(0,a.jsx)(s.mtr,{children:(0,a.jsx)(s.mtd,{children:(0,a.jsx)(s.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,a.jsxs)(s.mrow,{children:[(0,a.jsxs)(s.msup,{children:[(0,a.jsx)(s.mrow,{}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"}),(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"})]})]}),(0,a.jsx)(s.mn,{children:"15943"}),(0,a.jsx)(s.mo,{separator:"true",children:";"}),(0,a.jsx)(s.mn,{children:"10392"}),(0,a.jsx)(s.mo,{separator:"true",children:";"}),(0,a.jsx)(s.mn,{children:"625"}),(0,a.jsxs)(s.msup,{children:[(0,a.jsx)(s.mn,{children:"3"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"}),(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"})]})]})]})})})}),(0,a.jsx)(s.mtr,{children:(0,a.jsx)(s.mtd,{children:(0,a.jsx)(s.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,a.jsxs)(s.mrow,{children:[(0,a.jsxs)(s.msup,{children:[(0,a.jsx)(s.mrow,{}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"}),(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"})]})]}),(0,a.jsx)(s.mn,{children:"15943"}),(0,a.jsx)(s.mo,{separator:"true",children:";"}),(0,a.jsx)(s.mn,{children:"10392"}),(0,a.jsx)(s.mo,{separator:"true",children:";"}),(0,a.jsx)(s.mn,{children:"6253"}),(0,a.jsx)(s.mo,{separator:"true",children:";"}),(0,a.jsx)(s.mn,{children:"1594"}),(0,a.jsxs)(s.msup,{children:[(0,a.jsx)(s.mn,{children:"3"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"}),(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"})]})]})]})})})}),(0,a.jsx)(s.mtr,{children:(0,a.jsx)(s.mtd,{children:(0,a.jsx)(s.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,a.jsxs)(s.mrow,{children:[(0,a.jsxs)(s.msup,{children:[(0,a.jsx)(s.mrow,{}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"}),(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"})]})]}),(0,a.jsx)(s.mn,{children:"15943"}),(0,a.jsx)(s.mo,{separator:"true",children:";"}),(0,a.jsx)(s.mn,{children:"10392"}),(0,a.jsx)(s.mo,{separator:"true",children:";"}),(0,a.jsx)(s.mn,{children:"6253"}),(0,a.jsx)(s.mo,{separator:"true",children:";"}),(0,a.jsx)(s.mn,{children:"15943"}),(0,a.jsx)(s.mo,{separator:"true",children:";"}),(0,a.jsx)(s.mn,{children:"752"}),(0,a.jsxs)(s.msup,{children:[(0,a.jsx)(s.mn,{children:"8"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"}),(0,a.jsx)(s.mo,{mathvariant:"normal",children:"\u2032"})]})]})]})})})})]}),(0,a.jsx)(s.mo,{fence:"true",children:"]"})]}),(0,a.jsx)(s.mspace,{linebreak:"newline"}),(0,a.jsx)(s.mtext,{mathvariant:"bold",children:"labels"}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{fence:"true",children:"["}),(0,a.jsxs)(s.mtable,{rowspacing:"0.16em",columnalign:"left",columnspacing:"1em",children:[(0,a.jsx)(s.mtr,{children:(0,a.jsx)(s.mtd,{children:(0,a.jsx)(s.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,a.jsx)(s.mn,{children:"10392"})})})}),(0,a.jsx)(s.mtr,{children:(0,a.jsx)(s.mtd,{children:(0,a.jsx)(s.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,a.jsx)(s.mn,{children:"6253"})})})}),(0,a.jsx)(s.mtr,{children:(0,a.jsx)(s.mtd,{children:(0,a.jsx)(s.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,a.jsx)(s.mn,{children:"15943"})})})}),(0,a.jsx)(s.mtr,{children:(0,a.jsx)(s.mtd,{children:(0,a.jsx)(s.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,a.jsx)(s.mn,{children:"7528"})})})}),(0,a.jsx)(s.mtr,{children:(0,a.jsx)(s.mtd,{children:(0,a.jsx)(s.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,a.jsx)(s.mn,{children:"9841"})})})})]}),(0,a.jsx)(s.mo,{fence:"true",children:"]"})]}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsx)(s.mtext,{children:"\xa0et\xa0"}),(0,a.jsx)(s.mtext,{mathvariant:"bold",children:"futures"}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{fence:"true",children:"["}),(0,a.jsxs)(s.mtable,{rowspacing:"0.16em",columnalign:"left",columnspacing:"1em",children:[(0,a.jsx)(s.mtr,{children:(0,a.jsx)(s.mtd,{children:(0,a.jsx)(s.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{stretchy:"false",children:"["}),(0,a.jsx)(s.mn,{children:"10392"}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsx)(s.mn,{children:"6253"}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsx)(s.mn,{children:"15943"}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsx)(s.mn,{children:"7528"}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsx)(s.mn,{children:"9841"}),(0,a.jsx)(s.mo,{stretchy:"false",children:"]"})]})})})}),(0,a.jsx)(s.mtr,{children:(0,a.jsx)(s.mtd,{children:(0,a.jsx)(s.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{stretchy:"false",children:"["}),(0,a.jsx)(s.mn,{children:"6253"}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsx)(s.mn,{children:"15943"}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsx)(s.mn,{children:"7528"}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsx)(s.mn,{children:"9841"}),(0,a.jsx)(s.mo,{stretchy:"false",children:"]"})]})})})}),(0,a.jsx)(s.mtr,{children:(0,a.jsx)(s.mtd,{children:(0,a.jsx)(s.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{stretchy:"false",children:"["}),(0,a.jsx)(s.mn,{children:"15943"}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsx)(s.mn,{children:"7528"}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsx)(s.mn,{children:"9841"}),(0,a.jsx)(s.mo,{stretchy:"false",children:"]"})]})})})}),(0,a.jsx)(s.mtr,{children:(0,a.jsx)(s.mtd,{children:(0,a.jsx)(s.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{stretchy:"false",children:"["}),(0,a.jsx)(s.mn,{children:"7528"}),(0,a.jsx)(s.mo,{separator:"true",children:","}),(0,a.jsx)(s.mn,{children:"9841"}),(0,a.jsx)(s.mo,{stretchy:"false",children:"]"})]})})})}),(0,a.jsx)(s.mtr,{children:(0,a.jsx)(s.mtd,{children:(0,a.jsx)(s.mstyle,{scriptlevel:"0",displaystyle:"false",children:(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mo,{stretchy:"false",children:"["}),(0,a.jsx)(s.mn,{children:"9841"}),(0,a.jsx)(s.mo,{stretchy:"false",children:"]"})]})})})})]}),(0,a.jsx)(s.mo,{fence:"true",children:"]"})]})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\textbf{text}\\_\\text{sequences} =\n\\left[ \\begin{array}{l}\n  ''15943'' \\\\\n  ''15943; 10392'' \\\\\n  ''15943; 10392; 6253'' \\\\\n  ''15943; 10392; 6253; 15943'' \\\\\n  ''15943; 10392; 6253; 15943; 7528''\n\\end{array} \\right] \\\\\n\\textbf{labels} =\n\\left[ \\begin{array}{l}\n  10392 \\\\\n  6253 \\\\\n  15943 \\\\\n  7528 \\\\\n  9841\n\\end{array} \\right], \\text{ et }\n\\textbf{futures} =\n\\left[ \\begin{array}{l}\n  [10392, 6253, 15943, 7528, 9841] \\\\\n  [6253, 15943, 7528, 9841] \\\\\n  [15943, 7528, 9841] \\\\\n  [7528, 9841] \\\\\n  [9841]\n\\end{array} \\right]"})]})})}),(0,a.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.9449em",verticalAlign:"-0.31em"}}),(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord textbf",children:"text"})}),(0,a.jsx)(s.span,{className:"mord",style:{marginRight:"0.02778em"},children:"_"}),(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord",children:"sequences"})}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(s.span,{className:"mrel",children:"="}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"6em",verticalAlign:"-2.75em"}}),(0,a.jsxs)(s.span,{className:"minner",children:[(0,a.jsx)(s.span,{className:"mopen",children:(0,a.jsx)(s.span,{className:"delimsizing mult",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"3.25em"},children:(0,a.jsxs)(s.span,{style:{top:"-5.25em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"8em"}}),(0,a.jsx)(s.span,{style:{width:"0.667em",height:"6.000em"},children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",width:"0.667em",height:"6.000em",viewBox:"0 0 667 6000",children:(0,a.jsx)(s.path,{d:"M403 1759 V84 H666 V0 H319 V1759 v2400 v1759 h347 v-84\nH403z M403 1759 V0 H319 V1759 v2400 v1759 h84z"})})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"2.75em"},children:(0,a.jsx)(s.span,{})})})]})})}),(0,a.jsx)(s.span,{className:"mord",children:(0,a.jsxs)(s.span,{className:"mtable",children:[(0,a.jsx)(s.span,{className:"arraycolsep",style:{width:"0.5em"}}),(0,a.jsx)(s.span,{className:"col-align-l",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"3.25em"},children:[(0,a.jsxs)(s.span,{style:{top:"-5.41em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.7519em"},children:(0,a.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"\u2032\u2032"})})})]})})})})})]}),(0,a.jsx)(s.span,{className:"mord",children:"1594"}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord",children:"3"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.7519em"},children:(0,a.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"\u2032\u2032"})})})]})})})})})]})]})]}),(0,a.jsxs)(s.span,{style:{top:"-4.21em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.7519em"},children:(0,a.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"\u2032\u2032"})})})]})})})})})]}),(0,a.jsx)(s.span,{className:"mord",children:"15943"}),(0,a.jsx)(s.span,{className:"mpunct",children:";"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"1039"}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord",children:"2"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.7519em"},children:(0,a.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"\u2032\u2032"})})})]})})})})})]})]})]}),(0,a.jsxs)(s.span,{style:{top:"-3.01em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.7519em"},children:(0,a.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"\u2032\u2032"})})})]})})})})})]}),(0,a.jsx)(s.span,{className:"mord",children:"15943"}),(0,a.jsx)(s.span,{className:"mpunct",children:";"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"10392"}),(0,a.jsx)(s.span,{className:"mpunct",children:";"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"625"}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord",children:"3"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.7519em"},children:(0,a.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"\u2032\u2032"})})})]})})})})})]})]})]}),(0,a.jsxs)(s.span,{style:{top:"-1.81em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.7519em"},children:(0,a.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"\u2032\u2032"})})})]})})})})})]}),(0,a.jsx)(s.span,{className:"mord",children:"15943"}),(0,a.jsx)(s.span,{className:"mpunct",children:";"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"10392"}),(0,a.jsx)(s.span,{className:"mpunct",children:";"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"6253"}),(0,a.jsx)(s.span,{className:"mpunct",children:";"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"1594"}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord",children:"3"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.7519em"},children:(0,a.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"\u2032\u2032"})})})]})})})})})]})]})]}),(0,a.jsxs)(s.span,{style:{top:"-0.61em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.7519em"},children:(0,a.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"\u2032\u2032"})})})]})})})})})]}),(0,a.jsx)(s.span,{className:"mord",children:"15943"}),(0,a.jsx)(s.span,{className:"mpunct",children:";"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"10392"}),(0,a.jsx)(s.span,{className:"mpunct",children:";"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"6253"}),(0,a.jsx)(s.span,{className:"mpunct",children:";"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"15943"}),(0,a.jsx)(s.span,{className:"mpunct",children:";"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"752"}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord",children:"8"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.7519em"},children:(0,a.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:"\u2032\u2032"})})})]})})})})})]})]})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"2.75em"},children:(0,a.jsx)(s.span,{})})})]})}),(0,a.jsx)(s.span,{className:"arraycolsep",style:{width:"0.5em"}})]})}),(0,a.jsx)(s.span,{className:"mclose",children:(0,a.jsx)(s.span,{className:"delimsizing mult",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"3.25em"},children:(0,a.jsxs)(s.span,{style:{top:"-5.25em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"8em"}}),(0,a.jsx)(s.span,{style:{width:"0.667em",height:"6.000em"},children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",width:"0.667em",height:"6.000em",viewBox:"0 0 667 6000",children:(0,a.jsx)(s.path,{d:"M347 1759 V0 H0 V84 H263 V1759 v2400 v1759 H0 v84 H347z\nM347 1759 V0 H263 V1759 v2400 v1759 h84z"})})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"2.75em"},children:(0,a.jsx)(s.span,{})})})]})})})]})]}),(0,a.jsx)(s.span,{className:"mspace newline"}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.6944em"}}),(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord textbf",children:"labels"})}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(s.span,{className:"mrel",children:"="}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"6em",verticalAlign:"-2.75em"}}),(0,a.jsxs)(s.span,{className:"minner",children:[(0,a.jsx)(s.span,{className:"mopen",children:(0,a.jsx)(s.span,{className:"delimsizing mult",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"3.25em"},children:(0,a.jsxs)(s.span,{style:{top:"-5.25em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"8em"}}),(0,a.jsx)(s.span,{style:{width:"0.667em",height:"6.000em"},children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",width:"0.667em",height:"6.000em",viewBox:"0 0 667 6000",children:(0,a.jsx)(s.path,{d:"M403 1759 V84 H666 V0 H319 V1759 v2400 v1759 h347 v-84\nH403z M403 1759 V0 H319 V1759 v2400 v1759 h84z"})})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"2.75em"},children:(0,a.jsx)(s.span,{})})})]})})}),(0,a.jsx)(s.span,{className:"mord",children:(0,a.jsxs)(s.span,{className:"mtable",children:[(0,a.jsx)(s.span,{className:"arraycolsep",style:{width:"0.5em"}}),(0,a.jsx)(s.span,{className:"col-align-l",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"3.25em"},children:[(0,a.jsxs)(s.span,{style:{top:"-5.41em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:(0,a.jsx)(s.span,{className:"mord",children:"10392"})})]}),(0,a.jsxs)(s.span,{style:{top:"-4.21em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:(0,a.jsx)(s.span,{className:"mord",children:"6253"})})]}),(0,a.jsxs)(s.span,{style:{top:"-3.01em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:(0,a.jsx)(s.span,{className:"mord",children:"15943"})})]}),(0,a.jsxs)(s.span,{style:{top:"-1.81em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:(0,a.jsx)(s.span,{className:"mord",children:"7528"})})]}),(0,a.jsxs)(s.span,{style:{top:"-0.61em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:(0,a.jsx)(s.span,{className:"mord",children:"9841"})})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"2.75em"},children:(0,a.jsx)(s.span,{})})})]})}),(0,a.jsx)(s.span,{className:"arraycolsep",style:{width:"0.5em"}})]})}),(0,a.jsx)(s.span,{className:"mclose",children:(0,a.jsx)(s.span,{className:"delimsizing mult",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"3.25em"},children:(0,a.jsxs)(s.span,{style:{top:"-5.25em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"8em"}}),(0,a.jsx)(s.span,{style:{width:"0.667em",height:"6.000em"},children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",width:"0.667em",height:"6.000em",viewBox:"0 0 667 6000",children:(0,a.jsx)(s.path,{d:"M347 1759 V0 H0 V84 H263 V1759 v2400 v1759 H0 v84 H347z\nM347 1759 V0 H263 V1759 v2400 v1759 h84z"})})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"2.75em"},children:(0,a.jsx)(s.span,{})})})]})})})]}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord",children:"\xa0et\xa0"})}),(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord textbf",children:"futures"})}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(s.span,{className:"mrel",children:"="}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"6em",verticalAlign:"-2.75em"}}),(0,a.jsxs)(s.span,{className:"minner",children:[(0,a.jsx)(s.span,{className:"mopen",children:(0,a.jsx)(s.span,{className:"delimsizing mult",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"3.25em"},children:(0,a.jsxs)(s.span,{style:{top:"-5.25em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"8em"}}),(0,a.jsx)(s.span,{style:{width:"0.667em",height:"6.000em"},children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",width:"0.667em",height:"6.000em",viewBox:"0 0 667 6000",children:(0,a.jsx)(s.path,{d:"M403 1759 V84 H666 V0 H319 V1759 v2400 v1759 h347 v-84\nH403z M403 1759 V0 H319 V1759 v2400 v1759 h84z"})})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"2.75em"},children:(0,a.jsx)(s.span,{})})})]})})}),(0,a.jsx)(s.span,{className:"mord",children:(0,a.jsxs)(s.span,{className:"mtable",children:[(0,a.jsx)(s.span,{className:"arraycolsep",style:{width:"0.5em"}}),(0,a.jsx)(s.span,{className:"col-align-l",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"3.25em"},children:[(0,a.jsxs)(s.span,{style:{top:"-5.41em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mopen",children:"["}),(0,a.jsx)(s.span,{className:"mord",children:"10392"}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"6253"}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"15943"}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"7528"}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"9841"}),(0,a.jsx)(s.span,{className:"mclose",children:"]"})]})]}),(0,a.jsxs)(s.span,{style:{top:"-4.21em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mopen",children:"["}),(0,a.jsx)(s.span,{className:"mord",children:"6253"}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"15943"}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"7528"}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"9841"}),(0,a.jsx)(s.span,{className:"mclose",children:"]"})]})]}),(0,a.jsxs)(s.span,{style:{top:"-3.01em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mopen",children:"["}),(0,a.jsx)(s.span,{className:"mord",children:"15943"}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"7528"}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"9841"}),(0,a.jsx)(s.span,{className:"mclose",children:"]"})]})]}),(0,a.jsxs)(s.span,{style:{top:"-1.81em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mopen",children:"["}),(0,a.jsx)(s.span,{className:"mord",children:"7528"}),(0,a.jsx)(s.span,{className:"mpunct",children:","}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mord",children:"9841"}),(0,a.jsx)(s.span,{className:"mclose",children:"]"})]})]}),(0,a.jsxs)(s.span,{style:{top:"-0.61em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mopen",children:"["}),(0,a.jsx)(s.span,{className:"mord",children:"9841"}),(0,a.jsx)(s.span,{className:"mclose",children:"]"})]})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"2.75em"},children:(0,a.jsx)(s.span,{})})})]})}),(0,a.jsx)(s.span,{className:"arraycolsep",style:{width:"0.5em"}})]})}),(0,a.jsx)(s.span,{className:"mclose",children:(0,a.jsx)(s.span,{className:"delimsizing mult",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"3.25em"},children:(0,a.jsxs)(s.span,{style:{top:"-5.25em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"8em"}}),(0,a.jsx)(s.span,{style:{width:"0.667em",height:"6.000em"},children:(0,a.jsx)(s.svg,{xmlns:"http://www.w3.org/2000/svg",width:"0.667em",height:"6.000em",viewBox:"0 0 667 6000",children:(0,a.jsx)(s.path,{d:"M347 1759 V0 H0 V84 H263 V1759 v2400 v1759 H0 v84 H347z\nM347 1759 V0 H263 V1759 v2400 v1759 h84z"})})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"2.75em"},children:(0,a.jsx)(s.span,{})})})]})})})]})]})]})]})}),"\n",(0,a.jsxs)(s.p,{children:["Le mod\xe8le sera entra\xeen\xe9 avec les ensembles ",(0,a.jsx)(s.code,{children:"text_sequences"})," et ",(0,a.jsx)(s.code,{children:"non_text_features"})," pour pr\xe9dire le produit de la prochaine interaction dans ",(0,a.jsx)(s.code,{children:"labels"})," et la performance du mod\xe8le sera \xe9valu\xe9e sur sa capacit\xe9 \xe0 pr\xe9dire les prochains produits se trouvant dans les interactions futures (",(0,a.jsx)(s.code,{children:"futures"}),")."]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"\xc9tape 2 : Tokenisation"})," : Le tokenizer XLNet est utilis\xe9 pour convertir les ",(0,a.jsx)(s.code,{children:"text_sequences"})," en ",(0,a.jsx)(s.code,{children:"input_ids"})," et ",(0,a.jsx)(s.code,{children:"attention_masks"}),". Ces derniers aident le mod\xe8le \xe0 se concentrer sur les parties pertinentes de chaque s\xe9quence textuelle. Ce processus est essentiel pour pr\xe9parer les donn\xe9es textuelles pour l'entra\xeenement avec le mod\xe8le de langage XLNet."]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"\xc9tape 3 : Conversion en tenseurs"})," : Les vecteurs de caract\xe9ristiques non textuelles (",(0,a.jsx)(s.code,{children:"non_text_features"}),") et les labels (",(0,a.jsx)(s.code,{children:"labels"}),") sont convertis en tenseurs pour \xeatre utilis\xe9s dans le processus d'entra\xeenement."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'def prepare_data(sessions: list, non_text_features_all: list, max_seq_length: int):\n    text_sequences = []\n    non_text_features_prepared = []\n    labels = []\n    futures = []\n\n    for session, non_text_features in zip(sessions, non_text_features_all):\n        # Boucle pour chaque fen\xeatre de 4 interactions dans la session\n        # Requis pour \xe9viter des d\xe9passements de capacit\xe9 m\xe9moire.\n        for i in range(len(session) - 4):\n            # Cr\xe9ation de la s\xe9quence de texte\n            # Ins\xe9rer un "|" entre chaque interaction et un ";" entre chaque caract\xe9ristique.\n            text_seq = "|".join([";".join([str(field) for field in interaction[:-1]]) for interaction in session[i:i+4]])\n\n            if max_seq_length > 0:\n                if len(text_seq) > max_seq_length:\n                    text_seq = text_seq[:max_seq_length]  # Tronquer\n                else:\n                    text_seq += " " * (max_seq_length - len(text_seq))  # Remplir avec des espaces\n\n            text_sequences.append(text_seq)\n\n            # Traitement des caract\xe9ristiques non textuelles pour l\'interaction suivante\n            non_text_vector = non_text_features[i+4]\n            non_text_features_prepared.append(non_text_vector)\n\n            # L\'\xe9tiquette est la premi\xe8re colonne de l\'interaction suivante apr\xe8s la fen\xeatre\n            label = int(session[i+4, 0])\n            labels.append(label)\n\n            # Les interactions futures sont dans la premi\xe8re colonne des interactions suivantes.\n            # Limiter le nombre d\'interactions futures \xe0 20.\n            future_interactions = session[i+4:i+24, 0]\n            futures.append(future_interactions)\n\n    return text_sequences, non_text_features_prepared, labels, futures\n\n# Ex\xe9cuter avec \'max_seq_length=-1\' pour conna\xeetre la longueur des s\xe9quences cr\xe9\xe9es.\nprint("Cr\xe9ation des ensemble de donn\xe9es pour l\'entrainement et l\'\xe9valuation")\nmax_seq_length = params["max_seq_length"]\nprint(f"max_seq_length: {max_seq_length}")\ntext_sequences, non_text_features, labels, futures = prepare_data(sessions, non_text_features_all, -1)\n'})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"print(f\"Nombre total de 'text_sequences': {len(text_sequences)}\")\nprint(f\"Nombre total de 'non_text_features': {len(non_text_features)}\")\nprint(f\"Nombre total de 'labels': {len(labels)}\")\nprint(f\"Nombre total de 'futures': {len(futures)}\")\n"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'import matplotlib.pyplot as plt\nimport numpy as np\n\n# Calculer la longueur de chaque cha\xeene dans \'text_sequences\'\nlengths = [len(text_seq) for text_seq in text_sequences]\n\n# Calculer les statistiques\nmin_length = np.min(lengths)\np5 = np.percentile(lengths, 5)\np25 = np.percentile(lengths, 25)\np50 = np.percentile(lengths, 50)\np75 = np.percentile(lengths, 75)\np95 = np.percentile(lengths, 95)\nmax_length = np.max(lengths)\n\n# Afficher les statistiques\nprint(f"Minimum: {min_length}")\nprint(f"5\xe8me percentile (p5): {p5:.0f}")\nprint(f"25\xe8me percentile (p25): {p25:.0f}")\nprint(f"50\xe8me percentile (p50): {p50:.0f}")\nprint(f"75\xe8me percentile (p75): {p75:.0f}")\nprint(f"95\xe8me percentile (p95): {p95:.0f}")\nprint(f"Maximum: {max_length}")\n\n# Cr\xe9er un histogramme de ces longueurs\nplt.hist(lengths, bins=30)\nplt.title("Distribution des longueurs des valeurs dans \'text_sequences\'")\nplt.xlabel("Longueur de la cha\xeene")\nplt.ylabel("Nombre de cha\xeenes")\nplt.show()\n\n'})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'import matplotlib.pyplot as plt\n\n# Calculer la longueur de chaque liste dans \'futures\'\nlengths = [len(future) for future in futures]\n\n# Calculer les statistiques\nmin_length = np.min(lengths)\np5 = np.percentile(lengths, 5)\np25 = np.percentile(lengths, 25)\np95 = np.percentile(lengths, 95)\nmax_length = np.max(lengths)\n\n# Afficher les statistiques\nprint(f"Minimum: {min_length}")\nprint(f"5\xe8me percentile (p5): {p5:.0f}")\nprint(f"25\xe8me percentile (p25): {p25:.0f}")\nprint(f"95\xe8me percentile (p95): {p95:.0f}")\nprint(f"Maximum: {max_length}")\n\n# Compter le nombre de s\xe9quences ayant au moins 20 interactions futures\ncount_lt_20 = len([l for l in lengths if l < 20])\ncount_ge_20 = len([l for l in lengths if l >= 20])\n\n# Afficher les r\xe9sultats\ntotal = count_lt_20 + count_ge_20\npct_lt_20 = count_lt_20 / total * 100\npct_ge_20 = count_ge_20 / total * 100\nprint(f"Nombre avec moins de 20 interactions futures: {count_lt_20} ({pct_lt_20:.1f}%)")\nprint(f"Nombre avec au moins 20 interactions futures: {count_ge_20} ({pct_ge_20:.1f}%)")\n\n# Cr\xe9er un histogramme de ces longueurs\nplt.hist(lengths, bins=30)  # Vous pouvez ajuster le nombre de \'bins\' selon le besoin\nplt.title("Distribution des longueurs des listes dans \'futures\'")\nplt.xlabel("Longueur")\nplt.ylabel("Nombre de listes")\nplt.show()\n'})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'# Ex\xe9cuter \xe0 nouveau en appliquant \'max_seq_length\' selon les param\xe8tres.\nprint("Cr\xe9ation des ensemble de donn\xe9es pour l\'entrainement et l\'\xe9valuation")\nmax_seq_length = params["max_seq_length"]\nprint(f"max_seq_length: {max_seq_length}")\ntext_sequences, non_text_features, labels, futures = prepare_data(sessions, non_text_features_all, max_seq_length)\n'})}),"\n",(0,a.jsx)(s.h3,{id:"tokenisation-des-s\xe9quences-de-texte",children:"Tokenisation des s\xe9quences de texte"}),"\n",(0,a.jsxs)(s.p,{children:["Les param\xe8tres utilis\xe9s dans la m\xe9thode ",(0,a.jsx)(s.code,{children:"encode_plus"})," de la classe ",(0,a.jsx)(s.code,{children:"XLNetTokenizer"})," de la biblioth\xe8que ",(0,a.jsx)(s.code,{children:"transformers"})," sont :"]}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"seq"})}),": C'est la s\xe9quence de texte que que nous voulons tokeniser. Dans notre cas, ",(0,a.jsx)(s.code,{children:"seq"})," repr\xe9sente chaque \xe9l\xe9ment de ",(0,a.jsx)(s.code,{children:"text_sequences"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"add_special_tokens"})}),": Lorsque ce param\xe8tre est d\xe9fini sur ",(0,a.jsx)(s.code,{children:"True"}),", le tokenizer ajoutera des tokens sp\xe9ciaux au d\xe9but et \xe0 la fin de chaque s\xe9quence. Pour XLNet, cela inclut g\xe9n\xe9ralement les tokens de d\xe9but et de fin de s\xe9quence."]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"max_length"})}),": Ceci d\xe9finit la longueur maximale d'une s\xe9quence tokenis\xe9e. Si une s\xe9quence est plus longue que cette valeur, elle sera tronqu\xe9e \xe0 ",(0,a.jsx)(s.code,{children:"max_length"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"truncation"})}),": Lorsqu'il est d\xe9fini sur ",(0,a.jsx)(s.code,{children:"True"}),", cela permet au tokenizer de tronquer les s\xe9quences qui d\xe9passent ",(0,a.jsx)(s.code,{children:"max_length"}),". C'est n\xe9cessaire pour normaliser la longueur des s\xe9quences, ce qui est important pour les mod\xe8les bas\xe9s sur les transformers qui n\xe9cessitent une longueur de s\xe9quence fixe."]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"padding"})}),": Ce param\xe8tre contr\xf4le comment le padding est ajout\xe9 aux s\xe9quences plus courtes que ",(0,a.jsx)(s.code,{children:"max_length"}),". Quand il est r\xe9gl\xe9 sur ",(0,a.jsx)(s.code,{children:'"max_length"'}),", le tokenizer ajoutera du padding \xe0 la s\xe9quence jusqu'\xe0 ce qu'elle atteigne ",(0,a.jsx)(s.code,{children:"max_length"}),". Le padding est g\xe9n\xe9ralement ajout\xe9 \xe0 la fin de la s\xe9quence."]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"return_attention_mask"})}),": Si r\xe9gl\xe9 sur ",(0,a.jsx)(s.code,{children:"True"}),", le tokenizer retournera un masque d'attention en plus des IDs de tokens. Le masque d'attention a des 1 pour chaque token significatif et des 0 pour tout padding ajout\xe9, indiquant au mod\xe8le les parties de la s\xe9quence \xe0 ignorer pendant l'entra\xeenement ou l'inf\xe9rence."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["Les valeurs retourn\xe9es par ",(0,a.jsx)(s.code,{children:"encode_plus"})," dans votre code sont :"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"input_ids"})}),": Une liste d'identifiants de tokens repr\xe9sentant la s\xe9quence de texte apr\xe8s tokenisation."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.code,{children:"attention_masks"})}),": Le masque d'attention correspondant, indiquant au mod\xe8le quels tokens doivent \xeatre pris en compte et quels tokens sont des paddings."]}),"\n"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'from transformers import XLNetTokenizer\n\ndef tokenize_sequences(text_sequences, tokenizer, max_seq_length: int):\n    input_ids = []\n    attention_masks = []\n\n    for seq in text_sequences:\n        encoded_seq = tokenizer.encode_plus(\n            seq,\n            add_special_tokens=True,  # Ajouter des tokens sp\xe9ciaux\n            max_length=max_seq_length,  # Longueur maximale de la s\xe9quence\n            truncation=True,  # Tronquer si la s\xe9quence est plus longue que max_length\n            padding="max_length",  # Ajouter du padding pour atteindre max_length\n            return_attention_mask=True,  # Renvoyer le masque d\'attention\n        )\n        input_ids.append(encoded_seq["input_ids"])\n        attention_masks.append(encoded_seq["attention_mask"])\n\n    return input_ids, attention_masks\n\nprint("Tokenisation des s\xe9quences de texte")\nmodel_name = params["model_name"]\ntokenizer = XLNetTokenizer.from_pretrained(model_name)\ninput_ids, attention_masks = tokenize_sequences(text_sequences, tokenizer, max_seq_length)\n'})}),"\n",(0,a.jsx)(s.h3,{id:"cr\xe9ation-des-tenseurs",children:"Cr\xe9ation des tenseurs"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'import numpy as np\nimport torch\n\ndef create_tensors(input_ids, attention_masks, non_text_features, labels):\n    input_ids = torch.tensor(input_ids)\n    attention_masks = torch.tensor(attention_masks)\n    non_text_features = torch.tensor(np.array(non_text_features), dtype=torch.float32)\n    labels = torch.tensor(labels, dtype=torch.long)\n    return input_ids, attention_masks, non_text_features, labels\n\n\nprint("Cr\xe9ation des tenseurs")\ninput_ids, attention_masks, non_text_features, labels = create_tensors(\n    input_ids, attention_masks, non_text_features, labels\n)\n'})}),"\n",(0,a.jsx)(s.h2,{id:"\xe9tape-8---division-en-ensembles-dentra\xeenement-de-validation-et-de-test",children:"\xc9tape 8 - Division en ensembles d'entra\xeenement, de validation et de test"}),"\n",(0,a.jsxs)(s.p,{children:["Diviser les ensembles ",(0,a.jsx)(s.code,{children:"sequences"}),", ",(0,a.jsx)(s.code,{children:"labels"})," et ",(0,a.jsx)(s.code,{children:"futures"})," en ensembles d'entra\xeenement, de validation, et de test."]}),"\n",(0,a.jsxs)(s.p,{children:["Il est important de diviser \xe9galement l'ensemble ",(0,a.jsx)(s.code,{children:"futures"})," pour l'entra\xeenement, la validation et le test, tout comme pour ",(0,a.jsx)(s.code,{children:"sequences"})," et ",(0,a.jsx)(s.code,{children:"labels"}),", afin d'assurer la coh\xe9rence et l'int\xe9grit\xe9 des donn\xe9es \xe0 travers les diff\xe9rents ensembles, permettant ainsi une \xe9valuation de la performance du mod\xe8le, notamment avec les m\xe9triques MRR, precision@20 et recall@20."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'from sklearn.model_selection import train_test_split\n\ndef create_data_splits(input_ids, attention_masks, non_text_features,\n                       labels, futures, test_size=0.2, validation_size=0.2,\n):\n    # Cr\xe9er des indices pour les ensembles de donn\xe9es\n    indices = list(range(len(input_ids)))\n\n    # Diviser d\'abord les indices et les donn\xe9es\n    (train_indices, temp_indices,\n     train_input_ids, temp_input_ids,\n     train_attention_masks, temp_attention_masks,\n     train_non_text_features, temp_non_text_features,\n     train_labels, temp_labels,\n     train_futures, temp_futures) = train_test_split(\n         indices, input_ids, attention_masks, non_text_features, labels, futures,\n         test_size=test_size + validation_size, random_state=42,\n         )\n\n    # Diviser les indices et donn\xe9es temporaires en validation et test\n    (val_indices, test_indices,\n     val_input_ids, test_input_ids,\n     val_attention_masks, test_attention_masks,\n     val_non_text_features, test_non_text_features,\n     val_labels, test_labels,\n     val_futures, test_futures) = train_test_split(\n         temp_indices, temp_input_ids, temp_attention_masks,\n         temp_non_text_features, temp_labels, temp_futures,\n         test_size=test_size / (test_size + validation_size), random_state=42,\n         )\n\n    data_splits = {\n        "train": {\n            "input_ids": train_input_ids,\n            "attention_masks": train_attention_masks,\n            "non_text_features": train_non_text_features,\n            "labels": train_labels,\n            "futures": train_futures,\n        },\n        "val": {\n            "input_ids": val_input_ids,\n            "attention_masks": val_attention_masks,\n            "non_text_features": val_non_text_features,\n            "labels": val_labels,\n            "futures": val_futures,\n        },\n        "test": {\n            "input_ids": test_input_ids,\n            "attention_masks": test_attention_masks,\n            "non_text_features": test_non_text_features,\n            "labels": test_labels,\n            "futures": test_futures,\n        },\n    }\n\n    return data_splits\n'})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"print(\"Application de la division des donn\xe9es\")\ntest_size = params['test_size']\nvalidation_size = params['validation_size']\n\ndata_splits = create_data_splits(\n    input_ids,\n    attention_masks,\n    non_text_features,\n    labels,\n    futures,\n    test_size=test_size,\n    validation_size=validation_size,\n)\n"})}),"\n",(0,a.jsx)(s.h2,{id:"\xe9tape-9---cr\xe9ation-du-mod\xe8le",children:"\xc9tape 9 - Cr\xe9ation du mod\xe8le"}),"\n",(0,a.jsx)(s.p,{children:"Cr\xe9er un mod\xe8le de s\xe9quences de type Transformer XLNet."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'import torch\nfrom torch import nn\nimport torch.nn.init as init\nfrom transformers import XLNetModel\n\ndef create_model(model_name: str, label_encoders: dict, combined_vectors_length: int, dropout_rate: float, device: str):\n    class XLNetForSequencePrediction(nn.Module):\n        def __init__(self, model_name, num_classes, combined_vectors_length, dropout_rate: float):\n            super(XLNetForSequencePrediction, self).__init__()\n            self.xlnet = XLNetModel.from_pretrained(model_name)\n            self.non_text_feature_layer = nn.Linear(combined_vectors_length, self.xlnet.config.hidden_size)\n\n            # Ajouter une couche de Dropout\n            self.dropout = nn.Dropout(dropout_rate)\n\n            # Couche de sortie\n            self.output_layer = nn.Linear(self.xlnet.config.hidden_size, num_classes)\n\n        def forward(self, input_ids, attention_mask, non_text_features):\n            # Traitement des entr\xe9es textuelles avec XLNet\n            xlnet_output = self.xlnet(input_ids=input_ids, attention_mask=attention_mask)\n            text_embedding = xlnet_output.last_hidden_state[:, 0, :]  # Utiliser le CLS token\n\n            # Traitement des caract\xe9ristiques non textuelles\n            non_text_embedding = self.non_text_feature_layer(non_text_features)\n\n            # Combinaison des embeddings textuels et non textuels\n            combined_embedding = text_embedding + non_text_embedding\n\n            # Application du Dropout\n            combined_embedding = self.dropout(combined_embedding)\n\n            # Passage \xe0 travers la couche de sortie\n            output = self.output_layer(combined_embedding)\n\n            return output\n\n        def _init_weights(self, module):\n            """Initialise les poids du module."""\n            if isinstance(module, nn.Linear):\n                # Initialisation Xavier/Glorot pour les couches lin\xe9aires\n                init.xavier_uniform_(module.weight)\n                if module.bias is not None:\n                    init.zeros_(module.bias)\n\n    # R\xe9cup\xe9rer les encodeurs et d\xe9terminer le nombre de classes.\n    num_classes = len(label_encoders["product_url_hash"].classes_)\n\n    # Cr\xe9ation de l\'instance du mod\xe8le\n    model = XLNetForSequencePrediction(model_name, num_classes, combined_vectors_length, dropout_rate)\n    model.apply(model._init_weights)\n    model = model.to(device)\n\n    return model\n'})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"if torch.backends.mps.is_available():\n    device = torch.device('mps')\nelif torch.cuda.is_available():\n    device = torch.device('cuda')\nelse:\n    device = torch.device('cpu')\n\n# Cr\xe9ation du mod\xe8le.\ndropout_rate = params['dropout_rate']\nprint(f\"combined_vectors_length: {combined_vectors_length}\")\nprint(f\"dropout_rate: {dropout_rate}\")\nprint(f\"device: {device}\")\nmodel = create_model(model_name, label_encoders, combined_vectors_length, dropout_rate, device)\n"})}),"\n",(0,a.jsx)(s.h2,{id:"\xe9tape-10---cr\xe9ation-des-dataloaders",children:"\xc9tape 10 - Cr\xe9ation des DataLoaders"}),"\n",(0,a.jsxs)(s.p,{children:["Ce code pr\xe9pare les donn\xe9es pour l'entra\xeenement et la validation en les encapsulant dans des DataLoader de PyTorch fournissant une mani\xe8re efficace d'it\xe9rer sur les donn\xe9es en mini-lots (",(0,a.jsx)(s.em,{children:"batches"}),")."]}),"\n",(0,a.jsx)(s.p,{children:"Les DataLoader utilisent des \xe9chantillonneurs diff\xe9rents pour les ensembles d'entra\xeenement et de validation, garantissant la randomisation pour l'entra\xeenement et un ordre s\xe9quentiel pour la validation."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'from torch.utils.data import DataLoader, RandomSampler, SequentialSampler, TensorDataset\n\ndef create_dataloaders(data_splits: dict, batch_size: int):\n    dataloaders = {}\n\n    for split in ["train", "val", "test"]:\n        # Cr\xe9ation de TensorDatasets pour les ensembles d\'entra\xeenement, de validation et de test\n        data = TensorDataset(\n            data_splits[split]["input_ids"],\n            data_splits[split]["attention_masks"],\n            data_splits[split]["non_text_features"],\n            data_splits[split]["labels"],\n        )\n\n        # Cr\xe9ation de DataLoaders\n        if split == "train":\n            dataloaders[split] = DataLoader(data, sampler=RandomSampler(data), batch_size=batch_size)\n        else:\n            dataloaders[split] = DataLoader(data, sampler=SequentialSampler(data), batch_size=batch_size)\n\n    return dataloaders\n\nprint("Cr\xe9ation des DataLoaders")\nbatch_size = params[\'batch_size\']\nprint(f"batch_size: {batch_size}")\ndataloaders = create_dataloaders(data_splits, batch_size)\n'})}),"\n",(0,a.jsx)(s.h2,{id:"\xe9tape-11---\xe9valuations-du-mod\xe8le",children:"\xc9tape 11 - \xc9valuations du mod\xe8le"}),"\n",(0,a.jsx)(s.p,{children:"Nous \xe9valuons le mod\xe8le selon deux m\xe9triques :"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"Mean Reciprocal Rank (MRR)"}),"\n",(0,a.jsx)(s.li,{children:"Score F1"}),"\n"]}),"\n",(0,a.jsx)(s.h3,{id:"mean-reciprocal-rank-mrr20",children:"Mean Reciprocal Rank (MRR@20)"}),"\n",(0,a.jsxs)(s.p,{children:["La m\xe9trique ",(0,a.jsx)(s.strong,{children:"Mean Reciprocal Rank (MRR)"}),", mentionn\xe9e dans l'article de Coveo, est fr\xe9quemment utilis\xe9e dans les syst\xe8mes de recommandation pour \xe9valuer la performance d'un mod\xe8le, particuli\xe8rement dans des contextes o\xf9 l'ordre des recommandations est crucial."]}),"\n",(0,a.jsx)(s.p,{children:"Le MRR est une mesure qui consid\xe8re le rang de la premi\xe8re r\xe9ponse pertinente dans une liste de r\xe9ponses pr\xe9dites. Il se d\xe9finit comme la moyenne des inverses des rangs de ces premi\xe8res r\xe9ponses pertinentes. Voici sa m\xe9thode de calcul :"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"R\xe9ciproque du rang"})," : Pour chaque question ou requ\xeate (dans notre contexte, chaque s\xe9quence d'interactions utilisateur), il faut identifier le rang de la premi\xe8re pr\xe9diction pertinente. Ce rang correspond \xe0 la position de la pr\xe9diction pertinente dans la liste tri\xe9e de recommandations, en commen\xe7ant par 1. On calcule ensuite le r\xe9ciproque de ce rang. Par exemple, si la premi\xe8re r\xe9ponse pertinente est en deuxi\xe8me position, le r\xe9ciproque du rang est 1/2 = 0.5."]}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Moyenne des r\xe9ciproques des rangs"})," : La moyenne de ces valeurs r\xe9ciproques est ensuite calcul\xe9e sur l'ensemble des questions ou requ\xeates."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["Pour calculer le MRR, nous avons donc besoin d'une liste de pr\xe9dictions du mod\xe8le, o\xf9 ces pr\xe9dictions sont class\xe9es par ordre de probabilit\xe9 d\xe9croissante. Pour un ensemble de ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsx)(s.mrow,{children:(0,a.jsx)(s.mi,{children:"N"})}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"N"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"N"})]})})]})," interactions futures, o\xf9 ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsx)(s.mrow,{children:(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"r"}),(0,a.jsx)(s.mi,{children:"i"})]})}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"r_i"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.5806em",verticalAlign:"-0.15em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3117em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0278em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]})]})})]})," est le rang de la premi\xe8re interaction r\xe9elle future dans la liste des interactions pr\xe9dites class\xe9es par ordre de probabilit\xe9 d\xe9croissante, le MRR se calcule de la mani\xe8re suivante :"]}),"\n",(0,a.jsx)(s.span,{className:"katex-display",children:(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mtext,{children:"MRR"}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsxs)(s.mfrac,{children:[(0,a.jsx)(s.mn,{children:"1"}),(0,a.jsx)(s.mi,{children:"N"})]}),(0,a.jsxs)(s.munderover,{children:[(0,a.jsx)(s.mo,{children:"\u2211"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"i"}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsx)(s.mn,{children:"1"})]}),(0,a.jsx)(s.mi,{children:"N"})]}),(0,a.jsxs)(s.mfrac,{children:[(0,a.jsx)(s.mn,{children:"1"}),(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mi,{children:"r"}),(0,a.jsx)(s.mi,{children:"i"})]})]})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\text{MRR} = \\frac{1}{N} \\sum_{i=1}^{N} \\frac{1}{r_i}"})]})})}),(0,a.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord",children:"MRR"})}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(s.span,{className:"mrel",children:"="}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"3.106em",verticalAlign:"-1.2777em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,a.jsx)(s.span,{className:"mfrac",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"1.3214em"},children:[(0,a.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"N"})})]}),(0,a.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,a.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:(0,a.jsx)(s.span,{className:"mord",children:"1"})})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.686em"},children:(0,a.jsx)(s.span,{})})})]})}),(0,a.jsx)(s.span,{className:"mclose nulldelimiter"})]}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mop op-limits",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"1.8283em"},children:[(0,a.jsxs)(s.span,{style:{top:"-1.8723em",marginLeft:"0em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3.05em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(s.span,{className:"mord mtight",children:[(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"i"}),(0,a.jsx)(s.span,{className:"mrel mtight",children:"="}),(0,a.jsx)(s.span,{className:"mord mtight",children:"1"})]})})]}),(0,a.jsxs)(s.span,{style:{top:"-3.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3.05em"}}),(0,a.jsx)(s.span,{children:(0,a.jsx)(s.span,{className:"mop op-symbol large-op",children:"\u2211"})})]}),(0,a.jsxs)(s.span,{style:{top:"-4.3em",marginLeft:"0em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3.05em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mtight",children:(0,a.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10903em"},children:"N"})})})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"1.2777em"},children:(0,a.jsx)(s.span,{})})})]})}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,a.jsx)(s.span,{className:"mfrac",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"1.3214em"},children:[(0,a.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.3117em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0278em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(s.span,{})})})]})})]})})]}),(0,a.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,a.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:(0,a.jsx)(s.span,{className:"mord",children:"1"})})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.836em"},children:(0,a.jsx)(s.span,{})})})]})}),(0,a.jsx)(s.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,a.jsx)(s.p,{children:"Le MRR est une mesure qui favorise les mod\xe8les capables de placer les interactions pertinentes le plus haut possible dans la liste des pr\xe9dictions. Un MRR \xe9lev\xe9 indique que le mod\xe8le est performant dans l'identification de ce qui est pertinent pour l'utilisateur d\xe8s les premi\xe8res pr\xe9dictions."}),"\n",(0,a.jsx)(s.h3,{id:"precision20-recall20-et-f1-score",children:"Precision@20, Recall@20 et F1 score"}),"\n",(0,a.jsx)(s.p,{children:"L'article de Coveo mentionne \xe9galement les trois m\xe9triques suivantes."}),"\n",(0,a.jsxs)(s.p,{children:["La ",(0,a.jsx)(s.strong,{children:"precision@20"})," est le nombre de recommandations correctes dans les top-20 recommandations pour une session donn\xe9e, divis\xe9 par 20. La pr\xe9cision moyenne \xe0 20 sur toutes les sessions est la somme de la pr\xe9cision pour chaque session divis\xe9e par le nombre total de sessions. Voici la formule correcte :"]}),"\n",(0,a.jsx)(s.span,{className:"katex-display",children:(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mtext,{children:"Precision@20"}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsxs)(s.mfrac,{children:[(0,a.jsx)(s.mn,{children:"1"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"}),(0,a.jsx)(s.mi,{children:"S"}),(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"})]})]}),(0,a.jsxs)(s.munderover,{children:[(0,a.jsx)(s.mo,{children:"\u2211"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"s"}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsx)(s.mn,{children:"1"})]}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"}),(0,a.jsx)(s.mi,{children:"S"}),(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"})]})]}),(0,a.jsxs)(s.mfrac,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mtext,{children:"r"}),(0,a.jsxs)(s.mover,{accent:"true",children:[(0,a.jsx)(s.mtext,{children:"e"}),(0,a.jsx)(s.mo,{children:"\u02ca"})]}),(0,a.jsx)(s.mtext,{children:"el"})]}),(0,a.jsx)(s.mo,{stretchy:"false",children:"("}),(0,a.jsx)(s.mi,{children:"s"}),(0,a.jsx)(s.mo,{stretchy:"false",children:")"}),(0,a.jsx)(s.mo,{children:"\u2229"}),(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mtext,{children:"pred"}),(0,a.jsx)(s.mi,{children:"k"})]}),(0,a.jsx)(s.mo,{stretchy:"false",children:"("}),(0,a.jsx)(s.mi,{children:"s"}),(0,a.jsx)(s.mo,{stretchy:"false",children:")"}),(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"})]}),(0,a.jsx)(s.mi,{children:"k"})]})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\text{Precision@20} = \\frac{1}{|S|} \\sum_{s=1}^{|S|} \\frac{| \\text{r\xe9el}(s) \\cap \\text{pred}_k(s) |}{k}"})]})})}),(0,a.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.6944em"}}),(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord",children:"Precision@20"})}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(s.span,{className:"mrel",children:"="}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"3.2281em",verticalAlign:"-1.2671em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,a.jsx)(s.span,{className:"mfrac",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"1.3214em"},children:[(0,a.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord",children:"\u2223"}),(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"}),(0,a.jsx)(s.span,{className:"mord",children:"\u2223"})]})]}),(0,a.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,a.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:(0,a.jsx)(s.span,{className:"mord",children:"1"})})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.936em"},children:(0,a.jsx)(s.span,{})})})]})}),(0,a.jsx)(s.span,{className:"mclose nulldelimiter"})]}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mop op-limits",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"1.961em"},children:[(0,a.jsxs)(s.span,{style:{top:"-1.8829em",marginLeft:"0em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3.05em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(s.span,{className:"mord mtight",children:[(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"s"}),(0,a.jsx)(s.span,{className:"mrel mtight",children:"="}),(0,a.jsx)(s.span,{className:"mord mtight",children:"1"})]})})]}),(0,a.jsxs)(s.span,{style:{top:"-3.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3.05em"}}),(0,a.jsx)(s.span,{children:(0,a.jsx)(s.span,{className:"mop op-symbol large-op",children:"\u2211"})})]}),(0,a.jsxs)(s.span,{style:{top:"-4.386em",marginLeft:"0em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3.05em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(s.span,{className:"mord mtight",children:[(0,a.jsx)(s.span,{className:"mord mtight",children:"\u2223"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05764em"},children:"S"}),(0,a.jsx)(s.span,{className:"mord mtight",children:"\u2223"})]})})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"1.2671em"},children:(0,a.jsx)(s.span,{})})})]})}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,a.jsx)(s.span,{className:"mfrac",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"1.427em"},children:[(0,a.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"})})]}),(0,a.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,a.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord",children:"\u2223"}),(0,a.jsxs)(s.span,{className:"mord text",children:[(0,a.jsx)(s.span,{className:"mord",children:"r"}),(0,a.jsx)(s.span,{className:"mord accent",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsxs)(s.span,{className:"vlist",style:{height:"0.6944em"},children:[(0,a.jsxs)(s.span,{style:{top:"-3em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:"e"})]}),(0,a.jsxs)(s.span,{style:{top:"-3em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"accent-body",style:{left:"-0.25em"},children:(0,a.jsx)(s.span,{className:"mord",children:"\u02ca"})})]})]})})})}),(0,a.jsx)(s.span,{className:"mord",children:"el"})]}),(0,a.jsx)(s.span,{className:"mopen",children:"("}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,a.jsx)(s.span,{className:"mclose",children:")"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(s.span,{className:"mbin",children:"\u2229"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord",children:"pred"})}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.242em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.4559em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03148em"},children:"k"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.2441em"},children:(0,a.jsx)(s.span,{})})})]})})]}),(0,a.jsx)(s.span,{className:"mopen",children:"("}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,a.jsx)(s.span,{className:"mclose",children:")"}),(0,a.jsx)(s.span,{className:"mord",children:"\u2223"})]})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.686em"},children:(0,a.jsx)(s.span,{})})})]})}),(0,a.jsx)(s.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,a.jsx)(s.p,{children:"o\xf9 ( |S| ) est le nombre total de sessions et ( k ) est le nombre de recommandations \xe0 consid\xe9rer, ici 20."}),"\n",(0,a.jsxs)(s.p,{children:["Le ",(0,a.jsx)(s.strong,{children:"recall@20"})," est le nombre de recommandations correctes dans les top-20 recommandations pour une session donn\xe9e, divis\xe9 par le nombre total d'\xe9l\xe9ments pertinents dans cette session. Le rappel moyen \xe0 20 sur toutes les sessions est la somme du rappel pour chaque session divis\xe9e par le nombre total de sessions. Voici la formule correcte :"]}),"\n",(0,a.jsx)(s.span,{className:"katex-display",children:(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mtext,{children:"Recall@20"}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsxs)(s.mfrac,{children:[(0,a.jsx)(s.mn,{children:"1"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"}),(0,a.jsx)(s.mi,{children:"S"}),(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"})]})]}),(0,a.jsxs)(s.munderover,{children:[(0,a.jsx)(s.mo,{children:"\u2211"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"s"}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsx)(s.mn,{children:"1"})]}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"}),(0,a.jsx)(s.mi,{children:"S"}),(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"})]})]}),(0,a.jsxs)(s.mfrac,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mtext,{children:"r"}),(0,a.jsxs)(s.mover,{accent:"true",children:[(0,a.jsx)(s.mtext,{children:"e"}),(0,a.jsx)(s.mo,{children:"\u02ca"})]}),(0,a.jsx)(s.mtext,{children:"el"})]}),(0,a.jsx)(s.mo,{stretchy:"false",children:"("}),(0,a.jsx)(s.mi,{children:"s"}),(0,a.jsx)(s.mo,{stretchy:"false",children:")"}),(0,a.jsx)(s.mo,{children:"\u2229"}),(0,a.jsxs)(s.msub,{children:[(0,a.jsx)(s.mtext,{children:"pred"}),(0,a.jsx)(s.mi,{children:"k"})]}),(0,a.jsx)(s.mo,{stretchy:"false",children:"("}),(0,a.jsx)(s.mi,{children:"s"}),(0,a.jsx)(s.mo,{stretchy:"false",children:")"}),(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"})]}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mtext,{children:"r"}),(0,a.jsxs)(s.mover,{accent:"true",children:[(0,a.jsx)(s.mtext,{children:"e"}),(0,a.jsx)(s.mo,{children:"\u02ca"})]}),(0,a.jsx)(s.mtext,{children:"el"})]}),(0,a.jsx)(s.mo,{stretchy:"false",children:"("}),(0,a.jsx)(s.mi,{children:"s"}),(0,a.jsx)(s.mo,{stretchy:"false",children:")"}),(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"})]})]})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\text{Recall@20} = \\frac{1}{|S|} \\sum_{s=1}^{|S|} \\frac{| \\text{r\xe9el}(s) \\cap \\text{pred}_k(s) |}{|\\text{r\xe9el}(s)|}"})]})})}),(0,a.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.6944em"}}),(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord",children:"Recall@20"})}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(s.span,{className:"mrel",children:"="}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"3.2281em",verticalAlign:"-1.2671em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,a.jsx)(s.span,{className:"mfrac",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"1.3214em"},children:[(0,a.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord",children:"\u2223"}),(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"S"}),(0,a.jsx)(s.span,{className:"mord",children:"\u2223"})]})]}),(0,a.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,a.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:(0,a.jsx)(s.span,{className:"mord",children:"1"})})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.936em"},children:(0,a.jsx)(s.span,{})})})]})}),(0,a.jsx)(s.span,{className:"mclose nulldelimiter"})]}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsx)(s.span,{className:"mop op-limits",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"1.961em"},children:[(0,a.jsxs)(s.span,{style:{top:"-1.8829em",marginLeft:"0em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3.05em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(s.span,{className:"mord mtight",children:[(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"s"}),(0,a.jsx)(s.span,{className:"mrel mtight",children:"="}),(0,a.jsx)(s.span,{className:"mord mtight",children:"1"})]})})]}),(0,a.jsxs)(s.span,{style:{top:"-3.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3.05em"}}),(0,a.jsx)(s.span,{children:(0,a.jsx)(s.span,{className:"mop op-symbol large-op",children:"\u2211"})})]}),(0,a.jsxs)(s.span,{style:{top:"-4.386em",marginLeft:"0em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3.05em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(s.span,{className:"mord mtight",children:[(0,a.jsx)(s.span,{className:"mord mtight",children:"\u2223"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.05764em"},children:"S"}),(0,a.jsx)(s.span,{className:"mord mtight",children:"\u2223"})]})})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"1.2671em"},children:(0,a.jsx)(s.span,{})})})]})}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,a.jsx)(s.span,{className:"mfrac",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"1.427em"},children:[(0,a.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord",children:"\u2223"}),(0,a.jsxs)(s.span,{className:"mord text",children:[(0,a.jsx)(s.span,{className:"mord",children:"r"}),(0,a.jsx)(s.span,{className:"mord accent",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsxs)(s.span,{className:"vlist",style:{height:"0.6944em"},children:[(0,a.jsxs)(s.span,{style:{top:"-3em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:"e"})]}),(0,a.jsxs)(s.span,{style:{top:"-3em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"accent-body",style:{left:"-0.25em"},children:(0,a.jsx)(s.span,{className:"mord",children:"\u02ca"})})]})]})})})}),(0,a.jsx)(s.span,{className:"mord",children:"el"})]}),(0,a.jsx)(s.span,{className:"mopen",children:"("}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,a.jsx)(s.span,{className:"mclose",children:")"}),(0,a.jsx)(s.span,{className:"mord",children:"\u2223"})]})]}),(0,a.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,a.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord",children:"\u2223"}),(0,a.jsxs)(s.span,{className:"mord text",children:[(0,a.jsx)(s.span,{className:"mord",children:"r"}),(0,a.jsx)(s.span,{className:"mord accent",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsxs)(s.span,{className:"vlist",style:{height:"0.6944em"},children:[(0,a.jsxs)(s.span,{style:{top:"-3em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:"e"})]}),(0,a.jsxs)(s.span,{style:{top:"-3em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"accent-body",style:{left:"-0.25em"},children:(0,a.jsx)(s.span,{className:"mord",children:"\u02ca"})})]})]})})})}),(0,a.jsx)(s.span,{className:"mord",children:"el"})]}),(0,a.jsx)(s.span,{className:"mopen",children:"("}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,a.jsx)(s.span,{className:"mclose",children:")"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(s.span,{className:"mbin",children:"\u2229"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord",children:"pred"})}),(0,a.jsx)(s.span,{className:"msupsub",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.242em"},children:(0,a.jsxs)(s.span,{style:{top:"-2.4559em",marginRight:"0.05em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03148em"},children:"k"})})]})}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.2441em"},children:(0,a.jsx)(s.span,{})})})]})})]}),(0,a.jsx)(s.span,{className:"mopen",children:"("}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,a.jsx)(s.span,{className:"mclose",children:")"}),(0,a.jsx)(s.span,{className:"mord",children:"\u2223"})]})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.936em"},children:(0,a.jsx)(s.span,{})})})]})}),(0,a.jsx)(s.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,a.jsxs)(s.p,{children:["o\xf9 ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mtext,{children:"r"}),(0,a.jsxs)(s.mover,{accent:"true",children:[(0,a.jsx)(s.mtext,{children:"e"}),(0,a.jsx)(s.mo,{children:"\u02ca"})]}),(0,a.jsx)(s.mtext,{children:"el"})]}),(0,a.jsx)(s.mo,{stretchy:"false",children:"("}),(0,a.jsx)(s.mi,{children:"s"}),(0,a.jsx)(s.mo,{stretchy:"false",children:")"}),(0,a.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"|\\text{r\xe9el}(s)|"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,a.jsx)(s.span,{className:"mord",children:"\u2223"}),(0,a.jsxs)(s.span,{className:"mord text",children:[(0,a.jsx)(s.span,{className:"mord",children:"r"}),(0,a.jsx)(s.span,{className:"mord accent",children:(0,a.jsx)(s.span,{className:"vlist-t",children:(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsxs)(s.span,{className:"vlist",style:{height:"0.6944em"},children:[(0,a.jsxs)(s.span,{style:{top:"-3em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"mord",children:"e"})]}),(0,a.jsxs)(s.span,{style:{top:"-3em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"accent-body",style:{left:"-0.25em"},children:(0,a.jsx)(s.span,{className:"mord",children:"\u02ca"})})]})]})})})}),(0,a.jsx)(s.span,{className:"mord",children:"el"})]}),(0,a.jsx)(s.span,{className:"mopen",children:"("}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,a.jsx)(s.span,{className:"mclose",children:")"}),(0,a.jsx)(s.span,{className:"mord",children:"\u2223"})]})})]})," est le nombre d'\xe9l\xe9ments pertinents dans la session ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsx)(s.mrow,{children:(0,a.jsx)(s.mi,{children:"s"})}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"s"})]})})}),(0,a.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.4306em"}}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"s"})]})})]}),"."]}),"\n",(0,a.jsxs)(s.p,{children:["Le ",(0,a.jsx)(s.strong,{children:"score F1"})," est une mesure qui combine la pr\xe9cision et le rappel. Il est particuli\xe8rement utile lorsqu'il est n\xe9cessaire de trouver un \xe9quilibre entre la pr\xe9cision et le rappel. Le score F1 est d\xe9fini comme la moyenne harmonique de la pr\xe9cision et du rappel :"]}),"\n",(0,a.jsx)(s.span,{className:"katex-display",children:(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mtext,{children:"F1\xa0Score"}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsx)(s.mn,{children:"2"}),(0,a.jsx)(s.mo,{children:"\xd7"}),(0,a.jsxs)(s.mfrac,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mtext,{children:"Precision"}),(0,a.jsx)(s.mo,{children:"\xd7"}),(0,a.jsx)(s.mtext,{children:"Recall"})]}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mtext,{children:"Precision"}),(0,a.jsx)(s.mo,{children:"+"}),(0,a.jsx)(s.mtext,{children:"Recall"})]})]})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\text{F1 Score} = 2 \\times \\frac{\\text{Precision} \\times \\text{Recall}}{\\text{Precision} + \\text{Recall}}"})]})})}),(0,a.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord",children:"F1\xa0Score"})}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(s.span,{className:"mrel",children:"="}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,a.jsx)(s.span,{className:"mord",children:"2"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(s.span,{className:"mbin",children:"\xd7"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"2.1408em",verticalAlign:"-0.7693em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,a.jsx)(s.span,{className:"mfrac",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"1.3714em"},children:[(0,a.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord",children:"Precision"})}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(s.span,{className:"mbin",children:"+"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord",children:"Recall"})})]})]}),(0,a.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,a.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord",children:"Precision"})}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(s.span,{className:"mbin",children:"\xd7"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(s.span,{className:"mord text",children:(0,a.jsx)(s.span,{className:"mord",children:"Recall"})})]})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.7693em"},children:(0,a.jsx)(s.span,{})})})]})}),(0,a.jsx)(s.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,a.jsxs)(s.p,{children:["o\xf9 la ",(0,a.jsx)(s.strong,{children:"Precision"})," et le ",(0,a.jsx)(s.strong,{children:"Recall"})," sont les valeurs calcul\xe9es pour une session individuelle, et le score F1 est la moyenne de ces scores sur toutes les sessions."]}),"\n",(0,a.jsx)(s.h3,{id:"fonctions-d\xe9valuation",children:"Fonctions d'\xe9valuation"}),"\n",(0,a.jsxs)(s.p,{children:["Le code pour \xe9valuer les m\xe9triques MRR et F1 proviennent ",(0,a.jsx)(s.a,{href:"https://github.com/coveooss/SIGIR-ecom-data-challenge/blob/main/evaluation/evaluation.py",children:(0,a.jsx)(s.code,{children:"SIGIR-ecom-data-challenge/evaluation/evaluation.py"})})," du d\xe9p\xf4t GitHub de Coveo Challenge. Nous avons conserv\xe9 que le code requis pour l'\xe9valuation de la t\xe2che de recommandation."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'def convert_list_to_top_K(items_list: list, topK: int):\n    """\n    Extract top_K items\n    It is assumed that the list of items are sorted in descending order of importance/weight/relevance\n\n    :param items_list: list where element is a list of items\n    :param topK: top K limit\n    :return: list of items shortened with top K\n    """\n    return [items[:topK] for items in items_list]\n\ndef mrr_at_k(preds: list, labels: list, topK: int):\n    assert len(labels) > 0\n    assert len(preds) == len(labels)\n\n    # get top K predictions\n    converted_preds = convert_list_to_top_K(items_list=preds, topK=topK)\n    rr = []\n    for p, l in zip(converted_preds, labels):\n        if len(l) == 0:\n            rr.append(0.0)\n        else:\n            # get next_item from labels\n            next_item = l[0]\n            # add 0.0 explicitly if not there (for transparency)\n            if next_item not in p:\n                rr.append(0.0)\n            # else, take the reciprocal of prediction rank\n            else:\n                rr.append(1.0 / (p.index(next_item) + 1))\n\n    # return the mean reciprocal rank\n    return sum(rr) / len(labels)\n\ndef f1_at_k(preds: list, labels: list, topK: int):\n    assert len(labels) > 0\n    assert len(preds) == len(labels)\n\n    # get top K predictions\n    converted_preds = convert_list_to_top_K(items_list=preds, topK=topK)\n    all_precision = []\n    all_recall = []\n    all_f1 = []\n\n    # for each recommendation prediction, calculate the f1 based on ground truth\n    for p, l in zip(converted_preds, labels):\n        nb_hits = len(set(p).intersection(set(l)))\n        precision = nb_hits / topK\n        recall = nb_hits / len(set(l)) if len(l) > 0 else 0.0\n        f1 = (2 * precision * recall) / (precision + recall) if (precision + recall) > 0 else 0.0\n        all_precision.append(precision)\n        all_recall.append(recall)\n        all_f1.append(f1)\n\n    # get average f1 across all predictions\n    avg_f1 = sum(all_f1) / len(labels)\n    return avg_f1\n\ndef next_item_metric(preds: list, labels: list, top_K: int = 20):\n    """\n    Compute metric for next item recommendation task.\n\n    :param preds: list where each element is a list of item recommendations\n    :param labels: list where each element is a list of ground truth items viewed\n    :param top_K: as per README, by default we consider metric @ K=20\n    :return: mrr for next item prediction\n    """\n    return mrr_at_k(preds, labels, top_K)\n\ndef subsequent_items_metric(preds: list, labels: list, top_K: int = 20):\n    """\n    Compute metric for the all items recommendation task.\n\n    :param preds:\n    :param labels:\n    :param top_K: as per README, by default we consider metric @ K=20\n    :return: f1 for all items prediction\n    """\n    return f1_at_k(preds, labels, top_K)\n\ndef evaluate_recs(prediction_data, ground_truth_data):\n    """\n    This function computes the leaderboard metrics for the in-session recommendation task\n\n    :param prediction_data\n    :param path_to_ground_truth: path of json file which stores ground truth\n    :return: ground_truth_data\n    """\n\n    # check for \'label\' key in every prediction item and ground truth item\n    assert all("label" in _ for _ in prediction_data)\n    assert all("label" in _ for _ in ground_truth_data)\n\n    # extract prediction and ground truth labels\n    predictions = [_["label"] for _ in prediction_data]\n    ground_truth = [_["label"] for _ in ground_truth_data]\n\n    next_item_mrr = next_item_metric(predictions, ground_truth)\n    subsequent_items_f1 = subsequent_items_metric(predictions, ground_truth)\n\n    return {"mrr_next_item": next_item_mrr, "f1_all_items": subsequent_items_f1}\n'})}),"\n",(0,a.jsxs)(s.p,{children:["Calculer les m\xe9triques MRR@20 (",(0,a.jsx)(s.em,{children:"Mean Reciprocal Rank"}),") et F1@20 seulement sur les s\xe9quences ayant 20 interactions futures r\xe9elles dans ",(0,a.jsx)(s.code,{children:"ground_truth"}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'# \xc9valuer le mod\xe8le.\ndef evaluate_model(model, dataloader, futures, device: str):\n    # Passage du mod\xe8le en mode \xe9valuation\n    model.eval()\n    predictions = []\n\n    # D\xe9sactivation du calcul du gradient pour r\xe9duire l\'utilisation de la m\xe9moire et acc\xe9l\xe9rer le processus\n    with torch.no_grad():\n        for i, batch in enumerate(dataloader):\n            input_ids, attention_mask, non_text_features, _ = [t.to(device) for t in batch]\n\n            # Application du mod\xe8le sur les donn\xe9es du batch\n            outputs = model(input_ids, attention_mask, non_text_features)\n\n            # S\xe9lection des 20 meilleures pr\xe9dictions pour chaque sortie\n            preds = [output.topk(20).indices.tolist() for output in outputs]\n\n            # Ajout des pr\xe9dictions \xe0 la liste globale\n            predictions.extend(preds)\n\n    # Filtrer les donn\xe9es pour ne garder que celles o\xf9 ground_truth a au moins 20 \xe9l\xe9ments\n    filtered_predictions = []\n    filtered_futures = []\n    for pred, future in zip(predictions, futures):\n        if len(future) >= 20:\n            filtered_predictions.append(pred)\n            filtered_futures.append(future)\n\n    # Structuration des donn\xe9es pr\xe9dites et des donn\xe9es de v\xe9rit\xe9 terrain pour l\'\xe9valuation apr\xe8s filtrage\n    prediction_data = [{"label": p} for p in filtered_predictions]\n    ground_truth_data = [{"label": future} for future in filtered_futures]\n\n    # Appel d\'une fonction pour \xe9valuer les recommandations (non d\xe9finie dans ce snippet)\n    return evaluate_recs(prediction_data, ground_truth_data)\n\n'})}),"\n",(0,a.jsx)(s.h2,{id:"\xe9tape-12---entra\xeenement-du-mod\xe8le",children:"\xc9tape 12 - Entra\xeenement du mod\xe8le"}),"\n",(0,a.jsx)(s.p,{children:"Entra\xeener le mod\xe8le sur l'ensemble d'entra\xeenement et \xe9valuer les performances du mod\xe8le sur les ensembles d'entra\xeenement et de validation."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'# Boucle d\'entra\xeenement\ndef train_model(\n    model,\n    dataloaders,\n    data_splits,\n    loss_function,\n    epochs: int,\n    learning_rate: float,\n    l2_reg_lambda: float,\n    device: str,\n):\n    optimizer = torch.optim.AdamW(model.parameters(), lr=learning_rate)\n\n    for epoch in range(epochs):\n        model.train()\n        total_train_loss = 0\n        print(f"Entra\xeenement (\xe9poque {epoch+1}/{epochs})")\n\n        for batch in dataloaders["train"]:\n            input_ids, attention_mask, non_text_features, labels = [t.to(device) for t in batch]\n\n            model.zero_grad()\n            outputs = model(\n                input_ids=input_ids,\n                attention_mask=attention_mask,\n                non_text_features=non_text_features,\n            )\n\n            # Calcul de la perte\n            loss = loss_function(outputs, labels)\n\n            # Ajouter la r\xe9gularisation L2 \xe0 la perte\n            l2_reg = torch.tensor(0.0, requires_grad=True)\n            for param in model.parameters():\n                l2_reg = l2_reg + torch.norm(param)\n\n            loss += l2_reg_lambda * l2_reg\n\n            # Propagation arri\xe8re et optimisation\n            loss.backward()\n            optimizer.step()\n\n            total_train_loss += loss.item()\n\n        avg_train_loss = total_train_loss / len(dataloaders["train"])\n        print(f"Perte moyenne d\'entra\xeenement: {avg_train_loss:.4f}")\n\n        # \xc9valuation sur l\'ensemble de validation\n        model.eval()\n        total_val_loss = 0\n        with torch.no_grad():\n            for batch in dataloaders["val"]:\n                input_ids, attention_mask, non_text_features, labels = [t.to(device) for t in batch]\n\n                outputs = model(\n                    input_ids=input_ids,\n                    attention_mask=attention_mask,\n                    non_text_features=non_text_features,\n                )\n\n                # Calcul de la perte\n                loss = loss_function(outputs, labels)\n                if loss is not None:\n                    total_val_loss += loss.item()\n\n        avg_val_loss = total_val_loss / len(dataloaders["val"])\n        print(f"Perte moyenne de validation: {avg_val_loss:.4f}")\n\n        # \xc9valuation des m\xe9triques sur les ensembles d\'entra\xeenement et de validation.\n        train_metrics = evaluate_model(model, dataloaders["train"], data_splits["train"]["futures"], device)\n        print(f"M\xe9triques d\'entra\xeenement..: {{}}".format({k: f"{v:.4f}" for k, v in train_metrics.items()}))\n        val_metrics = evaluate_model(model, dataloaders["val"], data_splits["val"]["futures"], device)\n        print(f"M\xe9triques de validation...: {{}}".format({k: f"{v:.4f}" for k, v in val_metrics.items()}))\n\n    return model\n'})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:"print(f\"Entra\xeenement du mod\xe8le sur {device}\")\nepochs = params['epochs']\nlearning_rate = params['learning_rate']\nl2_reg_lambda = params['l2_reg_lambda']\nloss_function = nn.CrossEntropyLoss()\nmodel = train_model(\n    model=model,\n    dataloaders=dataloaders,\n    data_splits=data_splits,\n    loss_function=loss_function,\n    epochs=epochs,\n    learning_rate=learning_rate,\n    l2_reg_lambda=l2_reg_lambda,\n    device=device,\n)\n"})}),"\n",(0,a.jsx)(s.h2,{id:"\xe9tape-13---\xe9valuation-sur-lensemble-de-test",children:"\xc9tape 13 - \xc9valuation sur l'ensemble de test"}),"\n",(0,a.jsx)(s.p,{children:"\xc9valuer les performances du mod\xe8le sur l'ensemble de test pour estimer son efficacit\xe9 sur des donn\xe9es non vues."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-python",children:'def evaluate_test(model, dataloaders, data_splits, device) -> None:\n    test_metrics = evaluate_model(model, dataloaders["test"], data_splits["test"]["futures"], device)\n    print(f"M\xe9triques de test.........: {{}}".format({k: f"{v:.4f}" for k, v in test_metrics.items()}))\n\nprint("\xc9valuation du mod\xe8le sur l\'ensemble de test")\nprint(f"Param\xe8tres du model: {params}")\nevaluate_test(model=model, dataloaders=dataloaders, data_splits=data_splits, device=device)\n'})}),"\n",(0,a.jsx)(s.h2,{id:"r\xe9f\xe9rences-et-ressources",children:"R\xe9f\xe9rences et ressources"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:["Coveo. (2021). SIGIR 2021 E-Commerce Workshop Data Challenge. arXiv preprint arXiv:2104.09423. Disponible sur ",(0,a.jsx)(s.a,{href:"https://arxiv.org/abs/2104.09423",children:"https://arxiv.org/abs/2104.09423"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:["Coveo. (2021). SIGIR eCOM 2021 Data Challenge Dataset. R\xe9cup\xe9r\xe9 de ",(0,a.jsx)(s.a,{href:"https://github.com/coveooss/SIGIR-ecom-data-challenge",children:"https://github.com/coveooss/SIGIR-ecom-data-challenge"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:["NVIDIA Merlin. (2021). Winning the SIGIR eCommerce Challenge on session-based recommendation with Transformers. R\xe9cup\xe9r\xe9 de ",(0,a.jsx)(s.a,{href:"https://medium.com/nvidia-merlin/winning-the-sigir-ecommerce-challenge-on-session-based-recommendation-with-transformers-v2-793f6fac2994",children:"https://medium.com/nvidia-merlin/winning-the-sigir-ecommerce-challenge-on-session-based-recommendation-with-transformers-v2-793f6fac2994"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:["NVIDIA Merlin. (2021). NVIDIA Merlin's Paper on SIGIR eCom 2021 Challenge. arXiv preprint arXiv:2107.05124. Disponible sur ",(0,a.jsx)(s.a,{href:"https://arxiv.org/abs/2107.05124",children:"https://arxiv.org/abs/2107.05124"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:["NVIDIA Merlin. (2021). Projet GitHub de NVIDIA Merlin pour le SIGIR eCom 2021 Challenge. R\xe9cup\xe9r\xe9 de ",(0,a.jsx)(s.a,{href:"https://github.com/NVIDIA-Merlin/competitions/tree/main/SIGIR_eCommerce_Challenge_2021",children:"https://github.com/NVIDIA-Merlin/competitions/tree/main/SIGIR_eCommerce_Challenge_2021"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:["Tinkoff. (2021). \u041a\u0430\u043a \u043c\u044b \u0432 SIGIR-\u0441\u043e\u0440\u0435\u0432\u043d\u043e\u0432\u0430\u043d\u0438\u0438 \u0443\u0447\u0430\u0441\u0442\u0432\u043e\u0432\u0430\u043b\u0438. R\xe9cup\xe9r\xe9 de ",(0,a.jsx)(s.a,{href:"https://habr.com/ru/companies/tinkoff/articles/575944/",children:"https://habr.com/ru/companies/tinkoff/articles/575944/"}),"."]}),"\n"]})]})}function o(e={}){const{wrapper:s}={...(0,t.a)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(m,{...e})}):m(e)}},11151:(e,s,n)=>{n.d(s,{Z:()=>i,a:()=>l});var a=n(67294);const t={},r=a.createContext(t);function l(e){const s=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),a.createElement(r.Provider,{value:s},e.children)}}}]);