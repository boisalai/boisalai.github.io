"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5441],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>g});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),u=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},d=function(e){var n=u(e.components);return r.createElement(l.Provider,{value:n},e.children)},p="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),p=u(t),m=a,g=p["".concat(l,".").concat(m)]||p[m]||c[m]||o;return t?r.createElement(g,s(s({ref:n},d),{},{components:t})):r.createElement(g,s({ref:n},d))}));function g(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,s=new Array(o);s[0]=m;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i[p]="string"==typeof e?e:a,s[1]=i;for(var u=2;u<o;u++)s[u]=t[u];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},8375:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>o,metadata:()=>i,toc:()=>u});var r=t(7462),a=(t(7294),t(3905));const o={sidebar_label:"Interroger un fichier PDF avec ChatGPT",sidebar_position:1,tags:["LangChain","ChatGPT"]},s="Interroger un fichier PDF avec ChatGPT",i={unversionedId:"snippets/question-pdf-with-chatgpt",id:"snippets/question-pdf-with-chatgpt",title:"Interroger un fichier PDF avec ChatGPT",description:"2023-08-30",source:"@site/docs/snippets/question-pdf-with-chatgpt.md",sourceDirName:"snippets",slug:"/snippets/question-pdf-with-chatgpt",permalink:"/docs/snippets/question-pdf-with-chatgpt",draft:!1,tags:[{label:"LangChain",permalink:"/docs/tags/lang-chain"},{label:"ChatGPT",permalink:"/docs/tags/chat-gpt"}],version:"current",sidebarPosition:1,frontMatter:{sidebar_label:"Interroger un fichier PDF avec ChatGPT",sidebar_position:1,tags:["LangChain","ChatGPT"]},sidebar:"tutorialSidebar",previous:{title:"Code Snippets",permalink:"/docs/category/code-snippets"},next:{title:"Python code snippets",permalink:"/docs/snippets/python"}},l={},u=[],d={toc:u},p="wrapper";function c(e){let{components:n,...t}=e;return(0,a.kt)(p,(0,r.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"interroger-un-fichier-pdf-avec-chatgpt"},"Interroger un fichier PDF avec ChatGPT"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"2023-08-30")),(0,a.kt)("p",null,"Voici un guide pour interroger un fichier PDF \xe0 l'aide de ChatGPT."),(0,a.kt)("p",null,"Pour commencer, ouvrez un nouveau notebook ",(0,a.kt)("a",{parentName:"p",href:"https://colab.google/"},"Colab")," et suivez ces \xe9tapes :"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://colab.research.google.com/drive/1KvZyC81-lhzNJiBDbRAHZLJ5K9KXZfWn?usp=drive_link"},(0,a.kt)("img",{parentName:"a",src:"https://colab.research.google.com/assets/colab-badge.svg",alt:"Open In Colab"}))),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Installez les biblioth\xe8ques requises en ex\xe9cutant la commande suivante :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"!pip3 install langchain pypdf chromadb openai tiktoken\n")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Entrez votre ",(0,a.kt)("a",{parentName:"li",href:"https://platform.openai.com/account/api-keys"},"cl\xe9 API OpenAI")," comme indiqu\xe9 ci-dessous :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"import os\nimport getpass\n\nos.environ['OPENAI_API_KEY'] = getpass.getpass('OpenAI API Key:')\n")),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"Importez les biblioth\xe8ques n\xe9cessaires :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"from langchain.document_loaders import PyPDFLoader \nfrom langchain.embeddings import OpenAIEmbeddings \nfrom langchain.vectorstores import Chroma \nfrom langchain.chains import ConversationalRetrievalChain\nfrom langchain.memory import ConversationBufferMemory\nfrom langchain.chat_models import ChatOpenAI\n")),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},"T\xe9l\xe9chargez le document PDF que vous souhaitez interroger. Dans cet exemple, nous utiliserons un document de 472 pages, le Plan budg\xe9taire du Budget 2023-2024 : ")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"!curl -o paper.pdf http://www.finances.gouv.qc.ca/Budget_et_mise_a_jour/budget/documents/Budget2324_PlanBudgetaire.pdf\n")),(0,a.kt)("ol",{start:5},(0,a.kt)("li",{parentName:"ol"},"Sp\xe9cifiez le chemin du fichier PDF et chargez les pages du document :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'pdf_path = "./paper.pdf"\nloader = PyPDFLoader(pdf_path)\npages = loader.load_and_split()\n')),(0,a.kt)("ol",{start:6},(0,a.kt)("li",{parentName:"ol"},"Cr\xe9ez des embeddings \xe0 l'aide de OpenAIEmbeddings :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"embeddings = OpenAIEmbeddings()\n")),(0,a.kt)("ol",{start:7},(0,a.kt)("li",{parentName:"ol"},"G\xe9n\xe9rez une base de vecteurs \xe0 partir des pages du document \xe0 l'aide de Chroma :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'vectordb = Chroma.from_documents(pages, embedding=embeddings, persist_directory=".")\nvectordb.persist()\n')),(0,a.kt)("ol",{start:8},(0,a.kt)("li",{parentName:"ol"},"Mettez en place une m\xe9moire conversationnelle avec ConversationBufferMemory :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'memory = ConversationBufferMemory(memory_key="chat_history", return_messages=True)\n')),(0,a.kt)("ol",{start:9},(0,a.kt)("li",{parentName:"ol"},"Cr\xe9ez une cha\xeene de r\xe9cup\xe9ration conversationnelle avec ConversationalRetrievalChain :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'llm = ChatOpenAI(model_name="gpt-4", temperature=0.8) \npdf_qa = ConversationalRetrievalChain.from_llm(llm, vectordb.as_retriever(), memory=memory)\n')),(0,a.kt)("ol",{start:10},(0,a.kt)("li",{parentName:"ol"},"D\xe9finissez une fonction pour interroger le document PDF :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'def query(query: str):\n    memory.clear()\n    result = pdf_qa({"question": query})\n    print(result["answer"])\n')),(0,a.kt)("ol",{start:11},(0,a.kt)("li",{parentName:"ol"},"Posez des questions sp\xe9cifiques et obtenez des r\xe9ponses du document :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'query("Quels sont les faits saillants du plan budg\xe9taire du gouvernement du Qu\xe9bec?")\nquery("Quelle est l\'\xe9volution de la situation financi\xe8re du gouvernement du Qu\xe9bec?")\nquery("Comment \xe9volue la dette nette?")\n')),(0,a.kt)("p",null,"Le code ci-dessus g\xe9n\xe9rera des r\xe9ponses comme celles-ci.\nNotez que les ",(0,a.kt)("a",{parentName:"p",href:"https://fr.wikipedia.org/wiki/Grand_mod%C3%A8le_de_langage"},"grands mod\xe8les de langage"),"\nne produisent pas toujours les m\xeames r\xe9sultats.\nLors de l'ex\xe9cution du code dans votre notebook, vous pouvez obtenir des r\xe9ponses l\xe9g\xe8rement diff\xe9rentes."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-txt"},"Le plan budg\xe9taire du Qu\xe9bec pour 2023-2024 comporte plusieurs points saillants. \nTout d'abord, le gouvernement pr\xe9voit un retour \xe0 l'\xe9quilibre budg\xe9taire en \n2027-2028. Depuis mars 2022, la situation budg\xe9taire du Qu\xe9bec s'est am\xe9lior\xe9e \ngr\xe2ce \xe0 une forte croissance \xe9conomique, malgr\xe9 l'inflation et l'augmentation \nrapide des taux d'int\xe9r\xeat. \n\nLe cadre financier pr\xe9sente des r\xe9visions favorables de 5,5 milliards de dollars\nen 2022-2023, de 6,5 milliards de dollars en 2023-2024, et de 7,7 milliards de \ndollars en 2024-2025. Ces r\xe9visions sont principalement attribuables \xe0 une \nhausse des revenus du gouvernement, en particulier des revenus fiscaux. \n\nToutefois, ces augmentations sont en partie compens\xe9es par une augmentation des\nd\xe9penses de 1,8 milliard de dollars en 2022-2023, de 2,5 milliards de dollars en\n2023-2024, et de 2,4 milliards de dollars en 2024-2025. \n\nCes am\xe9liorations permettent de nouvelles initiatives de 6,6 milliards de \ndollars en 2022-2023 et en 2023-2024, puis de 7,4 milliards de dollars en \n2024-2025. Ces sommes seront utilis\xe9es pour accro\xeetre la richesse du Qu\xe9bec, \nd\xe9velopper le potentiel des jeunes et rendre le r\xe9seau de la sant\xe9 plus \nperformant et plus humain. \n\nEnfin, le gouvernement pr\xe9voit d'\xe9liminer graduellement le d\xe9ficit budg\xe9taire de\n5,0 milliards de dollars pr\xe9vu en 2022-2023 \xe0 raison de 1 milliard de dollars \npar ann\xe9e. \xc0 partir de 2025-2026, le solde budg\xe9taire devrait afficher des \nsurplus.\n\nL'\xe9volution r\xe9cente de la situation financi\xe8re du gouvernement du Qu\xe9bec est \nmarqu\xe9e par des r\xe9visions favorables des revenus. Ces r\xe9visions rendent possible\nle retour \xe0 l'\xe9quilibre budg\xe9taire en 2027-2028, tout en soutenant la croissance\n\xe9conomique et la cr\xe9ation de richesse. Cependant, un ralentissement de \nl'activit\xe9 \xe9conomique au Qu\xe9bec est attendu en 2023. \n\nDes am\xe9liorations de 6,6 milliards de dollars en moyenne de 2022-2023 \xe0 \n2024-2025 ont \xe9t\xe9 pr\xe9sent\xe9esdans le budget 2022-2023. Pour cette p\xe9riode, le \ngouvernement pr\xe9voit de nouvelles initiatives de 6,6 milliards de dollars en \n2022-2023 et en 2023-2024, puis de 7,4 milliards de dollars en 2024-2025. Ces \nfonds seront utilis\xe9s pour accro\xeetre la richesse du Qu\xe9bec, d\xe9velopper le \npotentiel des jeunes et rendre le r\xe9seau de la sant\xe9 plus performant et plus \nhumain. Ces montants incluent le d\xe9ploiement du Bouclier anti-inflation annonc\xe9 \n\xe0 l'automne 2022.\n\nLes versements au Fonds des g\xe9n\xe9rations conna\xeetront une croissance plus mod\xe9r\xe9e, \nprincipalement en raison des modifications pr\xe9vues concernant les sources de \nrevenus consacr\xe9s \xe0 ce fonds \xe0 partir de 2023-2024.\n\nLa dette nette du Qu\xe9bec \xe9volue de mani\xe8re d\xe9croissante. Au 31 mars 2023, la \ndette nette du Qu\xe9bec s'\xe9tablira \xe0 206,8 milliards de dollars, soit \xe0 37,4 % du \nPIB. Une diminution \xe0 35,8 % du PIB est pr\xe9vue d'ici 2027-2028. Le retour \xe0 \nl'\xe9quilibre budg\xe9taire, les versements au Fonds des g\xe9n\xe9rations et la \nprogression de l'\xe9conomie contribuent \xe0 cette r\xe9duction de la dette nette.\n")))}c.isMDXComponent=!0}}]);