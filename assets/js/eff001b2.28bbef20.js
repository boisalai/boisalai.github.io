"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[441],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>g});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var i=r.createContext({}),p=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(i.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=p(n),m=a,g=d["".concat(i,".").concat(m)]||d[m]||c[m]||o;return n?r.createElement(g,l(l({ref:t},u),{},{components:n})):r.createElement(g,l({ref:t},u))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=m;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s[d]="string"==typeof e?e:a,l[1]=s;for(var p=2;p<o;p++)l[p]=n[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8375:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var r=n(7462),a=(n(7294),n(3905));const o={sidebar_label:"Interroger un fichier PDF avec ChatGPT",sidebar_position:1,tags:["LangChain","ChatGPT"]},l="Interroger un fichier PDF avec ChatGPT",s={unversionedId:"snippets/question-pdf-with-chatgpt",id:"snippets/question-pdf-with-chatgpt",title:"Interroger un fichier PDF avec ChatGPT",description:"2023-08-30",source:"@site/docs/snippets/question-pdf-with-chatgpt.md",sourceDirName:"snippets",slug:"/snippets/question-pdf-with-chatgpt",permalink:"/docs/snippets/question-pdf-with-chatgpt",draft:!1,tags:[{label:"LangChain",permalink:"/docs/tags/lang-chain"},{label:"ChatGPT",permalink:"/docs/tags/chat-gpt"}],version:"current",sidebarPosition:1,frontMatter:{sidebar_label:"Interroger un fichier PDF avec ChatGPT",sidebar_position:1,tags:["LangChain","ChatGPT"]},sidebar:"tutorialSidebar",previous:{title:"Code Snippets",permalink:"/docs/category/code-snippets"},next:{title:"References",permalink:"/docs/category/references"}},i={},p=[],u={toc:p},d="wrapper";function c(e){let{components:t,...n}=e;return(0,a.kt)(d,(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"interroger-un-fichier-pdf-avec-chatgpt"},"Interroger un fichier PDF avec ChatGPT"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"2023-08-30")),(0,a.kt)("p",null,"Voici un guide pour interroger un fichier PDF \xe0 l'aide de ChatGPT."),(0,a.kt)("p",null,"Pour commencer, ouvrez un nouveau notebook ",(0,a.kt)("a",{parentName:"p",href:"https://colab.google/"},"Colab")," et suivez ces \xe9tapes :"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Installez les biblioth\xe8ques requises en ex\xe9cutant la commande suivante :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"!pip3 install langchain pypdf chromadb openai tiktoken\n")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Entrez votre ",(0,a.kt)("a",{parentName:"li",href:"https://platform.openai.com/account/api-keys"},"cl\xe9 API OpenAI")," comme indiqu\xe9 ci-dessous :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"import os\nimport getpass\n\nos.environ['OPENAI_API_KEY'] = getpass.getpass('OpenAI API Key:')\n")),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"Importez les biblioth\xe8ques n\xe9cessaires :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"from langchain.document_loaders import PyPDFLoader \nfrom langchain.embeddings import OpenAIEmbeddings \nfrom langchain.vectorstores import Chroma \nfrom langchain.chains import ConversationalRetrievalChain\nfrom langchain.memory import ConversationBufferMemory\nfrom langchain.llms import OpenAI\n")),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},"T\xe9l\xe9chargez le document PDF que vous souhaitez interroger. Dans cet exemple, nous utiliserons un document de 472 pages, le Plan budg\xe9taire du Budget 2023-2024 : ")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"!curl -o paper.pdf http://www.finances.gouv.qc.ca/Budget_et_mise_a_jour/budget/documents/Budget2324_PlanBudgetaire.pdf\n")),(0,a.kt)("ol",{start:5},(0,a.kt)("li",{parentName:"ol"},"Sp\xe9cifiez le chemin du fichier PDF et chargez les pages du document :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'pdf_path = "./paper.pdf"\nloader = PyPDFLoader(pdf_path)\npages = loader.load_and_split()\n')),(0,a.kt)("ol",{start:6},(0,a.kt)("li",{parentName:"ol"},"Cr\xe9ez des embeddings \xe0 l'aide de OpenAIEmbeddings :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"embeddings = OpenAIEmbeddings()\n")),(0,a.kt)("ol",{start:7},(0,a.kt)("li",{parentName:"ol"},"G\xe9n\xe9rez une base de vecteurs \xe0 partir des pages du document \xe0 l'aide de Chroma :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'vectordb = Chroma.from_documents(pages, embedding=embeddings, persist_directory=".")\nvectordb.persist()\n')),(0,a.kt)("ol",{start:8},(0,a.kt)("li",{parentName:"ol"},"Mettez en place une m\xe9moire conversationnelle avec ConversationBufferMemory :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'memory = ConversationBufferMemory(memory_key="chat_history", return_messages=True)\n')),(0,a.kt)("ol",{start:9},(0,a.kt)("li",{parentName:"ol"},"Cr\xe9ez une cha\xeene de r\xe9cup\xe9ration conversationnelle avec ConversationalRetrievalChain :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"pdf_qa = ConversationalRetrievalChain.from_llm(OpenAI(temperature=0.8) , vectordb.as_retriever(), memory=memory)\n")),(0,a.kt)("ol",{start:10},(0,a.kt)("li",{parentName:"ol"},"D\xe9finissez une fonction pour interroger le document PDF :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'def query(query: str):\n    result = pdf_qa({"question": query})\n    print(result["answer"])\n    memory.clear()\n')),(0,a.kt)("ol",{start:11},(0,a.kt)("li",{parentName:"ol"},"Posez des questions sp\xe9cifiques et obtenez des r\xe9ponses du document :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'query("Quels sont les faits saillants du plan budg\xe9taire du gouvernement du Qu\xe9bec?")\nquery("Quelle est l\'\xe9volution de la situation financi\xe8re du gouvernement du Qu\xe9bec?")\nquery("Comment \xe9volue la dette nette?")\n')),(0,a.kt)("p",null,"Le code ci-dessus g\xe9n\xe9rera des r\xe9ponses comme celles-ci.\nNotez que les ",(0,a.kt)("a",{parentName:"p",href:"https://fr.wikipedia.org/wiki/Grand_mod%C3%A8le_de_langage"},"grands mod\xe8les de langage"),"\nne produisent pas toujours les m\xeames r\xe9sultats.\nLors de l'ex\xe9cution du code dans votre notebook, vous pouvez obtenir des r\xe9ponses l\xe9g\xe8rement diff\xe9rentes."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-txt"},"Le plan budg\xe9taire du gouvernement du Qu\xe9bec pr\xe9voit pr\xe8s de 3,6 milliards de dollars sur six ans pour soutenir les \nQu\xe9b\xe9cois. Cela comprend 649 millions de dollars pour promouvoir et valoriser la culture qu\xe9b\xe9coise, 1 milliard de \ndollars pour favoriser l'abordabilit\xe9 du logement, 440 millions de dollars pour appuyer les familles, 722 millions de \ndollars pour renforcer l'accessibilit\xe9 et l'efficacit\xe9 des r\xe9seaux de transport, 533 millions de dollars pour am\xe9liorer\nl'inclusion et l'\xe9galit\xe9, 121 millions de dollars pour soutenir les Premi\xe8res Nations et aux Inuit et 88 millions de \ndollars pour moderniser les pratiques en architecture et en am\xe9nagement du territoire.\n\nLe gouvernement du Qu\xe9bec pr\xe9voit un retour \xe0 l\u2019\xe9quilibre budg\xe9taire en 2027-2028, accompagn\xe9 d'am\xe9liorations de \n6,6 milliards de dollars en moyenne de 2022-2023 \xe0 2024-2025 et de nouvelles initiatives de 6,6 milliards de dollars \nen 2022-2023 et en 2023-2024 , puis de 7,4 milliards de dollars en 2024-2025, principalement pour accro\xeetre la richesse\ndu Qu\xe9bec, pour d\xe9velopper le potentiel des jeunes et pour rendre le r\xe9seau de la sant\xe9 plus performant et plus humain. \nLes versements des revenus consacr\xe9s au Fonds des g\xe9n\xe9rations auront une croissance plus mod\xe9r\xe9e \xe0 partir de 2023-2024.\n\nLa dette nette \xe9volue en diminuant, passant de 206,8 milliards de dollars et 37,4 % du PIB au 31 mars 2023 \xe0 35,8 % du \nPIB pr\xe9vu d\u2019ici 2027-2028. Le retour \xe0 l\u2019\xe9quilibre budg\xe9taire, les versements au Fonds des g\xe9n\xe9rations et la progression\nde l\u2019\xe9conomie contribueront \xe0 la r\xe9duction de la dette nette.\n")))}c.isMDXComponent=!0}}]);