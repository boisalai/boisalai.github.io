"use strict";(self.webpackChunkmy_doc=self.webpackChunkmy_doc||[]).push([[8293],{8122:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>m});var t=l(85893),a=l(11151);const r={},i="MLX: Array framework for Apple silicon",s={id:"references/ml/mlx/mlx",title:"MLX: Array framework for Apple silicon",description:"- MLX repo",source:"@site/docs/references/ml/mlx/mlx.md",sourceDirName:"references/ml/mlx",slug:"/references/ml/mlx/",permalink:"/docs/references/ml/mlx/",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/references/ml/mlx/mlx.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Hugging Face",permalink:"/docs/references/ml/hugging-face"},next:{title:"Large Language Models (LLMs)",permalink:"/docs/references/llms/"}},o={},m=[{value:"Installation",id:"installation",level:2},{value:"Examples",id:"examples",level:2},{value:"LLMs",id:"llms",level:2},{value:"Phixtral",id:"phixtral",level:2},{value:"MLX Data",id:"mlx-data",level:2},{value:"See also",id:"see-also",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"mlx-array-framework-for-apple-silicon",children:"MLX: Array framework for Apple silicon"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/ml-explore/mlx",children:"MLX repo"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://ml-explore.github.io/mlx/build/html/index.html",children:"Documentation"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"python3 -m venv .env\nsource .env/bin/activate  # Linux or macOS\n# .env\\Scripts\\activate  # Windows\npython3 -m pip install --upgrade pip\npip install mlx\n"})}),"\n",(0,t.jsxs)(n.p,{children:['In Visual Studio Code, open the project, select "Command Palette" from the "View" menu\n(',(0,t.jsx)(n.code,{children:"Cmd+Shift+P"})," on Mac or ",(0,t.jsx)(n.code,{children:"Ctrl+Shift+P"}),' on Windows),\nrun the "Python: Select Interpreter" command, and\nselect the Python interpreter in the virtual directory (',(0,t.jsx)(n.code,{children:".env/bin/python3.9"}),")."]}),"\n",(0,t.jsxs)(n.p,{children:["Create a ",(0,t.jsx)(n.code,{children:"main.py"})," file and this code."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:">> import mlx.core as mx\n>> a = mx.array([1, 2, 3, 4])\n>> print(a.shape)\n[4]\n"})}),"\n",(0,t.jsx)(n.p,{children:"You should see this in your terminal in Visual Studio Code."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"s01",src:l(76367).Z+"",width:"1220",height:"698"})}),"\n",(0,t.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"print(mx.default_device())\n# Device(gpu, 0)\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'import time\nimport mlx.core as mx\n\nstart_time = time.time()\n\ndef fun(a, b, d1, d2):\n  x = mx.matmul(a, b, stream=d1)\n  for _ in range(500):\n      b = mx.exp(b, stream=d2)\n  return x, b\n\na = mx.random.uniform(shape=(4096, 512))\nb = mx.random.uniform(shape=(512, 4))\nd1 = mx.gpu\nd2 = mx.cpu\nx, b = fun(a, b, d1, d2)\n\nend_time = time.time()\nelapsed_time = (end_time - start_time) * 1000\nprint(f"Elapsed time: {elapsed_time} ms")\n'})}),"\n",(0,t.jsx)(n.h2,{id:"llms",children:"LLMs"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'pip install -U mlx\ngit clone https://github.com/ml-explore/mlx-examples.git\ncd mlx-examples/llms/hf_llm\npython generate.py --model mistralai/Mistral-7B-Instruct-v0.2 --prompt "What the dog doin?"\npython generate.py --model mlx-community/Mistral-7B-Instruct-v0.1-4bit-mlx --prompt "My name is"\npython generate.py --model mlx-community/Mistral-7B-Instruct-v0.2-4bit-mlx --prompt "Write a rap song about on-device inference via a mac, keep it classy."\n'})}),"\n",(0,t.jsx)(n.p,{children:"You can also quantise the models and directly upload them to the Hub"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'# See https://huggingface.co/mlx-community/CodeLlama-7b-Python-hf-4bit-mlx\npython convert.py --hf-path "codellama/CodeLlama-7b-Python-hf" -q --upload-name CodeLlama-7b-Python-hf-4bit-mlx\n'})}),"\n",(0,t.jsx)(n.h2,{id:"phixtral",children:"Phixtral"}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"https://github.com/ml-explore/mlx-examples/tree/main/llms/phixtral",children:"llms/phixtral"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"mlx-data",children:"MLX Data"}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"https://ml-explore.github.io/mlx-data/build/html/index.html",children:"mlx-data"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"see-also",children:"See also"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://towardsdatascience.com/mlx-vs-mps-vs-cuda-a-benchmark-c5737ca6efc9",children:"MLX vs MPS vs CUDA: a Benchmark"})}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},76367:(e,n,l)=>{l.d(n,{Z:()=>t});const t=l.p+"assets/images/s01-7fdb8b185aa13f289c97f234e36ebe85.png"},11151:(e,n,l)=>{l.d(n,{Z:()=>s,a:()=>i});var t=l(67294);const a={},r=t.createContext(a);function i(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);