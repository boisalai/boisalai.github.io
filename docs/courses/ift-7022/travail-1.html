<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-courses/ift-7022/travail-1" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">Travail pratique 1 | Alain Boisvert</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://boisalai.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://boisalai.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://boisalai.github.io/docs/courses/ift-7022/travail-1"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Travail pratique 1 | Alain Boisvert"><meta data-rh="true" name="description" content="Tâche 1 - Extraire des informations d&#x27;un document à l&#x27;aide d&#x27;expressions régulières"><meta data-rh="true" property="og:description" content="Tâche 1 - Extraire des informations d&#x27;un document à l&#x27;aide d&#x27;expressions régulières"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://boisalai.github.io/docs/courses/ift-7022/travail-1"><link data-rh="true" rel="alternate" href="https://boisalai.github.io/docs/courses/ift-7022/travail-1" hreflang="en"><link data-rh="true" rel="alternate" href="https://boisalai.github.io/docs/courses/ift-7022/travail-1" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Alain Boisvert RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Alain Boisvert Atom Feed">



<link rel="stylesheet" href="/fonts/font-awesome/fontawesome.css">
<link rel="stylesheet" href="/fonts/font-awesome/solid.css">
<link rel="stylesheet" href="/fonts/font-awesome/regular.css">
<link rel="stylesheet" href="/fonts/font-awesome/brands.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.2dcfce69.css">
<script src="/assets/js/runtime~main.7e1e92b9.js" defer="defer"></script>
<script src="/assets/js/main.e46baa82.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Alain Boisvert</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" target="" href="/docs/courses/ift-7022">IFT-7022</a><a class="navbar__item navbar__link" target="" href="/docs/courses/gif-7005">GIF-7005</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/boisalai" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link fa-brands fa-github"> </a><a href="https://www.linkedin.com/in/alain-boisvert-98b058156/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link fa-brands fa-linkedin-in"> </a><a href="mailto:ay.boisvert@gmail.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link fa-solid fa-envelope"> </a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Alain Boisvert</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cv">Curriculum vitæ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/learning">Learning path</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/certificates">Certificates</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/courses">Courses</a><button aria-label="Collapse sidebar category &#x27;Courses&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/courses/gif-7005">GIF-7005 Introduction à l&#x27;apprentissage automatique</a><button aria-label="Expand sidebar category &#x27;GIF-7005 Introduction à l&#x27;apprentissage automatique&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/courses/ift-7022">IFT-7022 Traitement automatique de la langue naturelle</a><button aria-label="Collapse sidebar category &#x27;IFT-7022 Traitement automatique de la langue naturelle&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/ift-7022/week-01">1 Expressions régulières</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/ift-7022/week-02">2 Prétraitement de textes et distance minimale d&#x27;édition</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/ift-7022/week-03">3 Modèles de langue N-grammes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/ift-7022/week-04">4 Classification de textes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/ift-7022/week-05">5 Sémantique vectorielle (représentation des mots)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/ift-7022/week-06">6 Deep NLP + Plongements de mots (word embeddings) + intro aux réseaux de neurones</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/ift-7022/week-07">7 Étiquetage de séquences - analyse grammaticale (Part of speech tagging) et reconnaissance d&#x27;entités nommées</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/ift-7022/week-08-partie-1">8 Deep NLP - Réseaux récurrents pour le traitement de séquences (RNN, GRU, LSTM)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/ift-7022/week-08-partie-2">8 Notions de base pour les RNN, GRU et LSTM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/ift-7022/week-09">9 Deep NLP - Introduction aux modèles Transformers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/ift-7022/week-10">10 Deep NLP - Plongements contextuels et modèles encodeurs pré-entraînés</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/ift-7022/week-11">11 Deep NLP - Traduction automatique et modèle encodeur-décodeur</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/ift-7022/week-12">12 Deep NLP - Systèmes question-réponse (QA)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/ift-7022/week-13">13 Deep NLP - Introduction aux LLMs, prompting et instruct tuning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/courses/ift-7022/travail-1">Travail pratique 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/ift-7022/travail-2">Travail pratique 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/ift-7022/travail-3">Travail pratique 3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/ift-7022/exam-intra">Examen de mi-session</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/ift-7022/exam-final">Examen final</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/chatgpt-building-systems">Building Systems with the ChatGPT API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/chatgpt-prompt-engineering">ChatGPT Prompt Engineering for Developers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/fine-tuning-llms">Training and fine-tuning LLMs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/langchain-1">LangChain for LLM Application Development</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/pair-prog-with-llm">Pair Programming with a Large Language Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/chat-with-your-data">LangChain Chat with Your Data</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/references">References</a><button aria-label="Expand sidebar category &#x27;References&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/code-snippets">Code Snippets</a><button aria-label="Expand sidebar category &#x27;Code Snippets&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/courses"><span itemprop="name">Courses</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/courses/ift-7022"><span itemprop="name">IFT-7022 Traitement automatique de la langue naturelle</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Travail pratique 1</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Travail pratique 1</h1>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import sys</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(f&quot;Python version {sys.version}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(f&quot;pandas {pd.__version__}&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Python version 3.9.6 (default, May  7 2023, 23:32:44)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Clang 14.0.3 (clang-1403.0.22.14.1)]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pandas 2.1.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tâche-1---extraire-des-informations-dun-document-à-laide-dexpressions-régulières">Tâche 1 - Extraire des informations d&#x27;un document à l&#x27;aide d&#x27;expressions régulières<a href="#tâche-1---extraire-des-informations-dun-document-à-laide-dexpressions-régulières" class="hash-link" aria-label="Direct link to Tâche 1 - Extraire des informations d&#x27;un document à l&#x27;aide d&#x27;expressions régulières" title="Direct link to Tâche 1 - Extraire des informations d&#x27;un document à l&#x27;aide d&#x27;expressions régulières">​</a></h2>
<p>Pour cette tâche, on vous demande de construire un programme qui permet d’extraire le mieux possible les informations de l&#x27;offre de cours du Département d’informatique et génie logiciel.</p>
<p>L&#x27;exemple utilisé provient à l&#x27;origine d&#x27;un fichier PDF pour la session d&#x27;automne 2023 disponible avec ce <a href="https://www.ift.ulaval.ca/fileadmin/ift/documents/PDF/AUTOMNE_2023.pdf" target="_blank" rel="noopener noreferrer">lien</a>.</p>
<p>Vous travaillerez avec une version texte de ce fichier obtenue avec la librairie Textract.</p>
<p>La fonction principale à programmer pour cette tâche est <em>extract_course_informations</em> qui produit en sortie la structure suivante:</p>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {&quot;Sigle&quot;: &quot;GIF-1001&quot;, &quot;Section&quot;: &quot;H&quot;, &quot;Titre&quot;: &quot;Ordinateurs: structures et applications&quot;, &quot;Credit&quot;: &quot;3&quot;},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {&quot;Sigle&quot;: &quot;GIF-1003&quot;, &quot;Section&quot;: &quot;A&quot;, &quot;Titre&quot;: &quot;Programmation avancée en C++ pour ingénieurs&quot;, &quot;Credit&quot;: &quot;3&quot;},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  {&quot;Sigle&quot;: &quot;IFT-7201&quot;, &quot;Section&quot;: &quot;Z3&quot;, &quot;Titre&quot;: &quot;Apprentissage par renforcement&quot;, &quot;Credit&quot;: &quot;3&quot;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ce qui correspond à une liste de cours offert où chacun est décrit par un dictionnaire Python contenant le sigle du cours, le type de section, son titre et son nombre de crédits.</p>
<p>On vous demande de documenter votre notebook pour nous permettre de comprendre votre démarche, c.-à-d. expliquer comment vous procédez pour extraire et/ou retirer et/ou assembler les informations. Vous pouvez ajouter des cellules au notebook lorsque vous le jugez nécessaire.</p>
<p>Vous devez utiliser des expressions régulières pour extraire les informations de cours et détecter les textes non pertinents (si vous utilisez cette approche). Le reste des opérations (par ex. l&#x27;assemblage des infos) est effectué avec du code Python.</p>
<p>Vous pouvez ajouter autant de fonctions utilitaires que vous voulez pour cette tâche. Cependant on demande DE NE PAS MODIFIER la signature des 2 fonctions suivantes:</p>
<ul>
<li><em>extract_course_informations(text_list)</em> , retourne une liste de cours en sortie.</li>
<li><em>read_course_information(text_filename)</em> , retourne une liste de textes (des strings).</li>
</ul>
<p>Des modifications à ces fonctions pourraient nuire à notre correction et des pénalités seront appliquées le cas échéant.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="section-1---lecture-du-fichier-doffre-de-cours">Section 1 - Lecture du fichier d&#x27;offre de cours<a href="#section-1---lecture-du-fichier-doffre-de-cours" class="hash-link" aria-label="Direct link to Section 1 - Lecture du fichier d&#x27;offre de cours" title="Direct link to Section 1 - Lecture du fichier d&#x27;offre de cours">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">def read_course_information(text_filename):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot;Retourne une liste de lignes de textes (des strings).&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    with open(text_filename, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as f:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        text_lines = f.readlines()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return text_lines</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">course_fn = &quot;./data/cours_A2023.txt&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">course_info = read_course_information(course_fn)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">course_info</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    [&#x27;Cours de 1er cycle \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;AUTOMNE 2023 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Cours  Sect.  Titre \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;GIF-1001 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;GIF-1003 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;GLO-1111 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;GLO-2000 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;GLO-2004 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;GLO-2100 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;GLO-3100 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;GLO-3101 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;GLO-3102 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;GLO-4001 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;GLO-4002 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;GLO-4003 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;GLO-4008 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;GLO-4035 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-1000 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-1003 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-1004 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-1004 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-1006 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-1111 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-1701 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-2001 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-2002 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-2003 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-2004 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-2007 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-2008 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-2103 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-3001 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-3101 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-3201 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-4001 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-4022 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-4030 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-4201 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;MAT-1919 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;MAT-1919 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Ordinateurs : structures et applications\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Programmation avancée en C++ pour ingénieurs\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Pratique du génie logiciel\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Réseaux pour ingénieurs\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Génie logiciel orienté objet\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Algorithmes et structures de données pour ingénieurs\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Cryptographie et sécurité informatique\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Gestion de projets informatiques : méthodes et outils\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &quot;Développement d&#x27;applications Web\n&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Introduction à la robotique mobile\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Qualité et métriques du logiciel\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Architecture logicielle\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Applications infonuagiques natives et DevOps\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Bases de données avancées\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Logique et techniques de preuve\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Analyse et conception de systèmes d’information\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Introduction à la programmation\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Introduction à la programmation\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Programmation avancée en C++\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Pratique de l’informatique\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Introduction à l’algorithmique et à la programmation\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Systèmes d’exploitation\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Informatique théorique\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Intelligence artificielle 1\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Modèles et langages des bases de données\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Analyse et conception des systèmes orientés objet\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Algorithmes et structures de données\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Programmation de jeux vidéo\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Conception et analyse d’algorithmes\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Compilation et interprétation\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Cyberattaques et tests d’intrusions dans les systèmes d’information \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Optimisation combinatoire\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Traitement automatique de la langue naturelle\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Apprentissage automatique pour le traitement du signal   Nouveau cours \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Apprentissage par renforcement \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Mathématiques pour informaticien\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Mathématiques pour informaticien\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;H \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;ZA \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;ZA \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;ZA \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z1 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Cours de 2e et 3e cycles \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;GLO-7008 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;GLO-7021 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;GLO-7035 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-6002 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-6003 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-6005 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-7009 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-7020 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-7022 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-7030 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;A \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;IFT-7201 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Z3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Applications infonuagiques natives et DevOps (jumelé avec GLO-4008)\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Introduction à la robotique mobile (jumelé avec GLO-4001) \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Bases de données avancées (jumelé avec GLO-4035)\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Assurance qualité du logiciel (jumelé avec GLO-4002)\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Architecture logicielle (jumelé avec GLO-4003)\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Projet intégrateur \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Réseaux mobiles \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Optimisation combinatoire (jumelé avec IFT-4001)\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Traitement automatique de la langue naturelle (jumelé avec IFT-4022)\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Apprentissage automatique pour le traitement du signal Nouveau cours \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;(jumelé avec IFT-4030)\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Apprentissage par renforcement (jumelé avec IFT-4201)\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;# cr.\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;0\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;0\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3 \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;6\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;3\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;\x0cSignification des types de sections  \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;- A : section en classe;  \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;- Z1 : section à distance asynchrone;  \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;- Z3 : section à distance synchrone;  \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;- ZA : section en formule comodale; correspond à section Z3 avec possibilité d’assister à \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;l’enregistrement du cours dans une classe; \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;- H : hybride, certaines séances en présentiel, d’autres à distance. \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27; \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;Note : en jaune; nouveaux cours offerts à la session d’automne 2023. \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27; \n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;\n&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &#x27;\x0c&#x27;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="section-2---extraction-des-informations-de-cours-à-partir-du-fichier">Section 2 - Extraction des informations de cours à partir du fichier<a href="#section-2---extraction-des-informations-de-cours-à-partir-du-fichier" class="hash-link" aria-label="Direct link to Section 2 - Extraction des informations de cours à partir du fichier" title="Direct link to Section 2 - Extraction des informations de cours à partir du fichier">​</a></h3>
<p>On vous demande de mettre toutes les expressions régulières que vous utilisez dans la première cellule.</p>
<p>Par la suite, vous pouvez ajouter toutes les fonctions utilitaires dont vous avez besoin. Et vous terminez en finalisant la fonction principale <em>extract_course_informations</em>. Vous pouvez ajouter des cellules dans le notebook.</p>
<p>Expliquer comment vous procédez pour extraire les informations et construire la liste de cours. Une part importante de point est allouée aux explications.</p>
<p>Ci-dessous, les patrons &quot;regex&quot; que j&#x27;utilise pour identifier :</p>
<ul>
<li>la chaîne &quot;Nouveau cours&quot; qui peut être supprimée;</li>
<li>la chaîne &quot;(jumelé avec [sigle])&quot; qui peut être supprimée;</li>
<li>les autres chaînes qui peuvent être supprimées, comme les espaces en fin de ligne, les chaînes qui débutent par &quot;Cours&quot; ou par au moins 5 lettres majuscules représentant de toute évidence la session universitaire (ex. AUTOMNE, HIVER...);</li>
<li>les sigles, soit 3 caractères majuscules de A à Z, suivis d&#x27;un trait-d&#x27;union, suivis de 4 chiffres, suivis d&#x27;un espace et d&#x27;une fin de ligne;</li>
<li>les sections, soit A, Z1, Z3, Z4 ou H;</li>
<li>les titres, soit une chaîne de caractères d&#x27;au moins 10 de long;</li>
<li>les crédits, soit 0, 3 ou 6, suivi ou non d&#x27;un espace, suivi d&#x27;une fin de ligne.</li>
</ul>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Mettre dans cette partie les expressions régulières que vous utilisez</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import re</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Mettre vos regex ici...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Ci-dessous, les patterns regex pour identifier respectivement</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># la chaîne &quot;Nouveau cours&quot;, la chaîne &quot;jumelé avec [sigle]&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># les espaces à la fin qui peuvent être coupés,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># les sigles, les sections, les titres et les crédits.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">nouveau_cours_pattern = r&quot;\s+Nouveau cours&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">jumele_avec_pattern = r&quot;\(jumelé avec [A-Z]{3}-\d{4}\)&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">trim_pattern = r&quot;\s+$|^Cours.+|[A-Z]{5}.+&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sigle_pattern = r&quot;^[A-Z]{3}-\d{4}$&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">section_pattern = r&quot;^(A|Z1|Z3|ZA|H)$&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">titre_pattern = r&quot;.{10,}&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">credit_pattern = r&quot;^(0|3|6)$&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>J&#x27;explique ici ma démarche pour créer la fonction principale d&#x27;extractions d&#x27;informations.</p>
<p>J&#x27;ai examiné la structure du fichier <code>data/cours_A2023.txt</code> et j&#x27;ai remarqué ceci :</p>
<ul>
<li>Le fichier contient successivement :<!-- -->
<ul>
<li>37 sigles (lignes 6 à 42),</li>
<li>37 titres (lignes 44 à 80),</li>
<li>37 sections (lignes 82 à 118),</li>
<li>10 sigles (lignes 121 à 130),</li>
<li>10 sections (lignes 132 à 141),</li>
<li>1 sigle (ligne 143),</li>
<li>1 section (ligne 145),</li>
<li>11 titres (lignes 147 à 158, dont un titre apparaissant sur deux lignes),</li>
<li>37 crédits (lignes 162 à 198),</li>
<li>9 crédits (lignes 200 à 208),</li>
<li>2 crédits (lignes 210 et 211).</li>
</ul>
</li>
<li>Au total, je compte 48 sigles, 48 titres, 48 sections et 48 crédits.</li>
<li>Ces observations me permettent du supposer que les sigles, les titres, les sections et les crédits sont présentés dans le même ordre, c&#x27;est-à-dire que le <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span>-ième sigle, le <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span>-ième titre, la <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span>-ième section et le <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span>-ième crédit sont liés au <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span>-ième cours.</li>
<li>Le <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span>-ième sigle est toujours présenté avant le <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span>-ième titre, la <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span>-ième section ou le <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span>-ième crédit.</li>
</ul>
<p>Considérant ces observations, j&#x27;ai utilisé la démarche suivante :</p>
<ul>
<li>Je parcours chaque élément (<code>text</code>) de la liste de textes (<code>text_list</code>) avec une boucle <code>for</code>;</li>
<li>À chaque élément de la liste :<!-- -->
<ul>
<li>Je supprime d&#x27;abord les chaînes de caractères correspondant aux expressions régulières <code>nouveau_cours_pattern</code>, <code>jumele_avec_pattern</code> et <code>trim_pattern</code>.</li>
<li>Je détermine si la ligne contient un sigle. Si oui, j&#x27;extrais le sigle et l&#x27;ajoute à une liste de sigles.</li>
<li>Sinon, je détermine si la ligne contient une section. Si oui, j&#x27;extrais la section et l&#x27;ajoute à une liste de sections.</li>
<li>Sinon, je détermine si la ligne contient un titre. Si oui, j&#x27;extrais le titre et l&#x27;ajoute à une liste de titres.</li>
<li>Sinon, je détermine si la ligne contient un crédit. Si oui, j&#x27;extrais le crédit et l&#x27;ajoute à une liste de crédits.</li>
</ul>
</li>
<li>J&#x27;obtiens alors 4 listes nommées <code>sigles</code>, <code>sections</code>, <code>titres</code> et <code>credits</code> respectivement de longueur 48, 48, 56 et 48.<!-- -->
<ul>
<li>J&#x27;obtiens plus de titres que de sigles mais cela n&#x27;est pas tellement grave... en autant que je ne conserve pas plus de titres que de sigles.</li>
</ul>
</li>
<li>Enfin, je crée une liste de cours en conservant que les <code>N</code> premiers éléments des listes <code>sigles</code>, <code>sections</code>, <code>titres</code> et <code>credits</code> avec <code>N=len(sigles)</code>.</li>
</ul>
<p>La performance de mon algorithme est excellente car les extractions sont tous identiques à la solution. Les résultats sont présentés ci-dessous :</p>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">48: Nombre de sigles correctement extraits</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">48: Nombre de sections correctement extraites et associées au bon sigle de cours</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">48: Nombre de titres corrects</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">48: Nombre de titres correctement associés au sigle de cours</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">48: Nombre de crédits correctement associés au sigle de cours</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">48: Nombre de bonnes descriptions complètes de cours</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">def extract_course_informations(text_list):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Cette fonction construit la liste de cours à partir du texte en entrée (une liste de lignes de textes).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Chaque coursest un dictionnaire qui contient les informations pertinentes (sigle, section, titre, crédit).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Insérez ici votre code pour la production de la liste de cours...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Créer des listes vides pour les sigles, sections, titres et crédits.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    sigles = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    sections = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    titres = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    credits = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Appliquer les expressions régulières à chaque élément de la liste</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    for text in text_list:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Supprimer certaines chaînes.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        text = re.sub(nouveau_cours_pattern, &#x27;&#x27;, text)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        text = re.sub(jumele_avec_pattern, &#x27;&#x27;, text)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        text = re.sub(trim_pattern, &#x27;&#x27;, text)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Est-ce un sigle?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        match = re.match(sigle_pattern, text)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if match:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            sigle = match.group()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            sigles.append(sigle)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            continue</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Est-ce une section?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        match = re.match(section_pattern, text)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if match:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            section = match.group()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            sections.append(section)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            continue</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Est-ce un titre?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        match = re.match(titre_pattern, text)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if match:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            titre = match.group()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            titres.append(titre)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            continue</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Est-ce un crédit?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        match = re.match(credit_pattern, text)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if match:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            credit = match.group()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            credits.append(int(credit))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Créer la liste de cours en utilisant les N premiers éléments de chaque liste</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # avec n étant égale au nombre de sigles.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    n = len(sigles)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    courses = [[sigles[i], sections[i], titres[i], credits[i]] for i in range(n)]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return courses</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="section-3---visualisation-des-résultats-de-lextraction-dinformations">Section 3 - Visualisation des résultats de l&#x27;extraction d&#x27;informations<a href="#section-3---visualisation-des-résultats-de-lextraction-dinformations" class="hash-link" aria-label="Direct link to Section 3 - Visualisation des résultats de l&#x27;extraction d&#x27;informations" title="Direct link to Section 3 - Visualisation des résultats de l&#x27;extraction d&#x27;informations">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">courses = extract_course_informations(course_info)   # La liste de cours extraites à partir du texte</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def get_dataframe(course_info):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return pd.DataFrame.from_dict(course_info, orient=&#x27;columns&#x27;, dtype=None, columns=None)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df = get_dataframe(courses)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def get_dataframe(course_info):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    df = pd.DataFrame(course_info)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    df.columns =[&#x27;Sigle&#x27;, &#x27;Section&#x27;, &#x27;Titre&#x27;, &#x27;Credit&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return df</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df = get_dataframe(courses)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ci-dessous, du code utile pour inspecter le dataframe que j&#x27;ai créé.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Informations sur le dataframe.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df.info(verbose=True)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">RangeIndex: 48 entries, 0 to 47</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Data columns (total 4 columns):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    #   Column   Non-Null Count  Dtype</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">---  ------   --------------  -----</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    0   Sigle    48 non-null     object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    1   Section  48 non-null     object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    2   Titre    48 non-null     object</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    3   Credit   48 non-null     int64</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dtypes: int64(1), object(3)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">memory usage: 1.6+ KB</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="section-4---évaluation-de-performance">Section 4 - Évaluation de performance<a href="#section-4---évaluation-de-performance" class="hash-link" aria-label="Direct link to Section 4 - Évaluation de performance" title="Direct link to Section 4 - Évaluation de performance">​</a></h3>
<p>Évaluez la performance de votre programme dans cette section. Ceci peut être fait à la main ou par programmation selon ce qui vous convient le mieux.</p>
<p>Résultats à présenter :</p>
<ul>
<li>Nombre de sigles correctement extraits</li>
<li>Nombre de sections correctement extraites et associées au bon sigle de cours</li>
<li>Nombre de titres corrects, c.-à-d. un texte complet sans commentaires additionnels sur la nouveauté ou le jumelage</li>
<li>Nombre de titres correctement associés au sigle de cours</li>
<li>Nombre de crédits correctement associés au sigle de cours</li>
<li>Nombre de bonnes descriptions complètes de cours. Par exemple, pour l&#x27;automne 2023, il y a un total de 48 cours dans le fichier. Indiquez le nombre de cours dont tous les attributs extraits sont corrects.</li>
</ul>
<p>Analyser les erreurs effectuées par votre programme. Vous pouvez ajouter au besoin des cellules dans cette section du notebook.</p>
<p>Pour évaluer la performance de mon code, j&#x27;effectue les étapes suivantes :</p>
<ul>
<li>Créer un dataframe avec le fichier JSON contenant la solution.</li>
<li>Fusionner ce datafranme contenant la solution avec mon dataframe que j&#x27;ai créé précédemment.</li>
<li>Identifier les égalités sur les colonnes Sigle, Section, Titre et Credit entre la solution et mon dataframe.</li>
<li>Afficher les résultats.</li>
</ul>
<p>Les résultats obtenus sont parfaite</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Créer un dataframe avec la solution.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df_sol = pd.read_json(&quot;./data/cours_A2023_solution.json&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(f&quot;Nombre de cours: {len(df_sol)}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Nombre de cours: 48</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Fusionner les deux dataframes: le mien et la solution.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df_eval = df.join(df_sol, rsuffix=&#x27;_sol&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df_eval.head()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th>Sigle</th><th>Section</th><th>Titre</th><th>Credit</th></tr></thead><tbody><tr><td>GIF-1001</td><td>H</td><td>Ordinateurs : structures et applications</td><td>3</td></tr><tr><td>GIF-1003</td><td>A</td><td>Programmation avancée en C++ pour ingénieurs</td><td>3</td></tr><tr><td>GLO-1111</td><td>ZA</td><td>Pratique du génie logiciel</td><td>0</td></tr><tr><td>GLO-2000</td><td>A</td><td>Réseaux pour ingénieurs</td><td>3</td></tr><tr><td>GLO-2004</td><td>Z3</td><td>Génie logiciel orienté objet</td><td>3</td></tr></tbody></table>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Identifier les égalités.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sigle_equal = df_eval[&#x27;Sigle&#x27;] == df_eval[&#x27;Sigle_sol&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">section_equal = df_eval[&#x27;Section&#x27;] == df_eval[&#x27;Section_sol&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">titre_equal = df_eval[&#x27;Titre&#x27;] == df_eval[&#x27;Titre_sol&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">credit_equal = df_eval[&#x27;Credit&#x27;] == df_eval[&#x27;Credit_sol&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Calculer les nombres d&#x27;égalités indiqués dans l&#x27;énoncé.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># q1: Nombre de sigles correctement extraits.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df_eval[&#x27;q1&#x27;] = (sigle_equal).astype(int)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># q2: Nombre de sections correctement extraites et associées au bon sigle de cours.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df_eval[&#x27;q2&#x27;] = (sigle_equal &amp; section_equal).astype(int)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># q3: Nombre de titres corrects, c.-à-d. un texte complet sans commentaires</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># additionnels sur la nouveauté ou le jumelage.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df_eval[&#x27;q3&#x27;] = (titre_equal).astype(int)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># q4: Nombre de titres correctement associés au sigle de cours.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df_eval[&#x27;q4&#x27;] = (sigle_equal &amp; titre_equal).astype(int)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># q5: Nombre de crédits correctement associés au sigle de cours.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df_eval[&#x27;q5&#x27;] = (sigle_equal &amp; credit_equal).astype(int)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># q6: Nombre de bonnes descriptions complètes de cours. Par exemple, pour l&#x27;automne 2023,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># il y a un total de 48 cours dans le fichier. Indiquez le nombre de cours dont tous les</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># attributs extraits sont corrects.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df_eval[&#x27;q6&#x27;] = (sigle_equal &amp; section_equal &amp; titre_equal &amp; credit_equal).astype(int)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">df_eval.head()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th>Sigle</th><th>Section</th><th>Titre</th><th>Credit</th><th>Sigle_sol</th><th>Section_sol</th><th>Titre_sol</th><th>Credit_sol</th><th>q1</th><th>q2</th><th>q3</th><th>q4</th><th>q5</th><th>q6</th></tr></thead><tbody><tr><td>GIF-1001</td><td>H</td><td>Ordinateurs : structures et applications</td><td>3</td><td>GIF-1001</td><td>H</td><td>Ordinateurs : structures et applications</td><td>3</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr><tr><td>GIF-1003</td><td>A</td><td>Programmation avancée en C++ pour ingénieurs</td><td>3</td><td>GIF-1003</td><td>A</td><td>Programmation avancée en C++ pour ingénieurs</td><td>3</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr><tr><td>GLO-1111</td><td>ZA</td><td>Pratique du génie logiciel</td><td>0</td><td>GLO-1111</td><td>ZA</td><td>Pratique du génie logiciel</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr><tr><td>GLO-2000</td><td>A</td><td>Réseaux pour ingénieurs</td><td>3</td><td>GLO-2000</td><td>A</td><td>Réseaux pour ingénieurs</td><td>3</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr><tr><td>GLO-2004</td><td>Z3</td><td>Génie logiciel orienté objet</td><td>3</td><td>GLO-2004</td><td>Z3</td><td>Génie logiciel orienté objet</td><td>3</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr></tbody></table>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Afficher les résultats.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def count(question: str, text: str)  -&gt; None:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    print(f&quot;{df_eval[question].sum()}: {text}.&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">count(&quot;q1&quot;, &quot;Nombre de sigles correctement extraits&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">count(&quot;q2&quot;, &quot;Nombre de sections correctement extraites et associées au bon sigle de cours&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">count(&quot;q3&quot;, &quot;Nombre de titres corrects&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">count(&quot;q4&quot;, &quot;Nombre de titres correctement associés au sigle de cours&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">count(&quot;q5&quot;, &quot;Nombre de crédits correctement associés au sigle de cours&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">count(&quot;q6&quot;, &quot;Nombre de bonnes descriptions complètes de cours&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">48: Nombre de sigles correctement extraits.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">48: Nombre de sections correctement extraites et associées au bon sigle de cours.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">48: Nombre de titres corrects.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">48: Nombre de titres correctement associés au sigle de cours.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">48: Nombre de crédits correctement associés au sigle de cours.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">48: Nombre de bonnes descriptions complètes de cours.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tâche-2---comme-le-disait-le-proverbe---les-bons-mots-pour-le-dire">Tâche 2 - Comme le disait le proverbe - les bons mots pour le dire<a href="#tâche-2---comme-le-disait-le-proverbe---les-bons-mots-pour-le-dire" class="hash-link" aria-label="Direct link to Tâche 2 - Comme le disait le proverbe - les bons mots pour le dire" title="Direct link to Tâche 2 - Comme le disait le proverbe - les bons mots pour le dire">​</a></h2>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import sys</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import nltk</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(f&quot;Python version {sys.version}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(f&quot;pandas {pd.__version__}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(f&quot;NLTK {nltk.__version__}&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>L&#x27;objectif de cette tâche est de compléter des proverbes à l&#x27;aide de modèles de langue N-grammes en insérant des mots aux bons endroits dans un texte masqué. Il s&#x27;agit d&#x27;une tâche de type <em>cloze test</em> qui consiste à choisir le meilleur mot à insérer dans un texte en fonction de son contexte.</p>
<p>Voir l&#x27;énoncé du travail #1 pour une description plus détaillée de cette tâche.</p>
<p>Fichiers:</p>
<ul>
<li><em>proverbes.txt</em>: il contient plus de 3000 proverbes, un par ligne de texte. Pour l&#x27;entraînement des modèles de langues N-grammes.</li>
<li><em>test_proverbes_v1.json</em>: il contient des proverbes masqués, les mots à insérer et la bonne formulation du proverbe. À utiliser pour évaluer la capacité des modèles à mettre les mots aux bons endroits.</li>
</ul>
<p>Consignes:</p>
<ul>
<li>Utilisez NLTK pour construire les modèles de langue.</li>
<li>Utilisez des expressions régulières (une seule ou plusieurs) pour remplacer les * et les ** par des mots.</li>
<li>Utilisez NLTK pour faire la tokenisation des proverbes.</li>
<li>N&#x27;oubliez pas de faire le <em>padding</em> des proverbes avec des symboles de début &lt;BOS&gt; et de fin &lt;EOS&gt;.</li>
<li>Ne pas modifier les fonctions <em>load_proverbs</em> et <em>load_tests</em>.</li>
<li>Ne pas modifier la signature de la fonction <em>replace_stars_with_words</em>.</li>
<li>Utilisez la variable <em>models</em> pour conserver les modèles après entraînement.</li>
<li>Ne pas modifier la signature de la fonction <em>train_models</em>.</li>
<li>Ne pas modifier la signature de la fonction <em>fill_masked_proverb</em>.</li>
<li>Des modifications aux signatures pourraient entraîner des déductions dans la correction.</li>
<li>Vous pouvez ajouter des cellules au notebook et toutes les fonctions utilitaires que vous voulez.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="section-1---lecture-des-fichiers-de-données-proverbes-et-tests">Section 1 - Lecture des fichiers de données (proverbes et tests)<a href="#section-1---lecture-des-fichiers-de-données-proverbes-et-tests" class="hash-link" aria-label="Direct link to Section 1 - Lecture des fichiers de données (proverbes et tests)" title="Direct link to Section 1 - Lecture des fichiers de données (proverbes et tests)">​</a></h3>
<p>Je n&#x27;ai aucun commentaire ici puisqu&#x27;on n&#x27;a aucune modification à faire.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Ne pas modifier le chemin de ces 2 fichiers pour faciliter notre correction</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">proverbs_fn = &quot;./data/proverbes.txt&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">test_v1_fn = &#x27;./data/test_proverbes_v1.json&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def load_proverbs(filename):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    with open(filename, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as f:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        raw_lines = f.readlines()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return [x.strip() for x in raw_lines]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def load_tests(filename):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    with open(filename, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as fp:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        test_data = json.load(fp)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return test_data</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">proverbs = load_proverbs(proverbs_fn)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(&quot;Nombre de proverbes pour l&#x27;entraînement: {}&quot;.format(len(proverbs)))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(&quot;Un exemple de proverbe: &quot; + proverbs[5])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Nombre de proverbes pour l&#x27;entraînement: 3108</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Un exemple de proverbe: accord vaut mieux qu’argent</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">tests = load_tests(test_v1_fn)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def get_dataframe(test_proverbs):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return pd.DataFrame.from_dict(test_proverbs, orient=&#x27;columns&#x27;, dtype=None, columns=None)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df = get_dataframe(tests)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df.head()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th>Masked</th><th>Word_list</th><th>Proverb</th></tr></thead><tbody><tr><td>a beau * qui ** de loin</td><td>[vient, mentir]</td><td>a beau mentir qui vient de loin</td></tr><tr><td>a * mentir qui vient de **</td><td>[beau, loin]</td><td>a beau mentir qui vient de loin</td></tr><tr><td>l’* fait le **</td><td>[larron, occasion]</td><td>l’occasion fait le larron</td></tr><tr><td><em>-toi, le ciel t’</em>*</td><td>[aidera, aide]</td><td>aide-toi, le ciel t’aidera</td></tr><tr><td>année de *, ** de blé</td><td>[année, gelée]</td><td>année de gelée, année de blé</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="section-2---code-pour-substituer-les-masques-étoiles-par-des-mots">Section 2 - Code pour substituer les masques (étoiles) par des mots<a href="#section-2---code-pour-substituer-les-masques-étoiles-par-des-mots" class="hash-link" aria-label="Direct link to Section 2 - Code pour substituer les masques (étoiles) par des mots" title="Direct link to Section 2 - Code pour substituer les masques (étoiles) par des mots">​</a></h3>
<p>Expliquez ici comment vous procédez pour remplacer les étoiles des proverbes masqués par des mots... N&#x27;oubliez pas qu&#x27;il faut faire usage d&#x27;expressions régulières (une ou plusieurs - au choix).</p>
<p>Pour remplacer les étoiles des proverbes masqués par des mots avec des expressions régulières, j&#x27;effectue ces deux étapes dans l&#x27;ordre :</p>
<ul>
<li>D&#x27;abord, je remplace le double astérix <code>**</code> par <code>word2</code> en utilisant l&#x27;expression régulière <code>r&quot;\*\*&quot;</code>.</li>
<li>Puis, je remplace le simple astérix <code>*</code> par <code>word1</code> en utilisant l&#x27;expression régulière <code>r&quot;\*&quot;</code>.</li>
</ul>
<p>Ces deux lignes de code sont ajoutées à la fonction <code>replace_starts_with_words()</code>.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">proverb = re.sub(r&quot;\*\*&quot;, word2, masked)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">proverb = re.sub(r&quot;\*&quot;, word1, proverb)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>J&#x27;ai ajouté une seconde cellule ci-dessous pour voir si la fonction modifiée <code>replace_stars_with_words()</code> fonctionne correctement.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import re</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def replace_stars_with_words(masked, word1, word2):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot;Remplace les * par word1 et word2 dans cet ordre. Retourne le proverbe complet.&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # votre code</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    proverb = re.sub(r&quot;\*\*&quot;, word2, masked)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    proverb = re.sub(r&quot;\*&quot;, word1, proverb)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return proverb  # Retourne le proverbe avec des mots à la place des étoiles</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>L&#x27;instruction ci-dessous permet de voir que la fonction <code>replace_stars_with_words()</code> fonctionne correctement.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Appliquer la fonction à chaque ligne du DataFrame et créer une nouvelle colonne</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df[&#x27;Reconstructed_Proverb&#x27;] = df.apply(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    lambda row: replace_stars_with_words(row[&#x27;Masked&#x27;], row[&#x27;Word_list&#x27;][0],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                         row[&#x27;Word_list&#x27;][1]), axis=1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df.head()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th>Masked</th><th>Word_list</th><th>Proverb</th><th>Reconstructed_Proverb</th></tr></thead><tbody><tr><td>a beau * qui ** de loin</td><td>[vient, mentir]</td><td>a beau mentir qui vient de loin</td><td>a beau vient qui mentir de loin</td></tr><tr><td>a * mentir qui vient de **</td><td>[beau, loin]</td><td>a beau mentir qui vient de loin</td><td>a beau mentir qui vient de loin</td></tr><tr><td>l’* fait le **</td><td>[larron, occasion]</td><td>l’occasion fait le larron</td><td>l’larron fait le occasion</td></tr><tr><td><em>-toi, le ciel t’</em>*</td><td>[aidera, aide]</td><td>aide-toi, le ciel t’aidera</td><td>aidera-toi, le ciel t’aide</td></tr><tr><td>année de *, ** de blé</td><td>[année, gelée]</td><td>année de gelée, année de blé</td><td>année de année, gelée de blé</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="section-3---construction-des-modèles-de-langue-n-grammes">Section 3 - Construction des modèles de langue N-grammes<a href="#section-3---construction-des-modèles-de-langue-n-grammes" class="hash-link" aria-label="Direct link to Section 3 - Construction des modèles de langue N-grammes" title="Direct link to Section 3 - Construction des modèles de langue N-grammes">​</a></h3>
<p>La fonction <em><strong>train_models</strong></em> prend en entrée une liste de proverbes et construit les trois modèles unigramme, bigramme et trigramme.</p>
<p>Les 3 modèles entraînés sont conservés dans <em>models</em>, un dictionnaire Python qui prend la forme</p>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   1: modele_unigramme,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   2: modele_bigramme,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   3: modele_trigramme</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>avec comme clé la valeur N du modèle et comme valeur le modèle construit par NLTK.</p>
<p>Expliquez ici comment vous procéder pour construire vos modèles avec NLTK, pour obtenir les n-grammes de mots, pour déterminer le vocabulaire, etc...</p>
<p>Voici une explication de ma démarche pour construire les modèles N-grammes avec NTLK.</p>
<p>Comme indiqué dans l&#x27;exemple fourni sur le site du cours, les étapes habituelles pour créer un modèle N-grammes sont :</p>
<ol>
<li>la construction du vocabulaire</li>
<li>la construction des N-grammes</li>
<li>l&#x27;entraînement du modèle N-gramme</li>
<li>l&#x27;utilisation du modèle pour estimer des probabilités ou des perplexités</li>
</ol>
<p>Nous devons importer d&#x27;autres librairies de NTLK pour créer des modèles N-grammes :</p>
<ul>
<li><code>ntlk.tokenize.word_tokenize</code> pour découper les phrases en mots;</li>
<li><code>ntlk.util.ngrams</code> pour extraire les N-grammes;</li>
<li><code>ntlk.util.pad_sequence</code> qui renvoie une séquence complétée d&#x27;éléments avant l&#x27;extraction des N-grammes;</li>
<li><code>nltk.util.everygrams</code> pour générer une liste de tous les N-grammes possibles jusqu&#x27;à une certaine longueur maximale <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span>;</li>
<li><code>ntlk.lm.Laplace</code> pour créer des modèles N-grammes avec lissage de Laplace.</li>
</ul>
<p>Ainsi, ces trois lignes de code sont ajoutées pour importer les librairies requises.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">from nltk.tokenize import word_tokenize</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from nltk.util import ngrams, pad_sequence</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from nltk.lm import Laplace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import nltk</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># autres librairies à importer pour la partie sur les N-grammes?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from nltk.tokenize import word_tokenize</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from nltk.util import ngrams, pad_sequence, everygrams</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from nltk.lm import Laplace</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">BOS = &#x27;&lt;BOS&gt;&#x27;  # Jeton de début de proverbe</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EOS = &#x27;&lt;EOS&gt;&#x27;  # Jeton de fin de proverbe</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">models = {}  # les modèles entraînés - [1: modele_unigramme, 2: modele_bigramme, 3: modele_trigramme]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>La cellule ci-dessous contient une fonction pour construire le vocabulaire. Elle transforme les phrases en minuscule, découpe les phrases en mots et ajoute tous les mots dans un ensemble <code>set</code>, y compris les BOS (<em>Beginning Of Sentence</em>) et EOS (<em>End Of Sentence</em>).</p>
<p>J&#x27;obtiens 4471 mots différents dans le vocabulaire.</p>
<p>Cette fonction provient du notebook du site du cours.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">def build_vocabulary(text_list):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    all_unigrams = list()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    for sentence in text_list:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        word_list = word_tokenize(sentence.lower())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        all_unigrams = all_unigrams + word_list</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    voc = set(all_unigrams)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    voc.add(BOS)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    voc.add(EOS)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return list(voc)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vocabulary = build_vocabulary(proverbs)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(f&quot;Nombre de mots différents dans le vocabulaire: {len(vocabulary)}.&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(&quot;Vocabulaire (25 premiers mots):&quot;, vocabulary[:25])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Nombre de mots différents dans le vocabulaire: 4471.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Vocabulaire (25 premiers mots): [&#x27;instant&#x27;, &#x27;oignez&#x27;, &#x27;balaie&#x27;, &#x27;tout&#x27;, &#x27;habite&#x27;, &#x27;chenille&#x27;, &#x27;cornu&#x27;, </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&#x27;promet&#x27;, &#x27;robe&#x27;, &#x27;paria&#x27;, &#x27;obscure&#x27;, &#x27;oi&#x27;, &#x27;sur&#x27;, &#x27;raser&#x27;, &#x27;sourd&#x27;, &#x27;veillant&#x27;, &#x27;picard&#x27;, &#x27;peuvent&#x27;, </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&#x27;autorité&#x27;, &#x27;dommage&#x27;, &#x27;zèle&#x27;, &#x27;chambrière&#x27;, &#x27;faim&#x27;, &#x27;loger&#x27;, &#x27;midi&#x27;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Par la suite, on extrait les N-grammes du texte. La fonction suivante qui provient du site du cours aide à faire cela.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">def get_ngrams(text_list, n=2):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    all_ngrams = list()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    for sentence in text_list:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        tokens = word_tokenize(sentence.lower())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        padded_sent = list(pad_sequence(tokens, pad_left=True, left_pad_symbol=BOS, pad_right=True, right_pad_symbol=EOS, n=n))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        all_ngrams = all_ngrams + list(ngrams(padded_sent, n=n))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return all_ngrams</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Par exemple, avec n=1...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">order = 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">corpus_ngrams = get_ngrams(proverbs, n=order)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(&quot;Les 10 premiers unigrammes:&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(corpus_ngrams[:10])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Par exemple, avec n=2...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">order = 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">corpus_ngrams = get_ngrams(proverbs, n=order)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(&quot;Les 10 premiers bigrammes:&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(corpus_ngrams[:10])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Par exemple, avec n=3...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">order = 3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">corpus_ngrams = get_ngrams(proverbs, n=order)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(&quot;Les 10 premiers trigrammes:&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(corpus_ngrams[:10])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Finalement, on crée et on entraîne un modèle à partir du vocabulaire et des N-grammes de nos textes d&#x27;entraînement. Dans cet exemple présenté à titre illustratif, on construit un modèle avec lissage de Laplace.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># À titre illustratif... On construit et on entraîne un modèle N-grammes.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">model = Laplace(order)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">model.fit([corpus_ngrams], vocabulary_text=vocabulary)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">len(model.vocab)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 4472</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>La fonction <code>train_models(proverbs)</code> ci-dessous regroupe le tout pour créer des modèles N-grammes d&#x27;ordre 1, 2 et 3 de la façon suivante :</p>
<ul>
<li>Dans une boucle couvrant chacun des modèles N-grammes avec <code>order = 1,2,3</code>
<ul>
<li>Extraire les N-grammes des proverbes.</li>
<li>Créer un modèle N-grammes avec lissage de Laplace.</li>
<li>Entraîner le modèle N-grammes avec les données prétraitées et le vocabulaire précédemment créé.</li>
<li>Conserver le modèle N-grammes dans un dictionnaire.</li>
<li>Retourner le dictionnaire contenant les trois modèles N-grammes.</li>
</ul>
</li>
</ul>
<p>Ensuite, j&#x27;attribue le dictionnaire des modèles dans une variable globale nommée <code>models</code>.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">def train_models(proverbs):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot; Vous ajoutez à partir d&#x27;ici le code dont vous avez besoin</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        pour construire les différents modèles N-grammes.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Cette fonction doit construire tous les modèles en une seule passe.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Voir les consignes de l&#x27;énoncé du travail pratique concernant les modèles à entraîner.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Vous pouvez ajouter les fonctions/méthodes et variables que vous jugerez nécessaire.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Merci de ne pas modifier la signature et le comportement de cette fonction (nom, arguments, sauvegarde des modèles).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Votre code à partir d&#x27;ici...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Créer des modèles N-grammes (n=1,2,3) avec lissage de Laplace.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ngram_models = {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    for order in range(1, 4):  # Pour n allant de 1 à 3 inclus.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Extraire les N-grammes des proverbes.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        corpus_ngrams = get_ngrams(proverbs, n=order)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Créer un modèle N-grammes avec lissage de Laplace.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ngram_models[order] = Laplace(order)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Entraîner le modèle N-grammes avec les données prétraitées et le vocabulaire.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ngram_models[order].fit([corpus_ngrams], vocabulary_text=vocabulary)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return ngram_models</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Attribuer la liste des modèles dans une variable globale.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">models = train_models(proverbs)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="section-4---compléter-un-proverbe">Section 4 - Compléter un proverbe<a href="#section-4---compléter-un-proverbe" class="hash-link" aria-label="Direct link to Section 4 - Compléter un proverbe" title="Direct link to Section 4 - Compléter un proverbe">​</a></h3>
<p>Voici une explication de ma démarche pour compléter un proverbe.</p>
<p>La fonction <code>fill_masked_proverb()</code> effectue successivement les opérations suivantes :</p>
<ul>
<li>Créer des dictionnaires vides (<code>test_proverb</code>, <code>test_logprob</code> et <code>test_perplexity</code>) pour contenir respectivement le proverbe, le logprob et la perplexité pour les proverbes reconstruits avec les combinaisons <code>[word1, word2]</code> et <code>[word2, word1]</code>.</li>
<li>Dans une boucle <code>k = 0,1</code> gérant les combinaisons <code>[word1, word2]</code> et <code>[word2, word1]</code> :<!-- -->
<ul>
<li>Construire le proverbe en remplaçant les astérix par les mots dans l&#x27;ordre proposé avec la fonction <code>replace_stars_with_words()</code>.</li>
<li>Découper le proverbe en mots et ajouter les jetons BOS et EOS.</li>
<li>Attribuer à <code>model</code> le model N-grammes où N est donnée par le paramètre <code>n</code>.</li>
<li>Si <code>criteria == &quot;perplexity&quot;</code> alors :<!-- -->
<ul>
<li>Extraire les n-grammes du proverbe.</li>
<li>Calculer l&#x27;entropie et la perplexité.</li>
<li>Le meilleur proverbe est celui ayant la perplexité la moins élevée.</li>
</ul>
</li>
<li>Si <code>criteria == &quot;logprob&quot;</code> alors :<!-- -->
<ul>
<li>Initialiser une variable pour stocker le logarithme de la probabilité (<em>logprob</em>) total du proverbe.</li>
<li>Dans une boucle, parcourir le proverbe à partir de la position n (pour éviter de sortir de la plage).<!-- -->
<ul>
<li>Extraire le contexte (mots précédents) de longueur n-1 et le mot actuel.</li>
<li>Calculer le logarithme de la probabilité (<em>logprob</em>) du mot actuel en fonction du contexte.</li>
<li>Ajouter le <em>logprob</em> du mot actuel au <em>logprob</em> total.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">def fill_masked_proverb(masked, word_list, n=3, criteria=&quot;perplexity&quot;):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot; Fonction qui complète un texte à trous (des mots masqués) en ajoutant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        les bons mots aux bons endroits (un &quot;cloze test&quot;).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Le paramètre criteria indique la mesure qu&#x27;on utilise</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        pour choisir le mot le plus approprié: &quot;logprob&quot; ou &quot;perplexity&quot;.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        On retourne l&#x27;estimation de cette mesure sur le proverbe complet,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        c.-à-d. en utilisant tous les mots du proverbe.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Le paramètre n désigne le modèle utilisé.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        1 - unigramme NLTK, 2 - bigramme NLTK, 3 - trigramme NLTK</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Cette fonction retourne la solution (le proverbe complété) et</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        la valeur de logprob ou perplexité (selon le paramètre en entrée de la fonction).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Votre code à partir d&#x27;ici. Vous pouvez modifier comme bon vous semble.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    test_proverb = {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    test_logprob = {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    test_perplexity = {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    for k in range(0,2):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Construire le proverbe.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        word1, word2 = word_list[k], word_list[k-1]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        log(f&quot;\nword1 = {word1}, word2 = {word2}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        test_proverb[k] = replace_stars_with_words(masked, word1, word2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        log(f&quot;test_proverb = {test_proverb[k]}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Découper le proverbe en mots et ajouter les jetons BOS et EOS.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        test_tokens = nltk.word_tokenize(test_proverb[k])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        test_tokens = [BOS] + test_tokens + [EOS]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        log(f&quot;test_tokens = {test_tokens}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        log(f&quot;\n{n}-gram model:&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        model = models[n]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if criteria == &quot;perplexity&quot;:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # Calculer la perplexité.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # Extraire les n-grammes du proverbe.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # Plus précisément, générer une liste de tous les N-grammes possibles</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # jusqu&#x27;à une longueur maximale de n;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            test_ngrams = list(everygrams(test_tokens, max_len=n))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # Calculer l&#x27;entropie et la perplexité.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            entropy_value = model.entropy(test_ngrams)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            test_perplexity[k] = 2 ** entropy_value</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # Écrire les valeurs calculées.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            log(f&quot;Entropy: {entropy_value:.4f}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            log(f&quot;Perplexity: {test_perplexity[k]:.4f}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        else:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # Calculer le logprob total pour la phrase entière.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            test_logprob[k] = 0.0  # Initialiser la variable pour stocker le logprob total.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # Parcourir la phrase à partir de la position n (pour éviter de sortir de la plage).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            for i in range(n, len(test_tokens)):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                # Extraire le contexte (mots précédents) de longueur n-1 et le mot actuel.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                context, word = tuple(test_tokens[i-n:i-1]), test_tokens[i]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                # Calculer le logprob du mot actuel en fonction du contexte.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                log_prob = model.logscore(word, context)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                # Ajouter le logprob du mot actuel au logprob total.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                test_logprob[k] += log_prob</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                # Afficher le logprob du mot actuel par rapport au contexte.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                log(f&quot;LogProb({word}|{context}) = {log_prob:.4f}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # Afficher le logprob total pour la phrase.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            log(f&quot;Total LogProb for the sentence = {test_logprob[k]:.4f}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if criteria == &quot;perplexity&quot;:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Choisir le proverbe la perplexité la plus faible.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if test_perplexity[0] &lt; test_perplexity[1]:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            best_perplexity = test_perplexity[0]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            result = test_proverb[0]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        else:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            best_perplexity = test_perplexity[1]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            result = test_proverb[1]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    else:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Choisir le meilleur proverbe selon le logprob.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Plus la séquence est probable selon le modèle, plus sa valeur de logprob est</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # proche de zéro (en d&#x27;autres termes, moins négative).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if test_logprob[0] &gt; test_logprob[1]:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            best_logprob = test_logprob[0]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            result = test_proverb[0]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        else:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            best_logprob = test_logprob[1]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            result = test_proverb[1]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if criteria == &quot;perplexity&quot;:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        score = best_perplexity</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    else:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        score = best_logprob</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    log(f&quot;\nresult = {result}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    log(f&quot;score = {score} avec criteria = {criteria}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return result, score</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Le code ci-dessous sert à visualiser le fonctionnement de la fonction précédente.</p>
<p>La méthode <code>log(message)</code> est une fonction utilitaire pour écrire des traces lorsque <code>log_ok = True</code>.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">log_ok = True</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Fonction utilitaire pour écrire des traces lors du développement.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def log(message: str) -&gt; None:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if log_ok:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        print(message)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">masked =  &quot;* femme fait le ** homme&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">word_list = [&#x27;bon&#x27;, &#x27;bonne&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for n in range(1,4):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    result, score = fill_masked_proverb(masked, word_list, n=n, criteria=&quot;logprob&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    result, score = fill_masked_proverb(masked, word_list, n=n, criteria=&quot;perplexity&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="section-5---expérimentations-et-analyse-de-vos-résultats">Section 5 - Expérimentations et analyse de vos résultats<a href="#section-5---expérimentations-et-analyse-de-vos-résultats" class="hash-link" aria-label="Direct link to Section 5 - Expérimentations et analyse de vos résultats" title="Direct link to Section 5 - Expérimentations et analyse de vos résultats">​</a></h3>
<p>Décrivez ici les résultats obtenus et présentez l&#x27;évaluation obtenue sur le fichier de test. Vous pouvez ajouter le nombre de cellules que vous souhaitez.</p>
<p>Pour évaluer les résultats sur le fichier test, j&#x27;ai créé la fonction <code>test_all()</code> qui effectue automatiquement les étapes suivantes :</p>
<ul>
<li>Dans une boucle couvrant chacun des modèles N-grammes <code>N = 1,2,3</code> :<!-- -->
<ul>
<li>Copie le dataframe test dans un nouvea dataframe <code>test_df</code> sans la colonne <code>Reconstructed_Proverb</code>.</li>
<li>Déterminer le meilleur proverbe reconstruit selon le logprob.</li>
<li>Déterminer le meilleur proverbe reconstruit selon la perplexité.</li>
<li>Créer un indicateur 1|0 si égalité ou non entre <code>LogProb_Proverb</code> et <code>Proverb</code>.</li>
<li>Créer un indicateur 1|0 si égalité ou non entre <code>Perplexity_Proverb</code> et <code>Proverb</code>.</li>
<li>Afficher les résultats d&#x27;ensemble.</li>
</ul>
</li>
</ul>
<p>Avec les résultats obtenus (voir ci-dessous), je remarque que :</p>
<ul>
<li>la performance du modèle unigramme est mauvaise avec les deux mesures (<em>logprob</em> et perplexité);</li>
<li>la performance du modèle bigramme est encore mauvaise avec le <em>logprob</em> (seulement 15 égalités sur 31 sur l&#x27;ensemble de test) mais très bonne avec la mesure de perplexité (avec 30 égalités sur 31);</li>
<li>la performance du modèle trigramme est très mauvaise avec le <em>logprob</em> (seulement 7 égalités sur 31) mais excellente avec la mesure de perplexité (résultat parfait avec 31 égalités sur 31);</li>
<li>avec la mesure de perplexité, la performance du modèle augmente avec l&#x27;ordre (c&#x27;est-à-dire selon le N du N-grammes).<!-- -->
<ul>
<li>En d&#x27;autres mots, les proverbes générés à partir des modèles d&#x27;ordre supérieurs semblent meilleurs;</li>
</ul>
</li>
<li>toutefois, avec la mesure <em>logprob</em>, la performance du modèle diminue entre l&#x27;ordre 2 et l&#x27;ordre 3;</li>
<li>la performance obtenue est toujours meilleure avec la mesure de perplexité qu&#x27;avec le <em>logprob</em>.</li>
</ul>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Présenter les résultats d&#x27;ensemble.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def test_all() -&gt; None:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    for n in range(1, 4):  # Pour n allant de 1 à 3 inclus.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Copier le dataframe de test `df` dans un autre dataframe nommé `test_df`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        test_df = df[[&#x27;Masked&#x27;, &#x27;Word_list&#x27;, &#x27;Proverb&#x27;]].copy()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Déterminer le meilleur proverbe reconstruit selon le logprob.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        test_df[&#x27;LogProb_Proverb&#x27;] = test_df.apply(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            lambda row: fill_masked_proverb(row[&#x27;Masked&#x27;], row[&#x27;Word_list&#x27;], n=n, criteria=&quot;logprob&quot;)[0], axis=1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Déterminer le meilleur proverbe reconstruit selon la perplexité.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        test_df[&#x27;Perplexity_Proverb&#x27;] = test_df.apply(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            lambda row: fill_masked_proverb(row[&#x27;Masked&#x27;], row[&#x27;Word_list&#x27;], n=n, criteria=&quot;perplexity&quot;)[0], axis=1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Créer un indicateur 1|0 si égalité ou non entre `LogProb_Proverb` et `Proverb`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        test_df[&#x27;Match_LogProb&#x27;] = test_df.apply(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            lambda row: 1 if row[&#x27;LogProb_Proverb&#x27;] == row[&#x27;Proverb&#x27;] else 0, axis=1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Créer un indicateur 1|0 si égalité ou non entre `Perplexity_Proverb` et `Proverb`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        test_df[&#x27;Match_Perplexity&#x27;] = test_df.apply(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            lambda row: 1 if row[&#x27;Perplexity_Proverb&#x27;] == row[&#x27;Proverb&#x27;] else 0, axis=1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        test_df[&#x27;Total&#x27;] = 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Afficher les résultats d&#x27;ensemble.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        print(f&quot;\n{n}-gram model:&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        print(test_df[[&#x27;Match_LogProb&#x27;, &#x27;Match_Perplexity&#x27;, &#x27;Total&#x27;]].sum())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">log_ok = False</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">test_all()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tâche-3---classification-automatique-de-descriptions-dincidents">Tâche 3 - Classification automatique de descriptions d&#x27;incidents<a href="#tâche-3---classification-automatique-de-descriptions-dincidents" class="hash-link" aria-label="Direct link to Tâche 3 - Classification automatique de descriptions d&#x27;incidents" title="Direct link to Tâche 3 - Classification automatique de descriptions d&#x27;incidents">​</a></h2>
<p>Cette tâche vise à classifier de courts textes décrivant des incidents qui se sont produits sur des chantiers de construction. Pour chaque incident, on retrouve une étiquette qui correspond au type d’incident (0 à 8).</p>
<p>Les objectifs de cette tâche sont :</p>
<ul>
<li>de se familiariser avec la classification de texte</li>
<li>d&#x27;apprendre à utiliser les fonctions de base de scikit-learn</li>
<li>de comprendre comment représenter un texte sous la forme d&#x27;un sac de mots (<em>bag of words</em>)</li>
<li>de faire l&#x27;évaluation d&#x27;un modèle de classification avec un corpus de test</li>
<li>de tenter d&#x27;interpréter les résultats d&#x27;un modèle à l&#x27;aide des poids d&#x27;attributs.</li>
</ul>
<p>Pour la première partie, vous devez construire une fonction (<em>train_and_test_classifier</em>) qui entraîne un modèle (les options étant la régression logistique et le naïf bayésien) et en faire l&#x27;évaluation sur des données d&#x27;entraînement et des données de test. Vous devez également évaluer l&#x27;impact de la lemmatisation de mots sur la performance des classificateurs. Deux fichiers de textes sont disponibles pour mener votre expérimentation (voir Section 1).</p>
<p>Pour la deuxième partie, tentez de déterminer à quoi correspond chacune des classes d’incident. Faites une analyse des poids des modèles pour proposer des étiquettes pour chacune des classes. Vous pouvez vous inspirer des notebooks disponibles sur le site du cours. Expliquez clairement comment vous êtes arrivé à vos conclusions. L’important ici est de dégager le thème principal à partir de vos observations et non pas de trouver la formulation exacte des étiquettes. Veuillez noter que certaines classes sont (très) difficiles à identifier.</p>
<p>Merci de respecter les signatures des fonctions <em>train_and_test_classifier</em> et <em>load_incident_dataset</em>.</p>
<p>Note sur la lemmatisation: Cette normalisation de texte nécessite l&#x27;utilisation d&#x27;un modèle qui repose sur l&#x27;apprentissage automatique. En conséquence, son temps d&#x27;exécution est plus long que le stemming. Si jamais cela ralentit trop vos expérimentations, il est possible de ne faire le traitement qu&#x27;une seule fois en sauvegardant les résultats après la première lemmatisation d&#x27;un fichier. Cela n&#x27;est toutefois pas exigé pour la remise de votre travail et ne sera pas évalué.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="section-1---lecture-des-fichiers-de-données">Section 1 - Lecture des fichiers de données<a href="#section-1---lecture-des-fichiers-de-données" class="hash-link" aria-label="Direct link to Section 1 - Lecture des fichiers de données" title="Direct link to Section 1 - Lecture des fichiers de données">​</a></h3>
<p>Voici les fichiers mis à votre disposition pour mener vos expérimentations. La fonction <em>load_incident_data</em> peut être utilisée pour lire les 2 fichiers (train et test). Rien à modifier dans cette section.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">train_json_fn = &quot;./data/t3_train.json&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">test_json_fn = &quot;./data/t3_test.json&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def load_incident_dataset(filename):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    with open(filename, &#x27;r&#x27;) as fp:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        incident_list = json.load(fp)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return incident_list</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">train_list = load_incident_dataset(train_json_fn)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(&quot;Nombre d&#x27;incidents:&quot;, len(train_list))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(&quot;\nUn exemple:\n&quot;, train_list[10])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">test_list = load_incident_dataset(test_json_fn)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(&quot;Nombre d&#x27;incidents&quot;, len(test_list))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">incident = test_list[10]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(&quot;\nUne description d&#x27;incident:&quot;, incident[&quot;text&quot;])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(&quot;\nSon étiquette:&quot;, incident[&quot;label&quot;])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="section-2---entraînement-et-évaluation-des-modèles">Section 2 - Entraînement et évaluation des modèles<a href="#section-2---entraînement-et-évaluation-des-modèles" class="hash-link" aria-label="Direct link to Section 2 - Entraînement et évaluation des modèles" title="Direct link to Section 2 - Entraînement et évaluation des modèles">​</a></h3>
<p>Vous pouvez ajouter tout le code dont vous avez besoin pour l&#x27;entraînement. Merci de ne pas modifier la signature de la fonction d&#x27;entraînement et de bien expliquer votre démarche et vos résultats. N&#x27;oubliez pas de faire une recommandation de modèle. Vous pouvez ajouter des cellules au notebook si nécessaire.</p>
<p>Dans cette section, je dois :</p>
<ul>
<li>construire la fonction <code>train_and_test_classifier</code> qui entraîne un modèle :<!-- -->
<ul>
<li>avec une régression logistique;</li>
<li>avec un naïf bayésien;</li>
</ul>
</li>
<li>évaluer les deux modèles sur des données d&#x27;entraînement et des données de test;</li>
<li>évaluer l&#x27;impact de la lemmatisation de mots sur la performance des classificateurs.</li>
</ul>
<p>Pour ce faire, voici ma démarche :</p>
<ul>
<li>D&#x27;abord, je charge un modèle de langue avec Spacy pour la lemmatisation de mots.</li>
<li>J&#x27;ai créé la fonction (<code>train_and_test_classifier</code>) qui réalise les opérations suivantes :<!-- -->
<ul>
<li>Création des dataframes d&#x27;entraînement (<code>X_train</code> et <code>y_train</code>) et de tests (<code>X_test</code>et <code>y_test</code>) à partir des listes de données.</li>
<li>Sélection du classifieur bayésien naif si <code>model=NB</code> ou régression logistique sinon.</li>
<li>Sélection du tokenizer de mots de NLTK si <code>normalization = &quot;word&quot;</code> ou ma fonction <code>spacy_tokenizer</code> déclarée ci-haut sinon.</li>
<li>Utilisation successive du vectorizeur <code>CountVectorizer</code> pour créer le sac de mots.</li>
<li>Utilisation de <code>GridSearchCV</code> pour trouver les meilleurs hyperparamètres avec une validation croisée 5 fois pour chaque combinaison d&#x27;hyperparamètres dans la grille de recherche.</li>
<li>Estimation des valeurs prédites sur l&#x27;ensemble d&#x27;entraînement et de test, et calcul des exactitudes.</li>
<li>Calcul de la matrice de confusion.</li>
</ul>
</li>
<li>Puis, j&#x27;ai créé une cellule qui appelle la fonction <code>train_and_test_classifier</code>
pour chaque combinaison de modèle (&#x27;NB&#x27; ou &#x27;LR&#x27;) et de normalisation (&#x27;word&#x27; ou &#x27;lemma&#x27;),
affiche les exactitudes et les matrices de confusion, ainsi que les temps d&#x27;exécution.</li>
</ul>
<p>Vous trouverez les performances obtenues ci-dessous.</p>
<p>D&#x27;abord, je charge un modèle de langue avec Spacy pour la lemmatisation de mots.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import spacy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Charger un modèle de langue.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Voir [en_core_web_sm](https://spacy.io/models/en#en_core_web_sm).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">nlp = spacy.load(&quot;en_core_web_sm&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Test.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Cette cellule sert seulement à illustrer différentes façon d&#x27;extraire les tokens ou lemmes.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">text = &quot;This tutorial is about Natural Language Processing in spaCy.&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">doc = nlp(text)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(f&quot;Option 1: {[token.text for token in doc]}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(f&quot;Option 2: {[token.lemma_ for token in doc]}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(f&quot;Option 3: {[token.lemma_ for token in doc if not token.is_stop]}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(f&quot;Option 4: {[token.lemma_ for token in doc if not token.is_stop and token.is_alpha]}&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Option 1: [&#x27;This&#x27;, &#x27;tutorial&#x27;, &#x27;is&#x27;, &#x27;about&#x27;, &#x27;Natural&#x27;, &#x27;Language&#x27;, &#x27;Processing&#x27;, &#x27;in&#x27;, &#x27;spaCy&#x27;, &#x27;.&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Option 2: [&#x27;this&#x27;, &#x27;tutorial&#x27;, &#x27;be&#x27;, &#x27;about&#x27;, &#x27;Natural&#x27;, &#x27;Language&#x27;, &#x27;Processing&#x27;, &#x27;in&#x27;, &#x27;spaCy&#x27;, &#x27;.&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Option 3: [&#x27;tutorial&#x27;, &#x27;Natural&#x27;, &#x27;Language&#x27;, &#x27;Processing&#x27;, &#x27;spaCy&#x27;, &#x27;.&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Option 4: [&#x27;tutorial&#x27;, &#x27;Natural&#x27;, &#x27;Language&#x27;, &#x27;Processing&#x27;, &#x27;spaCy&#x27;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Définir une fonction de tokenizer personnalisée avec lemmatisation.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Définir une fonction de tokenizer personnalisée utilisant le vocabulaire téléchargé précédemment.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def spacy_tokenizer(text):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    doc = nlp(text)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    tokens = [token.lemma_ for token in doc if not token.is_stop and token.is_alpha]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return tokens</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Test.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Cette cellule sert seulement à illustrer comment ma fonction découpe une phrase en lemmes.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">text = &quot;This tutorial is about Natural Language Processing in spaCy.&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tokens = spacy_tokenizer(text)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(tokens)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Test.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Présenter un tableau de fréquence du label.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df = pd.DataFrame.from_dict(train_list)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">count = df[&#x27;label&#x27;].value_counts()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(count)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Test.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Cette cellule découpe les 5 premières phrases.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df = pd.DataFrame.from_dict(train_list).head(5)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df[&#x27;tokens&#x27;] = df[&#x27;text&#x27;].apply(spacy_tokenizer)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for index, row in df.iterrows():</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    print(f&quot;Index: {index}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    print(f&quot;Text (100 premiers caractères): {row[&#x27;text&#x27;][:100]}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    print(f&quot;Tokens (10 premiers): {row[&#x27;tokens&#x27;][:10]}&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Définir la fonction <code>train_and_test_classifier</code>.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Importer ici les librairies dont vous avez besoin</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from nltk.tokenize import word_tokenize</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.naive_bayes import MultinomialNB</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.linear_model import LogisticRegression</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.model_selection import GridSearchCV</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn import metrics</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn import model_selection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.feature_extraction.text import CountVectorizer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.metrics import confusion_matrix</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def train_and_test_classifier(train_fn, test_fn, model=&#x27;NB&#x27;, normalization=&#x27;words&#x27;):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    :param train_fn et test_fn: les 2 fichiers utilisées pour entraîner et tester les classificateurs.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    :param model: le type de classificateur. NB = Naive Bayes, LR = Régression logistique.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    :param normalization: la normalisation appliquée aux mots des descriptions</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                 - &#x27;word&#x27;: les mots des textes sans normalization.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                 - &#x27;lemma&#x27;: les lemmes des mots obtenus par lemmatisation avec Spacy.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    :return: un dictionnaire contenant 3 valeurs:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                 - l&#x27;accuracy à l&#x27;entraînement (validation croisée)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                 - l&#x27;accuracy sur le jeu de test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                 - la matrice de confusion calculée par scikit-learn sur les données de test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Votre code...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Lire les fichiers et créer des listes.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    train_list = load_incident_dataset(train_json_fn)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    test_list = load_incident_dataset(test_json_fn)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Créer les dataframes pandas.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    train_df = pd.DataFrame.from_dict(train_list).astype({&#x27;label&#x27;: &#x27;int32&#x27;})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    test_df = pd.DataFrame.from_dict(test_list).astype({&#x27;label&#x27;: &#x27;int32&#x27;})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Créer les dataframes d&#x27;entraînement et de test.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    X_train = train_df[&#x27;text&#x27;]    # Ensemble d&#x27;entraînement.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y_train = train_df[&#x27;label&#x27;]   # Étiquettes de l&#x27;ensemble d&#x27;entraînement.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    X_test = test_df[&#x27;text&#x27;]      # Ensemble de test.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y_test = test_df[&#x27;label&#x27;]     # Étiquettes de l&#x27;ensemble de test.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Sélectionner le classifieur.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if model == &#x27;NB&#x27;:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Sélectionner le classifieur bayésien naïf multinomial et définir la grille de paramètres.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        estimator = MultinomialNB()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        param_grid = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;alpha&#x27;: [0.01, 0.1, 0.5, 1.0, 10.0],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;fit_prior&#x27;: [True, False]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    else:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Sélectionner la régression logistique et définir la grille de paramètres.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        estimator = LogisticRegression(max_iter=200)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        param_grid = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;penalty&#x27;: [&#x27;l1&#x27;, &#x27;l2&#x27;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &#x27;C&#x27;: [0.001, 0.01, 0.1, 1, 10, 100, 1000]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Sélectionner la normalisation.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if normalization == &#x27;word&#x27;:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Utiliser le tokenizeur de mots de NLTK.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        tokenizer = word_tokenize</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    else:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Utiliser notre tokenizer avec lemmatisation avec Spacy.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        tokenizer = spacy_tokenizer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Instancier le vectorizeur.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Le vectorizeur permet de convertir les textes en sac de mots (vecteurs de compte).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    vectorizer = CountVectorizer(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        lowercase=True,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        tokenizer=tokenizer,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        token_pattern=None</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Apprendre le vocabulaire.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    vectorizer.fit(X_train)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Transformer les textes d&#x27;entraînement et de test.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    X_train_vectorized = vectorizer.transform(X_train)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    X_test_vectorized = vectorizer.transform(X_test)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Entrainer le modèle.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    clf = GridSearchCV(estimator, param_grid, cv=5)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    clf.fit(X_train_vectorized, y_train)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Afficher les meilleurs paramètres selon GridSearchCV.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    print(f&quot;clf.best_params_={clf.best_params_}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Récupérer l&#x27;exactitude moyenne de validation croisée du meilleur modèle à partir de GridSearchCV.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    accuracy_train = clf.best_score_</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Calculer les valeurs prédites sur l&#x27;ensemble de test et calculer l&#x27;exactitude.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y_pred = clf.predict(X_test_vectorized)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    accuracy_test = metrics.accuracy_score(y_test, y_pred)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Matrice de confusion obtenue sur l&#x27;ensemble de test.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    cm = confusion_matrix(y_test, y_pred)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Les résultats à retourner</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    results = dict()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    results[&#x27;accuracy_train&#x27;] = accuracy_train</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    results[&#x27;accuracy_test&#x27;] = accuracy_test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    results[&#x27;confusion_matrix&#x27;] = cm # la matrice de confusion obtenue de Scikit-learn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return results</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Créer une version graphique de la matrice de confusion. Ce code vient d&#x27;un notebook provenant du site du cours.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import seaborn as sns</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import matplotlib.pyplot as plt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">%matplotlib inline</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">%config InlineBackend.figure_format =&#x27;retina&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Affichage graphique plus informatif avec Seaborne</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def display_confusion_matrix(confusion_matrix, classes):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    print(&quot;\nVersion graphique de la matrice de confusion&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    df_cm = pd.DataFrame(confusion_matrix, index=classes, columns=classes)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    f, ax = plt.subplots(figsize=(7, 5))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    sns.heatmap(df_cm, annot=True, fmt=&quot;d&quot;, linewidths=.5, ax=ax)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    plt.ylabel(&#x27;Vrai étiquette &#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    plt.xlabel(&#x27;Étiquette prédite&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    plt.show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Le code ci-dessous appelle la fonction <code>train_and_test_classifier</code> 4 fois, c&#x27;est-à-dire pour chaque combinaison de <code>model</code>et de <code>normalization</code>.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for model in [&#x27;NB&#x27;, &#x27;LR&#x27;]:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    for normalization in [&#x27;word&#x27;, &#x27;lemma&#x27;]:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Temps de départ.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        start = time.time()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Imprimer les paramètres du modèle.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        print(f&quot;\nParamètres: model={model}, normalization={normalization}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Entraîner le modèle en fonction du modèle et de la normalisation.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        results = train_and_test_classifier(train_json_fn, test_json_fn, model=model, normalization=normalization)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Afficher les exactitudes sur données entrainement et test, et matrice de confusion.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        print(f&quot;Exactitude: accuracy_train={results[&#x27;accuracy_train&#x27;]:.3f}, accuracy_test={results[&#x27;accuracy_test&#x27;]:.3f}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        cm = results[&#x27;confusion_matrix&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        print(&quot;Matrice de confusion\n&quot;, cm)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Afficher la version graphique de la matrice de confusion.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        classes = list(range(9))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        display_confusion_matrix(cm, classes)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Afficher le temps d&#x27;exécution.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        elapsed_time = time.time() - start</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        print(f&quot;Temps d&#x27;exécution = {elapsed_time:.3f} sec.&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="png" src="/assets/images/output_22_1-bf37cc0b62ea9801c3943c01d04c3c7b.png" width="1161" height="901" class="img_ev3q"></p>
<p><img loading="lazy" alt="png" src="/assets/images/output_22_3-75cef49421b47512629f378f1af9ec55.png" width="1161" height="901" class="img_ev3q"></p>
<p><img loading="lazy" alt="png" src="/assets/images/output_22_8-8abc8c2186995dd1f8414e6a64b4d0d7.png" width="1161" height="901" class="img_ev3q"></p>
<p><img loading="lazy" alt="png" src="/assets/images/output_22_12-ffbaa40034a7c96eb06e50b8fa8cb74f.png" width="1161" height="901" class="img_ev3q"></p>
<p>Avec mon MacBook Pro M1 16 Go, et les librairies énumérées au début du présent notebook avec leur version,
j&#x27;obtiens les résultats suivants :</p>
<table><thead><tr><th>Modèle</th><th>Normalisation</th><th style="text-align:right">Exactitude sur ensemble d&#x27;entraîenemnt</th><th style="text-align:right">Exactitude sur ensemble de test</th><th style="text-align:right">Temps d&#x27;exécution</th><th><code>clf.best_params</code> du GridSearch</th></tr></thead><tbody><tr><td>NB</td><td>word</td><td style="text-align:right">0.732</td><td style="text-align:right">0.724</td><td style="text-align:right">3.122</td><td>&#x27;alpha&#x27;: 0.1, &#x27;fit_prior&#x27;: True</td></tr><tr><td>NB</td><td>lemma</td><td style="text-align:right">0.731</td><td style="text-align:right">0.734</td><td style="text-align:right">146.742</td><td>&#x27;alpha&#x27;: 0.5, &#x27;fit_prior&#x27;: True</td></tr><tr><td>LR</td><td>word</td><td style="text-align:right">0.720</td><td style="text-align:right">0.723</td><td style="text-align:right">66.386</td><td>&#x27;C&#x27;: 0.1, &#x27;penalty&#x27;: &#x27;l2&#x27;</td></tr><tr><td>LR</td><td>lemma</td><td style="text-align:right">0.739</td><td style="text-align:right">0.739</td><td style="text-align:right">176.221</td><td>&#x27;C&#x27;: 0.1, &#x27;penalty&#x27;: &#x27;l2&#x27;</td></tr></tbody></table>
<p>Avec ces résultats, je constate que :</p>
<ul>
<li>la régression logistique (LR) n&#x27;est pas significativement plus performante que le bayésien naif (NB) sur l&#x27;ensemble de test;</li>
<li>la lemmatisation avec Spacy (lemma) améliore légèrement les résultats par rapport au découpage des mots sans normalisation (word);</li>
<li>la lemmatisation avec Spacy (lemma) prend beaucoup plus de temps que le découpage en mots sans normalisation (word).</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="section-3---à-quoi-correspondent-les-classes-explicabilité-du-modèle">Section 3 - À quoi correspondent les classes? Explicabilité du modèle<a href="#section-3---à-quoi-correspondent-les-classes-explicabilité-du-modèle" class="hash-link" aria-label="Direct link to Section 3 - À quoi correspondent les classes? Explicabilité du modèle" title="Direct link to Section 3 - À quoi correspondent les classes? Explicabilité du modèle">​</a></h3>
<p>En utilisant les poids des modèles, tentez d&#x27;attribuer une signification aux différentes classes. Comme c&#x27;est une épreuve d&#x27;analyse de données, il est possible que certaines classes ne soient pas interprétables. Vous n&#x27;êtes pas tenu à l&#x27;impossible. L&#x27;important est d&#x27;utiliser ce qu&#x27;on observe dans les modèles pour fournir une explication.</p>
<p>Vous pouvez ajouter tout le code et toutes les cellules dont vous avez besoin.</p>
<p>Pour réaliser cette section, j&#x27;effectue les étapes suivantes :</p>
<ul>
<li>Étape 1<!-- -->
<ul>
<li>Lire le fichier <code>train_json_fn</code> et créer des dataframes pandas avec l&#x27;ensemble d&#x27;entraînement.</li>
</ul>
</li>
<li>Étape 2<!-- -->
<ul>
<li>Créer un sac de mots avec le vectorizer <code>CountVectorizer</code> et la fonction <code>spacy_tokenizer</code> pour faire la lemmatisation des mots avec Spacy.</li>
<li>Apprendre le vocabulaire.</li>
<li>Transformer le texte de l&#x27;ensemble d&#x27;entraînement.</li>
<li>Obtenir les tokens du vectorizer.</li>
</ul>
</li>
<li>Étape 3<!-- -->
<ul>
<li>Entraîner le modèle avec une régression logistique et les meilleurs paramètres trouvés précédemment.</li>
</ul>
</li>
<li>Étape 4<!-- -->
<ul>
<li>Parcourir chacun des labels et trouver les mots les plus importants pour chacun d&#x27;eux.</li>
<li>Récupérer les coefficients de la régression logistique pour cette classe.</li>
<li>Trier les mots par poids décroissant et obtenir les indices des 50 premiers mots.</li>
<li>Mapper les indices aux mots du vecteur &quot;tokens&quot;</li>
<li>Afficher les mots les plus importants pour chaque label.</li>
</ul>
</li>
</ul>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Étape 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Lire le fichier `train_json_fn`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">train_list = load_incident_dataset(train_json_fn)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Créer des dataframes pandas.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">train_df = pd.DataFrame.from_dict(train_list).astype({&#x27;label&#x27;: &#x27;int32&#x27;})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X_train = train_df[&#x27;text&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">y_train = train_df[&#x27;label&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Étape 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Utiliser notre tokenizer avec lemmatisation avec Spacy.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tokenizer = spacy_tokenizer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Instancier le vectorizeur.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Le vectorizeur permet de convertir les textes en sac de mots (vecteurs de compte).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vectorizer = CountVectorizer(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    lowercase=True,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    tokenizer=tokenizer,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    token_pattern=None</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Apprendre le vocabulaire.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vectorizer.fit(X_train)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Transformer les textes d&#x27;entraînement et de test.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X_train_vectorized = vectorizer.transform(X_train)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Obtenir les tokens du vectorizer.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tokens = vectorizer.get_feature_names_out()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Étape 3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Utiliser la classifieur de régression logistique avec les meilleurs paramètres trouvés précédemment.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">clf = LogisticRegression(max_iter=200, C=0.01, penalty=&#x27;l2&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Entrainer le modèle.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">clf.fit(X_train_vectorized, y_train)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Étape 4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Parcourir chacun des labels et trouver les mots les plus importants pour chacun d&#x27;eux.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">unique_labels = sorted(y_train.unique())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for label in unique_labels:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Récupérer les coefficients de la régression logistique pour cette classe.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    coefficients = clf.coef_[label]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Triez les mots par poids décroissant et obtenir les indices des 50 premiers mots.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    top_word_indices = coefficients.argsort()[::-1][:50]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Mapper les indices aux mots du vecteur &quot;tokens&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    top_words = [tokens[i] for i in top_word_indices]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Imprimer.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    print(f&quot;\nLabel={label}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    print(f&quot;TopWords={top_words}&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/courses/ift-7022/travail-1.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/courses/ift-7022/week-13"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">13 Deep NLP - Introduction aux LLMs, prompting et instruct tuning</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/courses/ift-7022/travail-2"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Travail pratique 2</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tâche-1---extraire-des-informations-dun-document-à-laide-dexpressions-régulières" class="table-of-contents__link toc-highlight">Tâche 1 - Extraire des informations d&#39;un document à l&#39;aide d&#39;expressions régulières</a><ul><li><a href="#section-1---lecture-du-fichier-doffre-de-cours" class="table-of-contents__link toc-highlight">Section 1 - Lecture du fichier d&#39;offre de cours</a></li><li><a href="#section-2---extraction-des-informations-de-cours-à-partir-du-fichier" class="table-of-contents__link toc-highlight">Section 2 - Extraction des informations de cours à partir du fichier</a></li><li><a href="#section-3---visualisation-des-résultats-de-lextraction-dinformations" class="table-of-contents__link toc-highlight">Section 3 - Visualisation des résultats de l&#39;extraction d&#39;informations</a></li><li><a href="#section-4---évaluation-de-performance" class="table-of-contents__link toc-highlight">Section 4 - Évaluation de performance</a></li></ul></li><li><a href="#tâche-2---comme-le-disait-le-proverbe---les-bons-mots-pour-le-dire" class="table-of-contents__link toc-highlight">Tâche 2 - Comme le disait le proverbe - les bons mots pour le dire</a><ul><li><a href="#section-1---lecture-des-fichiers-de-données-proverbes-et-tests" class="table-of-contents__link toc-highlight">Section 1 - Lecture des fichiers de données (proverbes et tests)</a></li><li><a href="#section-2---code-pour-substituer-les-masques-étoiles-par-des-mots" class="table-of-contents__link toc-highlight">Section 2 - Code pour substituer les masques (étoiles) par des mots</a></li><li><a href="#section-3---construction-des-modèles-de-langue-n-grammes" class="table-of-contents__link toc-highlight">Section 3 - Construction des modèles de langue N-grammes</a></li><li><a href="#section-4---compléter-un-proverbe" class="table-of-contents__link toc-highlight">Section 4 - Compléter un proverbe</a></li><li><a href="#section-5---expérimentations-et-analyse-de-vos-résultats" class="table-of-contents__link toc-highlight">Section 5 - Expérimentations et analyse de vos résultats</a></li></ul></li><li><a href="#tâche-3---classification-automatique-de-descriptions-dincidents" class="table-of-contents__link toc-highlight">Tâche 3 - Classification automatique de descriptions d&#39;incidents</a><ul><li><a href="#section-1---lecture-des-fichiers-de-données" class="table-of-contents__link toc-highlight">Section 1 - Lecture des fichiers de données</a></li><li><a href="#section-2---entraînement-et-évaluation-des-modèles" class="table-of-contents__link toc-highlight">Section 2 - Entraînement et évaluation des modèles</a></li><li><a href="#section-3---à-quoi-correspondent-les-classes-explicabilité-du-modèle" class="table-of-contents__link toc-highlight">Section 3 - À quoi correspondent les classes? Explicabilité du modèle</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Alain Boisvert. Construit avec Docusaurus.</div></div></div></footer></div>
</body>
</html>