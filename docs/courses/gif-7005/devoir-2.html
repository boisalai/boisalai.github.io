<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-courses/gif-7005/devoir-2" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">Devoir 2 du 18 octobre 2023 | Alain Boisvert</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://boisalai.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://boisalai.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://boisalai.github.io/docs/courses/gif-7005/devoir-2"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Devoir 2 du 18 octobre 2023 | Alain Boisvert"><meta data-rh="true" name="description" content="L&#x27;URL de téléchargement des datasets..."><meta data-rh="true" property="og:description" content="L&#x27;URL de téléchargement des datasets..."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://boisalai.github.io/docs/courses/gif-7005/devoir-2"><link data-rh="true" rel="alternate" href="https://boisalai.github.io/docs/courses/gif-7005/devoir-2" hreflang="en"><link data-rh="true" rel="alternate" href="https://boisalai.github.io/docs/courses/gif-7005/devoir-2" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Alain Boisvert RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Alain Boisvert Atom Feed">



<link rel="stylesheet" href="/fonts/font-awesome/fontawesome.css">
<link rel="stylesheet" href="/fonts/font-awesome/solid.css">
<link rel="stylesheet" href="/fonts/font-awesome/regular.css">
<link rel="stylesheet" href="/fonts/font-awesome/brands.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.2dcfce69.css">
<script src="/assets/js/runtime~main.7e1e92b9.js" defer="defer"></script>
<script src="/assets/js/main.e46baa82.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Alain Boisvert</b></a><a class="navbar__item navbar__link" target="" href="/docs/courses/ift-7022">IFT-7022</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" target="" href="/docs/courses/gif-7005">GIF-7005</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/boisalai" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link fa-brands fa-github"> </a><a href="https://www.linkedin.com/in/alain-boisvert-98b058156/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link fa-brands fa-linkedin-in"> </a><a href="mailto:ay.boisvert@gmail.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link fa-solid fa-envelope"> </a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Alain Boisvert</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cv">Curriculum vitæ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/learning">Learning path</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/certificates">Certificates</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/courses">Courses</a><button aria-label="Collapse sidebar category &#x27;Courses&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/courses/gif-7005">GIF-7005 Introduction à l&#x27;apprentissage automatique</a><button aria-label="Collapse sidebar category &#x27;GIF-7005 Introduction à l&#x27;apprentissage automatique&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/week-01">Semaine 1 Introduction à l&#x27;apprentissage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/week-02">Semaine 2 Méthodes paramétriques</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/week-03">Semaine 3 Méthodes multivariées</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/week-04">Semaine 4 Méthodes non paramétriques</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/week-05">Semaine 5 Discriminants linéaires</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/week-06">Semaine 6 Méthodes à noyau</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/week-07">Semaine 7 Perceptron multicouche</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/week-08">Semaine 8 Apprentissage profond</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/week-10">Semaine 10 Réseau de neurones à convolution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/week-11">Semaine 11 Méthodes par ensembles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/week-12">Semaine 12 Prétraitements et analyse de données</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/week-13">Semaine 13 Clustering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/devoir-1">Devoir 1 du 4 octobre 2023</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/courses/gif-7005/devoir-2">Devoir 2 du 18 octobre 2023</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/devoir-3">Devoir 3 du 8 novembre 2023</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/devoir-4">Devoir 4 du 22 novembre 2023</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/devoir-5">Devoir 5 du 8 décembre 2023</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/quiz-1">Quiz 1 du 27 septembre 2023</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/quiz-2">Quiz 2 du 11 octobre 2023</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/quiz-3">Quiz 3 du 25 octobre 2023</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/quiz-4">Quiz 4 du 15 novembre 2023</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/examen-2022">Examen final 2022</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/examen-2019">Examen final 2019</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/examen-2018">Examen final 2018</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/examen-2017">Examen final 2017</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/examen-2016">Examen final 2016</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/gif-7005/projet">Projet</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/courses/ift-7022">IFT-7022 Traitement automatique de la langue naturelle</a><button aria-label="Expand sidebar category &#x27;IFT-7022 Traitement automatique de la langue naturelle&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/chatgpt-building-systems">Building Systems with the ChatGPT API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/chatgpt-prompt-engineering">ChatGPT Prompt Engineering for Developers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item hidden"><a class="menu__link" tabindex="0" href="/docs/courses/fine-tuning-llms">Training and fine-tuning LLMs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/langchain-1">LangChain for LLM Application Development</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/pair-prog-with-llm">Pair Programming with a Large Language Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/courses/chat-with-your-data">LangChain Chat with Your Data</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/references">References</a><button aria-label="Expand sidebar category &#x27;References&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/code-snippets">Code Snippets</a><button aria-label="Expand sidebar category &#x27;Code Snippets&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/courses"><span itemprop="name">Courses</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/courses/gif-7005"><span itemprop="name">GIF-7005 Introduction à l&#x27;apprentissage automatique</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Devoir 2 du 18 octobre 2023</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Devoir 2 du 18 octobre 2023</h1>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>L&#x27;URL de téléchargement des datasets...</p><p>Il faut remplacer le chemin <code>/pax/shared/GIF-4101-7005/</code> par <code>https://pax.ulaval.ca/static/GIF-4101-7005/fichiers/</code> pour en faire un URL.</p><p>Par exemple, si vous voulez télécharger le fichier <code>/pax/shared/GIF-4101-7005/d2q2_datasets/public1/features.npy</code>, l&#x27;URL correspondant
sera <code>https://pax.ulaval.ca/static/GIF-4101-7005/fichiers/d2q2_datasets/public1/features.npy</code>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="d2q1---estimation-de-densité">D2Q1 - Estimation de densité<a href="#d2q1---estimation-de-densité" class="hash-link" aria-label="Direct link to D2Q1 - Estimation de densité" title="Direct link to D2Q1 - Estimation de densité">​</a></h2>
<p>Soit une densité-mélange combinant deux lois normales en une dimension,</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="bold">Σ</mi><mi>i</mi></msub><mi>P</mi><mo stretchy="false">(</mo><msub><mi mathvariant="script">G</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><msub><mi mathvariant="script">G</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>π</mi><mn>1</mn></msub><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><msub><mi>μ</mi><mn>1</mn></msub><mo separator="true">,</mo><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mo stretchy="false">)</mo><mo>+</mo><msub><mi>π</mi><mn>2</mn></msub><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><msub><mi>μ</mi><mn>2</mn></msub><mo separator="true">,</mo><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x) = \boldsymbol{\Sigma}_i P(\mathcal{G}_i) p(x|\mathcal{G}_i) = \pi_1 \mathcal{N}(\mu_1,\sigma_1^2) + \pi_2 \mathcal{N}(\mu_2,\sigma_2^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">Σ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right:0.0593em">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0593em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">∣</span><span class="mord"><span class="mord mathcal" style="margin-right:0.0593em">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0593em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathcal" style="margin-right:0.14736em">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathcal" style="margin-right:0.14736em">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
<p>où <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mn>1</mn></msub><mo>=</mo><mn>0.4</mn><mo separator="true">,</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn><mo separator="true">,</mo><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mo>=</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>π</mi><mn>2</mn></msub><mo>=</mo><mn>0.6</mn><mo separator="true">,</mo><msub><mi>μ</mi><mn>2</mn></msub><mo>=</mo><mn>5</mn><mo separator="true">,</mo><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\pi_1=0.4, \mu_1=0, \sigma_1^2=1, \pi_2=0.6, \mu_2=5, \sigma_2^2=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em"></span><span class="mord">0.4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0622em;vertical-align:-0.2481em"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em"></span><span class="mord">0.6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0622em;vertical-align:-0.2481em"></span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span>.  La tracé suivant illustre cette densité-mélange dans le domaine <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><mn>5</mn><mo separator="true">,</mo><mn>10</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[−5, 10]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">10</span><span class="mclose">]</span></span></span></span>.</p>
<p><img loading="lazy" alt="fig1" src="/assets/images/mixture-89a2bb2c99668c1325f11eeae607e845.png" width="1039" height="794" class="img_ev3q"></p>
<p>La fonction <code>pdf</code> donnée dans le code préambule ici-bas permet d&#x27;obtenir la valeur de cette densité pour des valeurs <code>x</code> données.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="code-préambule">Code préambule<a href="#code-préambule" class="hash-link" aria-label="Direct link to Code préambule" title="Direct link to Code préambule">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import numpy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import matplotlib</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">%matplotlib inline</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">matplotlib.rcParams[&#x27;figure.figsize&#x27;] = (15.0, 10.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from matplotlib import pyplot</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.neighbors import KernelDensity</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from scipy.stats import norm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">_times = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def checkTime(maxduration, question):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    duration = _times[-1] - _times[-2]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if duration &gt; maxduration:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        print(&quot;[ATTENTION] Votre code pour la question {0} met trop de temps à s&#x27;exécuter! &quot;.format(question)+</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Le temps maximum permis est de {0:.4f} secondes, mais votre code a requis {1:.4f} secondes! &quot;.format(maxduration,duration)+</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Assurez-vous que vous ne faites pas d&#x27;appels bloquants (par exemple à show()) dans cette boucle!&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Définition de la fonction de densité de probabilité (PDF) de la densité-mélange</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Definition of the mixture model probability density function</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def pdf(X):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return 0.4 * norm(0, 1).pdf(X[:, 0]) + 0.6 * norm(5, 1).pdf(X[:, 0])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q1a---question">Q1A - Question<a href="#q1a---question" class="hash-link" aria-label="Direct link to Q1A - Question" title="Direct link to Q1A - Question">​</a></h3>
<p>Complétez la fonction <code>sample(n)</code> dans le patron de code ici-bas afin d&#x27;échantillonner des données
de cette densité, où <code>n</code> correspond au nombre de données à échantillonner.</p>
<p>Présentez également deux figures, montrant respectivement 50 et 10 000 données échantillonnées
de cette distribution, sous la forme d&#x27;histogrammes de 25 compartiments dans le domaine <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><mn>5</mn><mo separator="true">,</mo><mn>10</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[−5,10]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">10</span><span class="mclose">]</span></span></span></span>.</p>
<p>Sur ces figures, affichez également la fonction de densité réelle pour permettre d&#x27;en comparer
la forme avec celles des distributions d&#x27;échantillons obtenues.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q1a---solution">Q1A - Solution<a href="#q1a---solution" class="hash-link" aria-label="Direct link to Q1A - Solution" title="Direct link to Q1A - Solution">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Durée maximale d&#x27;exécution pour la question</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Maximum execution time for this question</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">TMAX_Q1A = 1.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># *** TODO Q1A ***</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Complétez la fonction sample(n), qui génère n</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># données suivant la distribution mentionnée dans l&#x27;énoncé</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Complete the function sample(n), which generates n</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># instances according to the distribution mentioned in the statement</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def sample(n):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # L&#x27;objectif ici est d&#x27;échantillonner à partir des deux gaussiennes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # en respectant les probabilités $\pi_1$ et $\pi_2$.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # L&#x27;approche utilisée pour sample(n) est basée sur l&#x27;idée d&#x27;échantillonner</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # des données d&#x27;une distribution de mélange de gaussiennes. Pour simplifier,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # on peut voir une distribution de mélange comme une &quot;combinaison&quot; de plusieurs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # distributions, chacune avec une certaine probabilité.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Les probabilités associées à chaque gaussienne sont $\pi_1 = 0.4$ et</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # $\pi_2 = 0.6$ respectivement. Cela signifie qu&#x27;un échantillon pris au</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # hasard a une probabilité de 0.4 de provenir de la première gaussienne</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # et une probabilité de 0.6 de provenir de la seconde gaussienne.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Étape 1: Échantillonner une variable z à partir d&#x27;une distribution</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # de Bernoulli avec la probabilité p = $\pi_1$. La valeur 0.4 est utilisée</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # pour respecter la probabilité de la première composante de la distribution</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # de mélange lors de l&#x27;échantillonnage.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    z = numpy.random.binomial(1, 0.4, n)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Étape 2: Échantillonner x en fonction de z</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Si z = 1, échantillonner x à partir de $\mathcal{N}(\mu_1,\sigma_1^2)$,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # sinon échantillonner x à partir de $\mathcal{N}(\mu_2,\sigma_2^2)$.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    samples = numpy.where(z, numpy.random.normal(0, 1, n), numpy.random.normal(5, 1, n))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return samples.reshape(-1, 1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># ******</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">_times.append(time.time())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># *** TODO Q1A ***</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Échantillonnez 50 et 10 000 données avec la fonction</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># sample(n) que vous avez définie plus haut.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Sample 50 and 10,000 instances with the sample(n) function</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># that you defined above.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Échantillonnez 50 et 10 000 données avec la fonction</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">samples_50 = sample(50)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">samples_10000 = sample(10000)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># ******</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># *** TODO Q1A ****</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Tracez l&#x27;histogramme de cette distribution échantillonnée pour</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 50 et 10 000 données, en utilisant 25 compartiments, dans le domaine [-5, 10].</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Sur les mêmes graphiques, tracez également la fonction de densité réelle.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Plot the histogram of this sample distribution for 50 and 10,000 samples</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># using 25 bins over the [-5, 10] domain.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># On these plots, display the real density function.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Tracez l&#x27;histogramme de cette distribution échantillonnée</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X = numpy.linspace(-5, 10, 1000).reshape(-1, 1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">true_density = pdf(X)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Créez une figure et des axes côte-à-côte</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.figure(figsize=(15,6))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Histogramme pour 50 échantillons</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.subplot(1, 2, 1)  # 1 row, 2 columns, first plot</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.hist(samples_50, bins=25, range=[-5, 10], density=True, alpha=0.6, label=&quot;Echantillons (n=50)&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.plot(X, true_density, &#x27;r&#x27;, label=&quot;Densité réelle&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.legend()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.title(&quot;Histogramme pour 50 échantillons&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Histogramme pour 10 000 échantillons</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.subplot(1, 2, 2)  # 1 row, 2 columns, second plot</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.hist(samples_10000, bins=25, range=[-5, 10], density=True, alpha=0.6, label=&quot;Echantillons (n=10000)&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.plot(X, true_density, &#x27;r&#x27;, label=&quot;Densité réelle&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.legend()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.title(&quot;Histogramme pour 10 000 échantillons&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># ******</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">_times.append(time.time())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">checkTime(TMAX_Q1A, &quot;Q1A&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="png" src="/assets/images/output_6_0-549d099a189d97be9c2fc5433303238d.png" width="1222" height="528" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q1b-question">Q1B Question<a href="#q1b-question" class="hash-link" aria-label="Direct link to Q1B Question" title="Direct link to Q1B Question">​</a></h3>
<p>Montrez maintenant le résultat d&#x27;une estimation avec un noyau <em>Boxcar</em> (réf. Estimation naïve d&#x27;histogramme dans les documents du cours), également connu sous le nom de <em>noyau tophat</em>, à partir des échantillons de données de la densité-mélange de la question précédente (50 et 10 000 données), pour les tailles de noyaux (<em>bandwidth</em>) de  <!-- -->5<!-- -->.</p>
<p>Présentez vos résultats en deux figures, une pour les résultats sur 50 données et l&#x27;autre pour les résultats sur 10 000 données;
Utilisez une couleur de courbe différente pour chaque taille de noyau;
Ajoutez une légende à vos figures.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q1b-solution">Q1B Solution<a href="#q1b-solution" class="hash-link" aria-label="Direct link to Q1B Solution" title="Direct link to Q1B Solution">  ​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">TMAX_Q1B = 2.5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">_times.append(time.time())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># ** TODO Q1B ***</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># À partir des échantillons 50 et 10 000 données de la question précédente</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># faites une estimation de la distribution des données avec un noyau boxcar.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Pour chaque taille de jeu (50 et 10 000), présentez les distributions</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># estimées avec des tailles de noyau (bandwidth) de {0.3, 1, 2, 5}, dans</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># la même figure, mais tracées avec des couleurs différentes.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># From the 50 and 10,000 data samples in the previous question</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># make an estimate of the distribution of the data with a boxcar kernel.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># For each set size (50 and 10,000), present the distributions</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># estimated with kernel sizes (bandwidth) of {0.3, 1, 2, 5}, in</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># the same figure, but plotted with different colours.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Tailles de noyau (bandwidths) à évaluer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bandwidths = [0.3, 1, 2, 5]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Créer une gamme de valeurs pour évaluer la densité</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X_plot = numpy.linspace(-5, 10, 1000)[:, numpy.newaxis]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Estimation et tracé pour 50 données</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.figure(figsize=(15, 6))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for bandwidth in bandwidths:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Estimation de la densité avec KernelDensity</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    kde = KernelDensity(kernel=&#x27;tophat&#x27;, bandwidth=bandwidth).fit(samples_50)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    log_dens = kde.score_samples(X_plot)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pyplot.subplot(1, 2, 1)  # 1 row, 2 columns, first plot</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pyplot.plot(X_plot[:, 0], numpy.exp(log_dens), label=&#x27;bandwidth={}&#x27;.format(bandwidth))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.title(&quot;Estimation avec noyau Boxcar pour 50 échantillons&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.legend()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Estimation et tracé pour 10 000 données</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for bandwidth in bandwidths:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Estimation de la densité avec KernelDensity</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    kde = KernelDensity(kernel=&#x27;tophat&#x27;, bandwidth=bandwidth).fit(samples_10000)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    log_dens = kde.score_samples(X_plot)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pyplot.subplot(1, 2, 2)  # 1 row, 2 columns, second plot</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pyplot.plot(X_plot[:, 0], numpy.exp(log_dens), label=&#x27;bandwidth={}&#x27;.format(bandwidth))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.title(&quot;Estimation avec noyau Boxcar pour 10 000 échantillons&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.legend()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># ******</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Affichage du graphique</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Plot the graph</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">_times.append(time.time())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">checkTime(TMAX_Q1B, &quot;Q1B&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.show()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="png" src="/assets/images/output_9_0-e11d8f6a8d224c9b26612bdcb775bb87.png" width="1222" height="528" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q1c-question">Q1C Question<a href="#q1c-question" class="hash-link" aria-label="Direct link to Q1C Question" title="Direct link to Q1C Question">​</a></h3>
<p>Expliquez les principales <strong>différences</strong> et <strong>similarités</strong> entre une estimation de densité par noyau
et une approche d&#x27;estimation de densité basée sur les <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-plus proches voisins (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>PPV).</p>
<p>Aussi, quel lien peut-on faire entre eux?</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q1c-solution">Q1C Solution<a href="#q1c-solution" class="hash-link" aria-label="Direct link to Q1C Solution" title="Direct link to Q1C Solution">​</a></h3>
<p><strong>Différences</strong> :</p>
<ol>
<li><strong>Estimation locale versus globale</strong> : L&#x27;estimation par noyau est une méthode de pondération globale, car chaque point de l&#x27;ensemble de données contribue (dans une certaine mesure) à l&#x27;estimation de la densité en tout autre point. En revanche, le <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-PPV est une méthode de pondération locale, car seule une partie fixe (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> points) contribue à l&#x27;estimation en un point donné.</li>
<li><strong>Complexité algorithmique</strong> : Pour le <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-PPV, l&#x27;estimation de la densité nécessite la recherche des <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> voisins les plus proches, ce qui peut être coûteux en termes de temps si <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> est grand et l&#x27;ensemble de données est grand. L&#x27;estimation par noyau, bien que coûteuse pour des ensembles de données massifs, est souvent plus rapide car elle n&#x27;a pas besoin de trier les distances.</li>
<li><strong>Sensibilité aux valeurs aberrantes</strong> : L&#x27;estimation par noyau peut être influencé par des valeurs aberrantes, car chaque point a une influence, bien que décroissante, sur tous les autres. Le <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-PPV
est moins sensible aux valeurs aberrantes, car il se concentre uniquement sur les <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> points les plus proches.</li>
</ol>
<p><strong>Similarités</strong> :</p>
<ol>
<li><strong>Approche non paramétrique</strong> : Les deux approches (par noyau et basée sur les <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-PPV) sont des méthodes non paramétriques, ce qui signifie qu&#x27;elles ne supposent pas a priori une forme spécifique pour la distribution sous-jacente. Elles peuvent s&#x27;adapter à diverses formes de distributions.</li>
<li><strong>Dépendance à un paramètre (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">h</span></span></span></span> ou <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>)</strong> : Les deux approches dépendent fortement d&#x27;un paramètre (la largeur de fenêtre <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">h</span></span></span></span> pour l&#x27;estimation par noyau et <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> pour ke <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-PPV) pour la qualité de l&#x27;estimation.</li>
<li><strong>Calcul basé sur les distances</strong> : Les deux approche sont basées sur les distances entre les points pour estimer la densité. Pour l&#x27;estimation de densité par noyau, la densité en un point est influencée par tous les autres points, pondérés par leur distance, tandis que pour le <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-PPV, seuls les <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> points les plus proches sont pris en compte.</li>
</ol>
<p><strong>Lien entre eux</strong> :</p>
<p>Les deux approchent tentent d&#x27;estimer la densité en considérant les points voisins. La différence réside dans ce qui est fixé constant et ce qui est autorisé à varier.</p>
<ul>
<li>Dans l&#x27;estimation par noyau, la fenêtre <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">h</span></span></span></span> est constante et le nombre de points dans la zone d&#x27;influence varie.</li>
<li>Dans <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-PPV, le nombre de points <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> est constant, mais la distance nécessaire pour les inclure varie.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q1d-question">Q1D Question<a href="#q1d-question" class="hash-link" aria-label="Direct link to Q1D Question" title="Direct link to Q1D Question">​</a></h3>
<p>Pourquoi les <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-PPV sont-ils intéressants pour le classement et la régression, mais peu adaptés à l&#x27;estimation de densité?</p>
<p>Expliquez en donnant un avantage des <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-PPV et un inconvénient.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q1d-solution">Q1D Solution<a href="#q1d-solution" class="hash-link" aria-label="Direct link to Q1D Solution" title="Direct link to Q1D Solution">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="avantage-des-k-ppv-pour-le-classement-et-la-régression">Avantage des <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-PPV pour le classement et la régression<a href="#avantage-des-k-ppv-pour-le-classement-et-la-régression" class="hash-link" aria-label="Direct link to avantage-des-k-ppv-pour-le-classement-et-la-régression" title="Direct link to avantage-des-k-ppv-pour-le-classement-et-la-régression">​</a></h3>
<p><strong>Adaptabilité à des frontières de décision complexes</strong> : L&#x27;un des principaux avantages des <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-PPV est sa capacité à s&#x27;adapter facilement à des frontières de décision non linéaires sans avoir besoin d&#x27;un modèle explicite. Cela lui permet de bien fonctionner dans des situations où les relations entre les variables sont complexes et ne peuvent pas être facilement capturées par des modèles paramétriques simples.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="inconvénient-des-k-ppv-pour-lestimation-de-densité">Inconvénient des <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-PPV pour l&#x27;estimation de densité<a href="#inconvénient-des-k-ppv-pour-lestimation-de-densité" class="hash-link" aria-label="Direct link to inconvénient-des-k-ppv-pour-lestimation-de-densité" title="Direct link to inconvénient-des-k-ppv-pour-lestimation-de-densité">​</a></h3>
<p><strong>Sensibilité à la dimension</strong> : La &quot;malédiction de la dimensionnalité&quot; est un problème majeur pour les <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-PPV lorsqu&#x27;il s&#x27;agit d&#x27;estimation de densité. Dans les espaces de haute dimension, toutes les distances tendent à se ressembler, rendant difficile la distinction entre des points &quot;proches&quot; et &quot;loins&quot;. Cette uniformité des distances rend les <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-PPV moins efficaces pour estimer la densité dans des espaces de haute dimension, car ils ne peuvent pas facilement distinguer les régions de forte densité des régions de faible densité.</p>
<p>En résumé, bien que les <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-PPV soient excellents pour capturer des relations complexes dans le contexte de la classification et de la régression, leur sensibilité à la dimensionnalité rend difficile leur utilisation efficace pour l&#x27;estimation de densité, en particulier dans les espaces de haute dimension.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="d2q2---tracer-les-régions-de-décisions">D2Q2 - Tracer les régions de décisions<a href="#d2q2---tracer-les-régions-de-décisions" class="hash-link" aria-label="Direct link to D2Q2 - Tracer les régions de décisions" title="Direct link to D2Q2 - Tracer les régions de décisions">​</a></h2>
<p>Il est souvent utile pour le débogage et l&#x27;analyse de tracer les régions de décisions d&#x27;un classifieur.
Dans cette question, vous implémenterez une fonction qui trace les régions de décisions d&#x27;un classifieur.
Cette fonction sera utile pour tracer les régions de décisions des classifieurs que vous implémenterez
dans les questions suivantes.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="code-préambule-d2q2">Code préambule (D2Q2)<a href="#code-préambule-d2q2" class="hash-link" aria-label="Direct link to Code préambule (D2Q2)" title="Direct link to Code préambule (D2Q2)">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import collections</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import os</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import matplotlib</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import numpy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from IPython import display</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from matplotlib import pyplot</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.linear_model import SGDClassifier</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">%matplotlib inline</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pandas.set_option(&quot;display.max_colwidth&quot;, 0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">matplotlib.rcParams[&quot;figure.figsize&quot;] = (6.0, 4.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">_times = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def checkTime(maxduration, question):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    duration = _times[-1] - _times[-2]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if duration &gt; maxduration:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        print(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            f&quot;[ATTENTION] Votre code pour la question {question} met trop de temps à &quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            f&quot;s&#x27;exécuter! Le temps maximum permis est de {maxduration:.4f} secondes, &quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            f&quot;mais votre code a requis {duration:.4f} secondes! Assurez-vous que vous &quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;ne faites pas d&#x27;appels bloquants (par exemple à show()) dans cette boucle!&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def load_dataset(path):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FR: Charger le jeu de données dans le répertoire donné. Le répertoire doit contient</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    les fichiers `features.npy` et `targets.npy`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            path (str): Le chemin du fichier au répertoire de jeu de données.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    EN: Load the dataset stored in the given directory. The directory must contain</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        the files `features.npy` and `targets.npy`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            path (str): The path to the dataset directory.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    X = numpy.load(os.path.join(path, &quot;features.npy&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y = numpy.load(os.path.join(path, &quot;targets.npy&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return X, y</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q2-exercice">Q2 Exercice<a href="#q2-exercice" class="hash-link" aria-label="Direct link to Q2 Exercice" title="Direct link to Q2 Exercice">​</a></h3>
<p>En utilisant le patron de code ci-dessous, implémentez une fonction pour tracer les régions de décisions différentes d&#x27;un classifieur.</p>
<p>Pour vérifier votre implémentation, utilisez le classifieur <code>linear_model.SGDClassifier</code> de Scikit-learn avec les paramètres
défaut et les jeux de données <code>public1</code> et <code>public2</code> fourni. Vous devriez obtenir deux figures similaires à celles montrés ci-dessous:</p>
<p><img loading="lazy" alt="fig2" src="/assets/images/d2q2_decision_regions-5d8a90f71d905c974f601b90ee1a2531.png" width="1200" height="400" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q2-solution">Q2 Solution<a href="#q2-solution" class="hash-link" aria-label="Direct link to Q2 Solution" title="Direct link to Q2 Solution">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">TMAX_Q2 = 20.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">_times.append(time.time())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def tracer_les_regions_de_decision(Classifieur, X, y, **kwargs):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FR: Tracer les différentes régions de décision pour le classifieur donné entraîné</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        sur le jeu de données fourni.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Classifieur (class): Le classifieur à entraîner pour générer les régions de</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                décision.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            X (numpy.ndarray): Une table de données de la forme (n, d), où n est le</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                nombre d&#x27;exemples et d le nombre de caractéristiques.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            y (numpy.ndarray): Une table d&#x27;étiquettes de la forme (n,), où n est le</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                nombre d&#x27;exemples.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            **kwargs: Les arguments à passer au constructeur du `Classifieur`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    EN: Plot the decision regions for the given classifier trained on data provided.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Classifieur (class): The classifier to train to generate the decision</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                regions.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            X (numpy.ndarray): An array of data of shape (n, d), where n is the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                number of examples and d the number of features.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            y (numpy.ndarray): An array of labels of shape (n,), where n is the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                number of examples.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            **kwargs: The arguments to pass to the `Classifieur` constructor.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Créez ici une grille permettant d&#x27;afficher les régions de décision pour chaque</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # classe. Indice : `numpy.meshgrid` pourrait vous être utile ici. N&#x27;utilisez pas un</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # pas trop petit !</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Create a grid here to display the decision regions for each class. Tip:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # `numpy.meshgrid` might be useful here. Don&#x27;t use too small a step size!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Création de la grille de décision</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    x_min, x_max = X[:, 0].min() - 1, X[:, 0].max() + 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y_min, y_max = X[:, 1].min() - 1, X[:, 1].max() + 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    xx, yy = np.meshgrid(np.arange(x_min, x_max, 0.1),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                         np.arange(y_min, y_max, 0.1))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Entraînez le classifieur fourni</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Train the provided classifier</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    model = Classifieur(**kwargs)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    model.fit(X, y)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Prédiction pour chaque point de la grille</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Z = model.predict(np.c_[xx.ravel(), yy.ravel()])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Z = Z.reshape(xx.shape)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Créer la figure à afficher</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Create the figure to display</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    fig = pyplot.figure()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ax = fig.add_subplot(111)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataset = &quot;public1&quot; if len(np.unique(y)) == 2 else &quot;public2&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ax.set_title(f&quot;Les régions de décisions ({dataset})&quot;)  # À modifier / to be modified</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ax.set_xlabel(&quot;x1&quot;)  # À modifier / to be modified</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ax.set_ylabel(&quot;x2&quot;)  # À modifier / to be modified</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Utilisez la grille que vous avez créée plus haut pour afficher les régions de</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # décision, de même que les points colorés selon leur vraie classe. N&#x27;oubliez pas la</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # légende ! Indice : `ax.pcolormesh` et `ax.scatter` pourraient vous être utile ici.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Use the grid you created above to display the decision regions, as well as</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # coloured points according to their true class. Don&#x27;t forget the legend! Tip:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # `ax.pcolormesh` and `ax.scatter` might be useful here.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ax.contourf(xx, yy, Z, alpha=0.8, cmap=&#x27;Pastel1&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    scatter = ax.scatter(X[:, 0], X[:, 1], c=y, edgecolors=&#x27;k&#x27;, marker=&#x27;o&#x27;, s=50, cmap=&#x27;viridis&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Récupération de la palette de couleurs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    colors = [scatter.cmap(scatter.norm(i)) for i in range(np.max(y)+1)]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    legend_labels = [pyplot.Line2D([0], [0], marker=&#x27;o&#x27;, color=&#x27;w&#x27;, label=&#x27;Classe &#x27; + str(i),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                  markersize=10, markerfacecolor=color) for i, color in enumerate(colors)]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ax.legend(handles=legend_labels, loc=&#x27;upper right&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pyplot.tight_layout()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pyplot.show()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># X, y = load_dataset(&quot;/pax/shared/GIF-4101-7005/d2q2_datasets/public1&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import numpy as np</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X1 = np.array([[-1.32649983, 1.12954672],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [-0.55669568, 0.54121086],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [ 0.7200127, -0.82710244],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [-1.2547988, 1.5040504],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [ 0.64249641, -0.79448904],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [ 0.27174921, -0.58527124],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [-1.12533616, 1.46052906],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [-0.62803409, 0.67535627],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [-1.90112583, 2.10315949],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [ 1.329534, -1.18648919],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [ 1.71356331, -1.41855163],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [ 0.92657507, -0.971324],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [ 1.13728051, -1.08448715],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [ 1.67825313, -1.40616691],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [-1.44219628, 1.64112914]])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">y1 = np.array([0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, ..., 1, 1, 0])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X2 = np.array([[-6.93018878, -0.28334284],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [-6.44758292, -0.86889427],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [-6.25263121, 0.01138177],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [-3.06133092, 9.97753306],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [-2.5297393, 9.04123325],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [ 0.58245648, -6.33307394],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [-6.73618374, -2.00196916],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [-6.32223027, 0.92769025],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [-0.98413783, -7.20517672],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [-4.1747874, 8.16241714],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [ 0.31026681, -5.87760172]])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">y2 = np.array([2, 2, 2, 0, 0, 1, 0, 0, 0, 2, 0, 1, 0, 2, ..., 2, 2, 1, 0, 1])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tracer_les_regions_de_decision(SGDClassifier, X1, y1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tracer_les_regions_de_decision(SGDClassifier, X2, y2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">_times.append(time.time())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">checkTime(TMAX_Q2, &quot;Q2&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="png" src="/assets/images/output_20_0-8d2b306097f7235e48442908cb53a56b.png" width="1490" height="990" class="img_ev3q"></p>
<p><img loading="lazy" alt="png" src="/assets/images/output_20_1-d615abf1a472b739dda8473fec903713.png" width="1489" height="990" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="d2q3---évaluation-des-discriminants-linéaires">D2Q3 - Évaluation des discriminants linéaires<a href="#d2q3---évaluation-des-discriminants-linéaires" class="hash-link" aria-label="Direct link to D2Q3 - Évaluation des discriminants linéaires" title="Direct link to D2Q3 - Évaluation des discriminants linéaires">​</a></h2>
<p>Dans cette question, vous devez évaluer différents discriminants linéaires en utilisant la validation croisée.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="code-préambule-d2q3">Code préambule (D2Q3)<a href="#code-préambule-d2q3" class="hash-link" aria-label="Direct link to Code préambule (D2Q3)" title="Direct link to Code préambule (D2Q3)">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import collections</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import os</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import matplotlib</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import numpy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from IPython import display</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from matplotlib import pyplot</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from scipy.stats import norm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.datasets import load_breast_cancer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.discriminant_analysis import LinearDiscriminantAnalysis</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.linear_model import LogisticRegression, Perceptron</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.model_selection import KFold</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.preprocessing import minmax_scale</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">%matplotlib inline</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pandas.set_option(&quot;display.max_colwidth&quot;, 0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">matplotlib.rcParams[&quot;figure.figsize&quot;] = (15.0, 10.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">_times = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def checkTime(maxduration, question):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    duration = _times[-1] - _times[-2]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if duration &gt; maxduration:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        print(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            f&quot;[ATTENTION] Votre code pour la question {question} met trop de temps à &quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            f&quot;s&#x27;exécuter! Le temps maximum permis est de {maxduration:.4f} secondes, &quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            f&quot;mais votre code a requis {duration:.4f} secondes! Assurez-vous que vous &quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;ne faites pas d&#x27;appels bloquants (par exemple à show()) dans cette boucle!&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q3-question">Q3 Question<a href="#q3-question" class="hash-link" aria-label="Direct link to Q3 Question" title="Direct link to Q3 Question">​</a></h3>
<p>Comparez les discriminants linéaires suivants:</p>
<ul>
<li>Méthode paramétrique de loi normale multivariée (<code>discriminant_analysis.LinearDiscriminantAnalysis</code>);</li>
<li>Descente du gradient avec le critère du perceptron (<code>linear_model.Perceptron</code>);</li>
<li>Régression logistique (<code>linear_model.LogisticRegression</code>).</li>
</ul>
<p>Utilisez le jeu de données suivant pour faire vos comparaisons:</p>
<ul>
<li>Breast Cancer Wisconsin: jeu de 569 données pour l&#x27;identification du cancer du sein en 30 dimensions et selon 2 classes. Le jeu est disponible avec la commande <code>load_breast_cancer()</code>.</li>
</ul>
<p>Normalisez préalablement les données selon les valeurs minimales et maximales du jeu avec la fonction appelée <code>minmax_scale</code>. Faites vos expérimentations selon une validation croisée à trois plis.</p>
<p>Pour cette question:</p>
<ul>
<li>Rapportez les taux d&#x27;erreurs en entraînement, en validation et le temps de calcul dans le tableau prévu à cet effet;</li>
<li>Commentez <strong>brièvement</strong> les résultats obtenus et indiquez les paramètres d&#x27;entraînement utilisés pour chacun des algorithmes.</li>
</ul>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Durée d&#x27;exécution maximale</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Maximum execution duration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">TMAX_Q3 = 60</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Dictionnaire pour enregistrer les paramètres évalués</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Dictionary for recording evaluated parameters</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">params = collections.defaultdict(list)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">params[&#x27;classifier&#x27;] = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">_times.append(time.time())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Chargez les données &quot;Breast cancer Wisconsin&quot; et normalisez-les de</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># manière à ce que les valeurs minimum/maximum tiennent dans le domaine [0, 1]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Load &quot;Breast cancer Wisconsin&quot; dataset and normalize it in order to</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># get their minimum/maximum values in the [0, 1] domain</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 1. Charger le jeu de données</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data = load_breast_cancer()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X = data.data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">y = data.target</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 2. Normaliser le jeu de données</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X_normalized = minmax_scale(X)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Comparez les diverses approches demandées dans l&#x27;énoncé sur Breast Cancer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># N&#x27;oubliez pas que l&#x27;évaluation doit être faite par une validation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># croisée à K=3 plis!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Compare the various approaches requested in the statement on Breast Cancer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Don&#x27;t forget that the evaluation must be done by a cross validation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># with K=3 folds!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># 3. Initialiser une validation croisée à trois plis</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kf = KFold(n_splits=3)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Initialiser les différents classifieurs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Initialize the various classifiers</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">classifiers = [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  LinearDiscriminantAnalysis(), # Ajustez les hyperparamètres! / Adjust the hyperparameters!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  LogisticRegression(),         # Ajustez les hyperparamètres! / Adjust the hyperparameters!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Perceptron(),                 # Ajustez les hyperparamètres! / Adjust the hyperparameters!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Créer le tableau pour accumuler les résultats</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Create the table to accumulate the results</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">results = {&#x27;Classifiers&#x27;:[],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &#x27;Train_err&#x27;:[],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &#x27;Valid_err&#x27;:[],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &#x27;Exec_time&#x27;:[],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           &#x27;Comments&#x27;:[],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for clf in classifiers:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    clf_name = clf.__class__.__name__</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if clf_name not in results[&#x27;Classifiers&#x27;]:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        results[&#x27;Classifiers&#x27;].append(clf_name)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Boucle d&#x27;entraînement, validation croisée (K=3), et mesure du temps d&#x27;exécution à faire</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Training loop, cross-validation (K=3), and measuring execution time to be done</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    train_errs = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    valid_errs = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exec_times = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    for train_index, valid_index in kf.split(X_normalized):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        X_train, X_valid = X_normalized[train_index], X_normalized[valid_index]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        y_train, y_valid = y[train_index], y[valid_index]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Entraîner le modèle</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        start_time = time.time()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        clf.fit(X_train, y_train)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        end_time = time.time()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Calculer les erreurs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        train_err = 1 - clf.score(X_train, y_train)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        valid_err = 1 - clf.score(X_valid, y_valid)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exec_time = end_time - start_time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        train_errs.append(train_err)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        valid_errs.append(valid_err)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        exec_times.append(exec_time)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Ajoutez l&#x27;erreur d&#x27;entraînement dans la variable train_err</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Add training error in variable train_err</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    train_err = numpy.mean(train_errs)  # Remplacez le 0 par la valeur / replace the 0 with the value</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    results[&#x27;Train_err&#x27;].append(train_err)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Ajoutez l&#x27;erreur de validation dans la variable valid_err</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Add validation error in variable valid_err</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    valid_err = numpy.mean(valid_errs)  # Remplacez le 0 par la valeur / replace the 0 with the value</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    results[&#x27;Valid_err&#x27;].append(valid_err)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Ajoutez le temps de calcul mesuré dans la variable exec_time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # Add measure execution time in variable exec_time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    exec_time = numpy.mean(exec_times)  # Remplacez le 0 par la valeur / replace the 0 with the value</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    results[&#x27;Exec_time&#x27;].append(exec_time)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">_times.append(time.time())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">checkTime(TMAX_Q3, &quot;3&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Ajoutez les commentaires et les hyperparamètres (HP) utilisés pour chaque classifieur</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># demandé</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Add comments and hyperparameters (HP) used for each classifier requested</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Ajoutez vos commentaires et HP pour le LinearDiscriminantAnalysis</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Add your comments and HP for LinearDiscriminantAnalysis</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">lda_comments = &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># HYPERPARAMÈTRES</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Hyperparamètres par défaut (solver=&#x27;svd&#x27;, shrinkage=None, priors=None, n_components=None,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">store_covariance=False, tol=0.0001, covariance_estimator=None).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Le modèle adapte une densité gaussienne à chaque classe, en supposant que toutes les</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">classes partagent la même matrice de covariance.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> # RÉSULTATS</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Le classifieur `LinearDiscriminantAnalysis` avec validation croisée 3 plis donne</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">les erreurs les plus élevées des trois classifieurs sur les ensembles d&#x27;entraînement</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">et de test, le temps d&#x27;exécution la plus grande également.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> # AMÉLIORATIONS POSSIBLES</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Il serait intéressant de faire une recherche d&#x27;hyperparamètres avec `GridSearchCV`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sur `solver` et `shrinkage`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">parameters_lda = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;solver&#x27;: [&#x27;svd&#x27;, &#x27;lsqr&#x27;, &#x27;eigen&#x27;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;shrinkage&#x27;: [None, &#x27;auto&#x27;] + list(numpy.linspace(0, 1, 10))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">results[&#x27;Comments&#x27;].append(lda_comments.replace(&quot;\n&quot;, &quot; &quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Ajoutez vos commentaires et HP pour le LogisticRegression</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Add your comments and HP for LogisticRegression</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">logreg_comments = &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># HYPERPARAMÈTRES</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Hyperparamètres par défaut (penalty=&#x27;l2&#x27;, dual=False, tol=0.0001, C=1.0, fit_intercept=True,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">intercept_scaling=1, class_weight=None, random_state=None, solver=&#x27;lbfgs&#x27;, max_iter=100,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">multi_class=&#x27;auto&#x27;, verbose=0, warm_start=False, n_jobs=None, l1_ratio=None).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Notamment, la régularisation est appliquée par défaut.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> # RÉSULTATS</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Par rapport au `LinearDiscriminantAnalysis`, le classifieur `LogisticRegression` avec validation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">croisée 3 plis donne des erreurs légèrement plus faibles sur les ensembles d&#x27;entraînement</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">et de test et s&#x27;exécute deux fois plus rapidement.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> # AMÉLIORATIONS POSSIBLES</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Il serait intéressant de faire une recherche d&#x27;hyperparamètres avec `GridSearchCV`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sur `C` pour contrôler la régularisation, `penality`et `solver`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">parameters_logreg = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;C&#x27;: [0.001, 0.01, 0.1, 1, 10, 100],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;penalty&#x27;: [&#x27;l1&#x27;, &#x27;l2&#x27;, &#x27;elasticnet&#x27;, &#x27;none&#x27;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;solver&#x27;: [&#x27;lbfgs&#x27;, &#x27;newton-cg&#x27;, &#x27;liblinear&#x27;, &#x27;sag&#x27;, &#x27;saga&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">results[&#x27;Comments&#x27;].append(logreg_comments.replace(&quot;\n&quot;, &quot; &quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Ajoutez vos commentaires et HP pour le Perceptron</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Add your comments and HP for Perceptron</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">perceptron_comments = &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># HYPERPARAMÈTRES</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Hyperparamètres par défaut (penalty=None, alpha=0.0001, l1_ratio=0.15, fit_intercept=True,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_iter=1000, tol=0.001, shuffle=True, verbose=0, eta0=1.0, n_jobs=None, random_state=0,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">early_stopping=False, validation_fraction=0.1, n_iter_no_change=5, class_weight=None,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">warm_start=False).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> # RÉSULTATS</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Le classifieur `Perceptron` avec validation croisée 3 plis donne</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">les erreurs les plus faibles des trois classifieurs sur les ensembles d&#x27;entraînement</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">et de test, le temps d&#x27;exécution la plus faible également.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> # AMÉLIORATIONS POSSIBLES</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Il serait intéressant de faire une recherche d&#x27;hyperparamètres avec `GridSearchCV`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sur `alpha`, `penality` et `max_iter`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">parameters_perceptron = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;alpha&#x27;: [0.0001, 0.001, 0.01, 0.1, 1],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;penalty&#x27;: [&#x27;l1&#x27;, &#x27;l2&#x27;, &#x27;elasticnet&#x27;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &#x27;max_iter&#x27;: [500, 1000, 1500, 2000]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">results[&#x27;Comments&#x27;].append(perceptron_comments.replace(&quot;\n&quot;, &quot; &quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Affichage des erreurs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Plot the errors</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df = pandas.DataFrame(results)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">display.display(df)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th></th><th>Classifiers</th><th>Train_err</th><th>Valid_err</th><th>Exec_time</th><th>Comments</th></tr></thead><tbody><tr><td>0</td><td>LinearDiscriminantAnalysis</td><td>0.032514</td><td>0.047406</td><td>0.176709</td><td># HYPERPARAMÈTRES Hyperparamètres par défaut (solver=&#x27;svd&#x27;, shrinkage=None, priors=None, n_components=None,  store_covariance=False, tol=0.0001, covariance_estimator=None). Le modèle adapte une densité gaussienne à chaque classe, en supposant que toutes les  classes partagent la même matrice de covariance.  # RÉSULTATS Le classifieur <code>LinearDiscriminantAnalysis</code> avec validation croisée 3 plis donne les erreurs les plus élevées des trois classifieurs sur les ensembles d&#x27;entraînement  et de test, le temps d&#x27;exécution la plus grande également.  # AMÉLIORATIONS POSSIBLES Il serait intéressant de faire une recherche d&#x27;hyperparamètres avec <code>GridSearchCV</code>   sur <code>solver</code> et <code>shrinkage</code>. parameters_lda = &#x27;solver&#x27;: [&#x27;svd&#x27;, &#x27;lsqr&#x27;, &#x27;eigen&#x27;],     &#x27;shrinkage&#x27;: [None, &#x27;auto&#x27;] + list(numpy.linspace(0, 1, 10))</td></tr><tr><td>1</td><td>LogisticRegression</td><td>0.031634</td><td>0.045642</td><td>0.067527</td><td># HYPERPARAMÈTRES Hyperparamètres par défaut (penalty=&#x27;l2&#x27;, dual=False, tol=0.0001, C=1.0, fit_intercept=True,  intercept_scaling=1, class_weight=None, random_state=None, solver=&#x27;lbfgs&#x27;, max_iter=100,  multi_class=&#x27;auto&#x27;, verbose=0, warm_start=False, n_jobs=None, l1_ratio=None).  Notamment, la régularisation est appliquée par défaut.  # RÉSULTATS Par rapport au <code>LinearDiscriminantAnalysis</code>, le classifieur <code>LogisticRegression</code> avec validation  croisée 3 plis donne des erreurs légèrement plus faibles sur les ensembles d&#x27;entraînement  et de test et s&#x27;exécute deux fois plus rapidement.  # AMÉLIORATIONS POSSIBLES Il serait intéressant de faire une recherche d&#x27;hyperparamètres avec <code>GridSearchCV</code>   sur <code>C</code> pour contrôler la régularisation, <code>penality</code>et <code>solver</code>. parameters_logreg = &#x27;C&#x27;: [0.001, 0.01, 0.1, 1, 10, 100],     &#x27;penalty&#x27;: [&#x27;l1&#x27;, &#x27;l2&#x27;, &#x27;elasticnet&#x27;, &#x27;none&#x27;],     &#x27;solver&#x27;: [&#x27;lbfgs&#x27;, &#x27;newton-cg&#x27;, &#x27;liblinear&#x27;, &#x27;sag&#x27;, &#x27;saga&#x27;]</td></tr><tr><td>2</td><td>Perceptron</td><td>0.019331</td><td>0.038643</td><td>0.000580</td><td># HYPERPARAMÈTRES Hyperparamètres par défaut (penalty=None, alpha=0.0001, l1_ratio=0.15, fit_intercept=True,  max_iter=1000, tol=0.001, shuffle=True, verbose=0, eta0=1.0, n_jobs=None, random_state=0,  early_stopping=False, validation_fraction=0.1, n_iter_no_change=5, class_weight=None,  warm_start=False).  # RÉSULTATS Le classifieur <code>Perceptron</code> avec validation croisée 3 plis donne les erreurs les plus faibles des trois classifieurs sur les ensembles d&#x27;entraînement  et de test, le temps d&#x27;exécution la plus faible également.  # AMÉLIORATIONS POSSIBLES Il serait intéressant de faire une recherche d&#x27;hyperparamètres avec <code>GridSearchCV</code>  sur <code>alpha</code>, <code>penality</code> et <code>max_iter</code>. parameters_perceptron = &#x27;alpha&#x27;: [0.0001, 0.001, 0.01, 0.1, 1],     &#x27;penalty&#x27;: [&#x27;l1&#x27;, &#x27;l2&#x27;, &#x27;elasticnet&#x27;],     &#x27;max_iter&#x27;: [500, 1000, 1500, 2000]</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="d2q4---implémentation-dun-discriminant-linéaire">D2Q4 - Implémentation d&#x27;un discriminant linéaire<a href="#d2q4---implémentation-dun-discriminant-linéaire" class="hash-link" aria-label="Direct link to D2Q4 - Implémentation d&#x27;un discriminant linéaire" title="Direct link to D2Q4 - Implémentation d&#x27;un discriminant linéaire">​</a></h2>
<p>Soit un discriminant linéaire, avec lequel le classement est effectué selon:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>h</mtext><mo stretchy="false">(</mo><mtext mathvariant="bold">x</mtext><mi mathvariant="normal">∣</mi><mtext mathvariant="bold">w</mtext><mo separator="true">,</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>=</mo><msup><mtext mathvariant="bold">w</mtext><mi mathvariant="normal">⊤</mi></msup><mtext mathvariant="bold">x</mtext><mo>+</mo><msub><mi>w</mi><mn>0</mn></msub><mo separator="true">,</mo><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>∈</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>C</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> si h</mtext><mo stretchy="false">(</mo><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mi mathvariant="normal">∣</mi><mtext mathvariant="bold">w</mtext><mo separator="true">,</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>≥</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>C</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext> autrement </mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\text{h}(\textbf{x}|\textbf{w},w_0) = \textbf{w}^\top \textbf{x} + w_0, \textbf{x}^t \in
\begin{cases}
C_1 &amp; \text{ si } \text{h}(\textbf{x}^t|\textbf{w},w_0) \ge 0 \\
C_2 &amp; \text{ autrement }
\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">h</span></span><span class="mopen">(</span><span class="mord text"><span class="mord textbf">x</span></span><span class="mord">∣</span><span class="mord text"><span class="mord textbf">w</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9824em;vertical-align:-0.0833em"></span><span class="mord"><span class="mord text"><span class="mord textbf">w</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord textbf">x</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.038em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8436em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em"><span style="top:-3.69em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em"><span style="top:-3.69em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord text"><span class="mord"> si </span></span><span class="mord text"><span class="mord">h</span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord text"><span class="mord textbf">w</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">0</span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord text"><span class="mord"> autrement </span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p>On effectue un entraînement avec une descente du gradient basée sur le critère d&#x27;erreur suivant:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><mtext mathvariant="bold">w</mtext><mo separator="true">,</mo><msub><mi>w</mi><mn>0</mn></msub><mi mathvariant="normal">∣</mi><mi mathvariant="script">X</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><munder><mo>∑</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>∈</mo><mi mathvariant="script">Y</mi></mrow></munder><mfrac><mrow><mo stretchy="false">[</mo><msup><mi>r</mi><mi>t</mi></msup><mo>−</mo><mtext>h</mtext><mo stretchy="false">(</mo><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mi mathvariant="normal">∣</mi><mtext mathvariant="bold">w</mtext><mo separator="true">,</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="false">)</mo><msup><mo stretchy="false">]</mo><mn>2</mn></msup></mrow><mrow><mi mathvariant="normal">∥</mi><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup></mrow></mfrac><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">E(\textbf{w},w_0|\mathcal{X}) = \frac{1}{2} \sum_{\textbf{x}^t \in \mathcal{Y}} \frac{[r^t - \text{h}(\textbf{x}^t|\textbf{w},w_0)]^2}{\| \textbf{x}^t \|^2},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="mopen">(</span><span class="mord text"><span class="mord textbf">w</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathcal" style="margin-right:0.14643em">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.8829em;vertical-align:-1.3918em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8263em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.08222em">Y</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3918em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∥</span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7196em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">h</span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord text"><span class="mord textbf">w</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span></span>
<p>où <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>r</mi><mi>t</mi></msup><mo>∈</mo><mo stretchy="false">{</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">r^t \in \{-1,1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8327em;vertical-align:-0.0391em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">{</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span> et <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">Y</mi></mrow><annotation encoding="application/x-tex">\mathcal{Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7805em;vertical-align:-0.0972em"></span><span class="mord mathcal" style="margin-right:0.08222em">Y</span></span></span></span> est l&#x27;ensemble des données de <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">X</mi></mrow><annotation encoding="application/x-tex">\mathcal{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.14643em">X</span></span></span></span> mal classées,</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="script">Y</mi><mo>=</mo><mo stretchy="false">{</mo><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>∈</mo><mi mathvariant="script">X</mi><mi mathvariant="normal">∣</mi><msup><mi>r</mi><mi>t</mi></msup><mtext>h</mtext><mo stretchy="false">(</mo><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mi mathvariant="normal">∣</mi><mtext mathvariant="bold">w</mtext><mo separator="true">,</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>≤</mo><mn>0</mn><mo stretchy="false">}</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\mathcal{Y} = \{\textbf{x}^t \in \mathcal{X} | r^t \text{h}(\textbf{x}^t|\textbf{w},w_0) \le 0 \}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7805em;vertical-align:-0.0972em"></span><span class="mord mathcal" style="margin-right:0.08222em">Y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0936em;vertical-align:-0.25em"></span><span class="mopen">{</span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8436em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0936em;vertical-align:-0.25em"></span><span class="mord mathcal" style="margin-right:0.14643em">X</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8436em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord">h</span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8436em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord text"><span class="mord textbf">w</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">0</span><span class="mclose">}</span><span class="mord">.</span></span></span></span></span>
<p>Si l&#x27;ensemble <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">Y</mi></mrow><annotation encoding="application/x-tex">\mathcal{Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7805em;vertical-align:-0.0972em"></span><span class="mord mathcal" style="margin-right:0.08222em">Y</span></span></span></span> est vide, alors <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><mtext mathvariant="bold">w</mtext><mo separator="true">,</mo><msub><mi>w</mi><mn>0</mn></msub><mi mathvariant="normal">∣</mi><mi mathvariant="script">X</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">E(\textbf{w},w_0|\mathcal{X}) = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="mopen">(</span><span class="mord text"><span class="mord textbf">w</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathcal" style="margin-right:0.14643em">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="code-préambule-1">Code préambule<a href="#code-préambule-1" class="hash-link" aria-label="Direct link to Code préambule" title="Direct link to Code préambule">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import collections</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import os</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import matplotlib</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import numpy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from matplotlib import pyplot</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">%matplotlib inline</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">matplotlib.rcParams[&quot;figure.figsize&quot;] = (15.0, 10.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">_times = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def checkTime(maxduration, question):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    duration = _times[-1] - _times[-2]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if duration &gt; maxduration:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        print(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            f&quot;[ATTENTION] Votre code pour la question {question} met trop de temps à &quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            f&quot;s&#x27;exécuter! Le temps maximum permis est de {maxduration:.4f} secondes, &quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            f&quot;mais votre code a requis {duration:.4f} secondes! Assurez-vous que vous &quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;ne faites pas d&#x27;appels bloquants (par exemple à show()) dans cette boucle!&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def load_dataset(path):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FR: Charger le jeu de données dans le répertoire donné. Le répertoire doit contient</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    les fichiers `features.npy` et `targets.npy`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            path (str): Le chemin du fichier au répertoire de jeu de données.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    EN: Load the dataset stored in the given directory. The directory must contain</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        the files `features.npy` and `targets.npy`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            path (str): The path to the dataset directory.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    X = numpy.load(os.path.join(path, &quot;features.npy&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y = numpy.load(os.path.join(path, &quot;targets.npy&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return X, y</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q4a-question">Q4A Question<a href="#q4a-question" class="hash-link" aria-label="Direct link to Q4A Question" title="Direct link to Q4A Question">​</a></h3>
<p>Donnez le développement mathématique <strong>complet</strong> des équations permettant d&#x27;effectuer la mise à jour des poids <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">w</mtext></mrow><annotation encoding="application/x-tex">\textbf{w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord text"><span class="mord textbf">w</span></span></span></span></span>
et <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">w_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> par descente du gradient, selon le critère d&#x27;erreur proposé.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q4a-solution">Q4A Solution<a href="#q4a-solution" class="hash-link" aria-label="Direct link to Q4A Solution" title="Direct link to Q4A Solution">​</a></h3>
<p><strong>1. Gradient par rapport à <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">w</mtext></mrow><annotation encoding="application/x-tex">\textbf{w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord text"><span class="mord textbf">w</span></span></span></span></span></strong> :</p>
<p>Dans la formule ci-dessous :</p>
<ul>
<li>j&#x27;insère la définition de <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>h</mtext><mo stretchy="false">(</mo><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mi mathvariant="normal">∣</mi><mtext mathvariant="bold">w</mtext><mo separator="true">,</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{h}(\textbf{x}^t | \textbf{w}, w_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0436em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">h</span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord text"><span class="mord textbf">w</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> en <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(1)</mtext></mrow><annotation encoding="application/x-tex">\text{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">(1)</span></span></span></span></span></li>
<li>je dérive par rapport à <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> en appliquant la règle de la chaîne et en utilisant le fait que <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mi>i</mi></msub></mrow></mfrac><msup><mtext mathvariant="bold">w</mtext><mi mathvariant="normal">⊤</mi></msup><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>=</mo><msubsup><mtext mathvariant="bold">x</mtext><mi>i</mi><mi>t</mi></msubsup></mrow><annotation encoding="application/x-tex">\frac{\partial}{\partial w_i} \textbf{w}^\top \textbf{x}^t = \textbf{x}_i^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord text"><span class="mord textbf">w</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0522em;vertical-align:-0.2587em"></span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-2.4413em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em"><span></span></span></span></span></span></span></span></span></span> en <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(2)</mtext></mrow><annotation encoding="application/x-tex">\text{(2)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">(2)</span></span></span></span></span></li>
</ul>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left right" columnspacing="0em 1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mi>i</mi></msub></mrow></mfrac><mi>E</mi><mo stretchy="false">(</mo><mtext mathvariant="bold">w</mtext><mo separator="true">,</mo><msub><mi>w</mi><mn>0</mn></msub><mi mathvariant="normal">∣</mi><mi mathvariant="script">X</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mi>i</mi></msub></mrow></mfrac><mrow><mo fence="true">(</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><munder><mo>∑</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>∈</mo><mi mathvariant="script">Y</mi></mrow></munder><mfrac><mrow><mo stretchy="false">[</mo><msup><mi>r</mi><mi>t</mi></msup><mo>−</mo><mtext>h</mtext><mo stretchy="false">(</mo><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mi mathvariant="normal">∣</mi><mtext mathvariant="bold">w</mtext><mo separator="true">,</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="false">)</mo><msup><mo stretchy="false">]</mo><mn>2</mn></msup></mrow><mrow><mi mathvariant="normal">∥</mi><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mi>i</mi></msub></mrow></mfrac><mrow><mo fence="true">(</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><munder><mo>∑</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>∈</mo><mi mathvariant="script">Y</mi></mrow></munder><mfrac><mrow><mo stretchy="false">[</mo><msup><mi>r</mi><mi>t</mi></msup><mo>−</mo><mo stretchy="false">(</mo><msup><mtext mathvariant="bold">w</mtext><mi mathvariant="normal">⊤</mi></msup><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>+</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="false">)</mo><msup><mo stretchy="false">]</mo><mn>2</mn></msup></mrow><mrow><mi mathvariant="normal">∥</mi><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>(1)</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>∈</mo><mi mathvariant="script">Y</mi></mrow></munder><mfrac><mrow><mo stretchy="false">[</mo><msup><mi>r</mi><mi>t</mi></msup><mo>−</mo><mo stretchy="false">(</mo><msup><mtext mathvariant="bold">w</mtext><mi mathvariant="normal">⊤</mi></msup><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>+</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo><msub><mi>x</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∥</mi><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup></mrow></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>(2)</mtext></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\frac{\partial}{\partial w_i} E(\textbf{w},w_0|\mathcal{X})
&amp; = \frac{\partial}{\partial w_i} \left( \frac{1}{2} \sum_{\textbf{x}^t \in \mathcal{Y}} \frac{[r^t - \text{h}(\textbf{x}^t | \textbf{w},
w_0)]^2}{\| \textbf{x}^t \|^2} \right) \\
&amp;= \frac{\partial}{\partial w_i} \left( \frac{1}{2} \sum_{\textbf{x}^t \in \mathcal{Y}} \frac{[r^t - (\textbf{w}^\top \textbf{x}^t + w_0)]^2}{\| \textbf{x}^t \|^2} \right) &amp; \text{(1)}  \\
&amp;= -\sum_{\textbf{x}^t \in \mathcal{Y}} \frac{ [r^t - (\textbf{w}^\top \textbf{x}^t + w_0)] x_i}{\| \textbf{x}^t \|^2}
&amp; \text{(2)}
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:10.1015em;vertical-align:-4.8008em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.3008em"><span style="top:-7.3008em"><span class="pstrut" style="height:3.75em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="mopen">(</span><span class="mord text"><span class="mord textbf">w</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathcal" style="margin-right:0.14643em">X</span><span class="mclose">)</span></span></span><span style="top:-3.859em"><span class="pstrut" style="height:3.75em"></span><span class="mord"></span></span><span style="top:-0.641em"><span class="pstrut" style="height:3.75em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.8008em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.3008em"><span style="top:-7.3008em"><span class="pstrut" style="height:3.75em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size4">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8263em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.08222em">Y</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3918em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∥</span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7196em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord text"><span class="mord">h</span></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord text"><span class="mord textbf">w</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size4">)</span></span></span></span></span><span style="top:-3.859em"><span class="pstrut" style="height:3.75em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size4">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8263em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.08222em">Y</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3918em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5261em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∥</span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7196em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord textbf">w</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size4">)</span></span></span></span></span><span style="top:-0.641em"><span class="pstrut" style="height:3.75em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8263em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.08222em">Y</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3918em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5261em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∥</span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7196em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord textbf">w</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)]</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.8008em"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.859em"><span style="top:-3.859em"><span class="pstrut" style="height:3.75em"></span><span class="mord"><span class="mord text"><span class="mord">(1)</span></span></span></span><span style="top:-0.641em"><span class="pstrut" style="height:3.75em"></span><span class="mord"><span class="mord text"><span class="mord">(2)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.8008em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p><strong>2. Gradient par rapport à <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">w_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></strong> :</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mn>0</mn></msub></mrow></mfrac><mi>E</mi><mo stretchy="false">(</mo><mtext mathvariant="bold">w</mtext><mo separator="true">,</mo><msub><mi>w</mi><mn>0</mn></msub><mi mathvariant="normal">∣</mi><mi mathvariant="script">X</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mn>0</mn></msub></mrow></mfrac><mrow><mo fence="true">(</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><munder><mo>∑</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>∈</mo><mi mathvariant="script">Y</mi></mrow></munder><mfrac><mrow><mo stretchy="false">[</mo><msup><mi>r</mi><mi>t</mi></msup><mo>−</mo><mo stretchy="false">(</mo><msup><mtext mathvariant="bold">w</mtext><mi mathvariant="normal">⊤</mi></msup><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>+</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="false">)</mo><msup><mo stretchy="false">]</mo><mn>2</mn></msup></mrow><mrow><mi mathvariant="normal">∥</mi><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo>−</mo><munder><mo>∑</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>∈</mo><mi mathvariant="script">Y</mi></mrow></munder><mfrac><mrow><mo stretchy="false">[</mo><msup><mi>r</mi><mi>t</mi></msup><mo>−</mo><mo stretchy="false">(</mo><msup><mtext mathvariant="bold">w</mtext><mi mathvariant="normal">⊤</mi></msup><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>+</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><mrow><mi mathvariant="normal">∥</mi><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\frac{\partial}{\partial w_0} E(\textbf{w},w_0|\mathcal{X}) &amp;= \frac{\partial}{\partial w_0} \left( \frac{1}{2} \sum_{\textbf{x}^t \in \mathcal{Y}} \frac{[r^t - (\textbf{w}^\top \textbf{x}^t + w_0)]^2}{\| \textbf{x}^t \|^2} \right) \\
&amp;= -\sum_{\textbf{x}^t \in \mathcal{Y}} \frac{ [r^t - (\textbf{w}^\top \textbf{x}^t + w_0)]}{\| \textbf{x}^t \|^2}
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.6597em;vertical-align:-3.0799em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5799em"><span style="top:-5.5799em"><span class="pstrut" style="height:3.75em"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="mopen">(</span><span class="mord text"><span class="mord textbf">w</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathcal" style="margin-right:0.14643em">X</span><span class="mclose">)</span></span></span><span style="top:-2.3619em"><span class="pstrut" style="height:3.75em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.0799em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.5799em"><span style="top:-5.5799em"><span class="pstrut" style="height:3.75em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size4">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8263em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.08222em">Y</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3918em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5261em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∥</span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7196em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord textbf">w</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size4">)</span></span></span></span></span><span style="top:-2.3619em"><span class="pstrut" style="height:3.75em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8263em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.08222em">Y</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3918em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5261em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∥</span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7196em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord textbf">w</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.0799em"><span></span></span></span></span></span></span></span></span></span></span></span>
<p><strong>3. Mise à jour par descente du gradient</strong> :</p>
<p>Si <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>η</mi></mrow><annotation encoding="application/x-tex">\eta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">η</span></span></span></span> est le taux d&#x27;apprentissage, la mise à jour des poids <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>η</mi></mrow><annotation encoding="application/x-tex">\eta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">η</span></span></span></span> du biais <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">w_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> est :</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext mathvariant="bold">w</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext mathvariant="bold">w</mtext><mo>+</mo><mi>η</mi><munder><mo>∑</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>∈</mo><mi mathvariant="script">Y</mi></mrow></munder><mfrac><mrow><mo stretchy="false">[</mo><msup><mi>r</mi><mi>t</mi></msup><mo>−</mo><mo stretchy="false">(</mo><msup><mtext mathvariant="bold">w</mtext><mi mathvariant="normal">⊤</mi></msup><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>+</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo><msubsup><mi>x</mi><mi>i</mi><mi>t</mi></msubsup></mrow><mrow><mi mathvariant="normal">∥</mi><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>w</mi><mn>0</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><mo>+</mo><mi>η</mi><munder><mo>∑</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>∈</mo><mi mathvariant="script">Y</mi></mrow></munder><mfrac><mrow><mo stretchy="false">[</mo><msup><mi>r</mi><mi>t</mi></msup><mo>−</mo><mo stretchy="false">(</mo><msup><mtext mathvariant="bold">w</mtext><mi mathvariant="normal">⊤</mi></msup><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>+</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><mrow><mi mathvariant="normal">∥</mi><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\textbf{w} &amp;= \textbf{w} + \eta \sum_{\textbf{x}^t \in \mathcal{Y}} \frac{ [r^t - (\textbf{w}^\top \textbf{x}^t + w_0)] x_i^t}{\| \textbf{x}^t  \|^2} \\
w_0 &amp;= w_0 + \eta \sum_{\textbf{x}^t \in \mathcal{Y}} \frac{ [r^t - (\textbf{w}^\top \textbf{x}^t + w_0)]}{\| \textbf{x}^t \|^2}
\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.4358em;vertical-align:-2.9679em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.4679em"><span style="top:-5.4679em"><span class="pstrut" style="height:3.5261em"></span><span class="mord"><span class="mord text"><span class="mord textbf">w</span></span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.5261em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.9679em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.4679em"><span style="top:-5.4679em"><span class="pstrut" style="height:3.5261em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord textbf">w</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.03588em">η</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8263em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.08222em">Y</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3918em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5261em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∥</span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7196em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord textbf">w</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)]</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.5261em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.03588em">η</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8263em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.08222em">Y</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3918em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5261em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∥</span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7196em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord textbf">w</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.9679em"><span></span></span></span></span></span></span></span></span></span></span></span>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Oui, j&#x27;arrive à la même chose, mais je crois que tu devrais ajuster tes symboles pour utiliser les mêmes notations que le prof.</p><p>Le vecteur de poids est <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">w</mtext></mrow><annotation encoding="application/x-tex">\textbf{w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord text"><span class="mord textbf">w</span></span></span></span></span>, un poids est <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>, un échantillon est <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">\textbf{x}^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7936em"></span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span> et la <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em"></span><span class="mord mathnormal">i</span></span></span></span>-ème caractéristique de  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">\textbf{x}^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7936em"></span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span> est <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mi>i</mi><mi>t</mi></msubsup></mrow><annotation encoding="application/x-tex">x_i^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0522em;vertical-align:-0.2587em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em"><span></span></span></span></span></span></span></span></span></span>.
Et le prof écrit toujours <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>r</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">r^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7936em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span> (et non pas <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">r_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span>).</p><p>Ta première dérivée devrait être <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><msub><mo>∑</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>∈</mo><mi mathvariant="script">Y</mi></mrow></msub><mfrac><mrow><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msup><mtext mathvariant="bold">w</mtext><mi mathvariant="normal">⊤</mi></msup><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>−</mo><msup><mi>r</mi><mi>t</mi></msup><mo>+</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∥</mi><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial E}{\partial w_i} = \sum_{\textbf{x}^t \in \mathcal{Y}} \frac{ x_i  (\textbf{w}^\top \textbf{x}^t -r^t + w_0)  }{\| \textbf{x}^t \|^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3252em;vertical-align:-0.4451em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em">∂</span><span class="mord mathnormal mtight" style="margin-right:0.05764em">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.6539em;vertical-align:-0.52em"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.208em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.08222em">Y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3678em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1339em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∥</span><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mtight">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">w</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.927em"><span style="top:-2.931em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8703em"><span style="top:-2.931em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8703em"><span style="top:-2.931em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q4b-question">Q4B Question<a href="#q4b-question" class="hash-link" aria-label="Direct link to Q4B Question" title="Direct link to Q4B Question">​</a></h3>
<p>Implémentez une classe Python correspondant à ce discriminant linéaire, en programmant les fonctions <code>fit</code>, <code>predict</code> et <code>score</code> de l&#x27;interface Scikit-learn ci-dessous.</p>
<p>Pour vous aider avec votre implémentation, on a fourni deux jeux de données pour la classification binaire. Ces données sont montrées ci-dessous.</p>
<p><img loading="lazy" alt="fig3" src="/assets/images/d2q4_public_datasets-60ee91170a2cccce9efa56fca528a23d.png" width="1200" height="600" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q4b-solution">Q4B Solution<a href="#q4b-solution" class="hash-link" aria-label="Direct link to Q4B Solution" title="Direct link to Q4B Solution">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import numpy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class DiscriminantLineaire:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    def __init__(self, eta=1e-2, epsilon=1e-4, max_iter=1000):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        FR: Cette fonction est déjà codée, utilisez les variables membres</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            qu&#x27;elle définit dans les autres fonctions.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                eta (float, optionnel): Le taux d&#x27;apprentissage. 1e-2 par défaut.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                epsilon (float, optionnel): Un des paramètres du critère</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    d&#x27;arrêt. Un seuil sur la différence minimale entre les</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    erreurs faites entre deux itérations consécutives pour</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    continuer l&#x27;entraînement. 1e-2 par défaut.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                max_iter (int, optionnel): Un des paramètres du critère</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    d&#x27;arrêt. Le nombre maximum de mises à jour des poids.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    1000 par défaut.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EN: This function is already coded, use the member variables it</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            defines in other functions</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                eta (float, optional): The learning rate. Defaults to 1e-2.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                epsilon (float, optional): One of the parameters for the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    stop criterion. A threshold on the minimum error</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    difference observed between two consecutive training</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    steps. Defaults to 1e-2.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                max_iter (int, optional): One of the parameters for the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    stop criterion. The maximum number of weights updates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    allowed. Defaults to 1e-2.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self.eta = eta</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self.epsilon = epsilon</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self.max_iter = max_iter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    def fit(self, X, y):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        FR: Implémentez la fonction d&#x27;entraînement selon les équations</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        développées à la question précédente.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                X (numpy.ndarray): Une table de données de la forme (n, d), où n est le</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    nombre d&#x27;exemples et d le nombre de caractéristiques.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                y (numpy.ndarray): Une table d&#x27;étiquettes de la forme (n,), où n est le</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    nombre d&#x27;exemples.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EN: Implement the training function according to the equations</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        developed in the previous question</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                X (numpy.ndarray): An array of data of shape (n, d), where n is the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    number of examples and d the number of features.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                y (numpy.ndarray): An array of labels of shape (n,), where n is the the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    number of examples.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # FR: On initialise les poids aléatoirement</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # EN: We randomly initialize the weights</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        w = numpy.random.rand(X.shape[1] + 1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Obtenir les dimensions de X.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        n, d = X.shape</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Ajouter une colonne de 1 à X pour le biais</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        X_bias = numpy.concatenate([numpy.ones((n, 1)), X], axis=1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Convertir les étiquettes de {0, 1} à {-1, 1}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        y_transformed = 2 * y - 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        previous_error = float(&#x27;inf&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        for i in range(self.max_iter):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # FR: Implémentez ici l&#x27;entraînement dans cette boucle, qui se répète</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # `self.max_iter fois`. Vous êtes libres d&#x27;utiliser les noms de variables de</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # votre choix, sauf pour les poids qui doivent être contenus dans la</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # variable `w` définie plus haut.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # EN: Implement here the training in the following loop, which is repeated</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # `self.max_iter` times. You are free to use the variables names of your</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # choice, except for the weights, which should be put in variable `w`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # defined above.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # Calculer le h.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            h = X_bias.dot(w)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # Identifier les points mal classés.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            misclassified_indices = numpy.where(y_transformed * h &lt;= 0)[0]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # Arrêter si tous les points sont correctement classés.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if len(misclassified_indices) == 0:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                break</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # Calcul de l&#x27;erreur actuelle</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            current_error = 0.5 * numpy.sum(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                ((y_transformed[misclassified_indices] - h[misclassified_indices]) ** 2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                / (numpy.linalg.norm(X_bias[misclassified_indices], axis=1) ** 2))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # Arrêter si la différence entre les erreurs faites</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # entre deux itérations consécutives est inférieure à epsilon.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if numpy.abs(current_error - previous_error) &lt; self.epsilon:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                break</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # Mettre à jour les poids sur les données mal classées.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            misclassified_X_bias = X_bias[misclassified_indices]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            misclassified_y = y_transformed[misclassified_indices]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            gradient_w = -numpy.sum(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                (misclassified_y - w.dot(misclassified_X_bias.T))[:, None] * misclassified_X_bias</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                / numpy.linalg.norm(misclassified_X_bias, axis=1)[:, None], axis=0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            w -= self.eta * gradient_w</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # Conserver l&#x27;erreur pour la prochaine itération.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            previous_error = current_error</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # FR: Copie des poids entraînés dans une variable membre pour les conserver</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # EN: Copy trained weights in a member variable for storing</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self.w = w</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    def predict(self, X):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        FR: Implémentez la fonction de prédiction.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                X (np.ndarray): Une table de données de la forme (n, d), où n est le</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    nombre d&#x27;exemples et d le nombre de caractéristiques.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EN: Implement the predict function.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                X (np.ndarray): An array of data of shape (n, d), where n is the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    number of examples and d the number of features.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        n = X.shape[0]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        X_bias = numpy.concatenate([numpy.ones((n, 1)), X], axis=1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        h = X_bias.dot(self.w)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return (h &gt;= 0).astype(int)  # Convertir les valeurs en {0, 1}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    def score(self, X, y):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        FR: Implémentez la fonction retournant le score, soit la précision (accuracy) du</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            classifieur sur les données reçues en argument. Vous pouvez supposer que</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            `fit()` a préalablement été exécuté.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Indice : Réutiliser votre implémentation de `predict()` réduis de beaucoup</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            la taille de cette fonction !</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                X (np.ndarray): Une table de données de la forme (n, d), où n est le</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    nombre d&#x27;exemples et d le nombre de caractéristiques.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                y (np.ndarray): Une table d&#x27;étiquettes de la forme (n,), où n est le</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    nombre d&#x27;exemples.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EN: Implement the function returning the classifier score, that is the accuracy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            on data received as argument. You can assume that `fit()` has been executed</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            beforehand.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Tip: Reusing your implementation of `predict()` significantly reduces the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            size of this function!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                X (np.ndarray): An array of data of shape (n, d), where n is the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    number of examples and d the number of features.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                y (np.ndarray): An array of labels of shape (n,), where n is the the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    number of examples.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        y_pred = self.predict(X)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        accuracy = numpy.mean(y_pred == y)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return accuracy</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Pour rappel, la mise à jour des poids est donnée par :</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext mathvariant="bold">w</mtext><mo>=</mo><mtext mathvariant="bold">w</mtext><mo>+</mo><mi>η</mi><munder><mo>∑</mo><mrow><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>∈</mo><mi mathvariant="script">Y</mi></mrow></munder><mfrac><mrow><mo stretchy="false">[</mo><msup><mi>r</mi><mi>t</mi></msup><mo>−</mo><mo stretchy="false">(</mo><msup><mtext mathvariant="bold">w</mtext><mi mathvariant="normal">⊤</mi></msup><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>+</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup></mrow><mrow><mi mathvariant="normal">∥</mi><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\textbf{w} = \textbf{w} + \eta \sum_{\textbf{x}^t \in \mathcal{Y}} \frac{ [r^t - (\textbf{w}^\top \textbf{x}^t + w_0)] \textbf{x}^t}{\| \textbf{x}^t \|^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord text"><span class="mord textbf">w</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord text"><span class="mord textbf">w</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.9179em;vertical-align:-1.3918em"></span><span class="mord mathnormal" style="margin-right:0.03588em">η</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8263em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textbf mtight">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.08222em">Y</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3918em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5261em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∥</span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7196em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord textbf">w</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)]</span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p>On considère ici que <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">w</mtext></mrow><annotation encoding="application/x-tex">\textbf{w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord text"><span class="mord textbf">w</span></span></span></span></span> contient <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">w_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span> et que <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">\textbf{x}^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7936em"></span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span> contient une colonne additionnelle dont les valeurs sont
tous égales à 1.</p>
<p>Comparaisons cela à l&#x27;instruction :</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">grad_w = -np.sum(((r - h)[:, np.newaxis] * Y) / np.linalg.norm(Y, axis=1)[:, np.newaxis], axis=0)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol>
<li><code>(r - h)</code> : Ceci calcule la différence entre les vraies étiquettes <code>r</code> et les prédictions <code>h</code> pour les exemples mal classés. Dans les équations, c&#x27;est la partie <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msup><mi>r</mi><mi>t</mi></msup><mo>−</mo><mo stretchy="false">(</mo><msup><mtext mathvariant="bold">w</mtext><mi mathvariant="normal">⊤</mi></msup><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>+</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[r^t - (\textbf{w}^\top \textbf{x}^t + w_0)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0436em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord textbf">w</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)]</span></span></span></span></li>
<li><code>[:, np.newaxis]</code> : Cela transforme le vecteur résultant en une matrice colonne, permettant la diffusion lors de la multiplication avec <code>Y</code> (soit <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">Y</mi></mrow><annotation encoding="application/x-tex">\mathcal{Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7805em;vertical-align:-0.0972em"></span><span class="mord mathcal" style="margin-right:0.08222em">Y</span></span></span></span>).</li>
<li><code>(r - h)[:, np.newaxis] * Y</code> : Multiplie chaque élément de <code>r - h</code> par chaque ligne de <code>Y</code> (c&#x27;est-à-dire chaque exemple mal classé). Cela correspond à la partie <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msup><mi>r</mi><mi>t</mi></msup><mo>−</mo><mo stretchy="false">(</mo><msup><mtext mathvariant="bold">w</mtext><mi mathvariant="normal">⊤</mi></msup><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>+</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">[r^t - (\textbf{w}^\top \textbf{x}^t + w_0)] \textbf{x}^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0436em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord textbf">w</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0436em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)]</span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span> dans la formule.</li>
<li><code>np.linalg.norm(Y, axis=1)</code> : Calcule la norme (ou longueur) de chaque exemple mal classé. Cela correspond à <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∥</mi><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mi mathvariant="normal">∥</mi></mrow><annotation encoding="application/x-tex">\|\textbf{x}^t\|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0436em;vertical-align:-0.25em"></span><span class="mord">∥</span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord">∥</span></span></span></span> dans la formule.</li>
<li><code>/ np.linalg.norm(Y, axis=1)[:, np.newaxis]</code> : Divise chaque élément du produit précédent par la norme de l&#x27;exemple correspondant, implémentant la division dans la formule.</li>
<li><code>np.sum(..., axis=0)</code> : Somme tous les résultats pour chaque caractéristique (ou dimension), ce qui correspond à la sommation sur tous les <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mtext mathvariant="bold">x</mtext><mi>t</mi></msup><mo>∈</mo><mi mathvariant="script">Y</mi></mrow><annotation encoding="application/x-tex">\textbf{x}^t \in \mathcal{Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8327em;vertical-align:-0.0391em"></span><span class="mord"><span class="mord text"><span class="mord textbf">x</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7805em;vertical-align:-0.0972em"></span><span class="mord mathcal" style="margin-right:0.08222em">Y</span></span></span></span> dans la formule.</li>
<li><code>-</code> : Le signe négatif est dû à une légère incohérence. Techniquement, la formule de mise à jour est pour minimiser l&#x27;erreur, donc on doit aller dans la direction opposée du gradient pour descendre. Si le gradient pointe dans la direction d&#x27;augmentation de l&#x27;erreur, nous voulons aller dans la direction opposée pour la réduire.</li>
</ol>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import numpy as np</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X1 = np.array([[-2.35046948, 3.19740734],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [-1.26025181, 2.2656768],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [2.32263929, 1.27196654],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [-1.90537543, 1.28636907],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [2.32632655, 1.71341991],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [1.47935876, 2.84746861],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [-2.29210837, 2.23646358],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [1.59528917, 1.81200673]])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">y1 = np.array([0, 0, 1, 0, 1, 1, 0, 1])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X2 = np.array([[-1.32649983, 1.12954672],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [-0.55669568, 0.54121086],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [0.7200127, -0.82710244],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [-1.2547988, 1.5040504],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [0.64249641, -0.79448904],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [0.27174921, -0.58527124],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [-1.12533616, 1.46052906],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [1.13728051, -1.08448715],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [1.67825313, -1.40616691],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [-1.44219628, 1.64112914]])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">y2 = np.array([0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              1, 1, 1, 0])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">clf = DiscriminantLineaire()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">clf.fit(X1, y1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">y1_pred = clf.predict(X1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(f&quot;y1={y1}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(f&quot;y1_pred={y1_pred}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">score1 = clf.score(X1, y1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(f&quot;Exactitude du modèle sur public1 : {score1}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">clf = DiscriminantLineaire()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">clf.fit(X2, y2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">score2 = clf.score(X2, y2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(f&quot;Exactitude du modèle sur public2 : {score2}&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-txt codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-txt codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">y1=[0 0 1 0 1 1 0 1]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">y1_pred=[0 0 1 0 1 1 0 1]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Exactitude du modèle sur public1 : 1.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Exactitude du modèle sur public2 : 1.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="d2q5---implémentation-dun-classifieur-un-contre-tous">D2Q5 - Implémentation d&#x27;un classifieur un contre tous<a href="#d2q5---implémentation-dun-classifieur-un-contre-tous" class="hash-link" aria-label="Direct link to D2Q5 - Implémentation d&#x27;un classifieur un contre tous" title="Direct link to D2Q5 - Implémentation d&#x27;un classifieur un contre tous">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="code-préambule-d2q5">Code préambule (D2Q5)<a href="#code-préambule-d2q5" class="hash-link" aria-label="Direct link to Code préambule (D2Q5)" title="Direct link to Code préambule (D2Q5)">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import collections</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import os</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import matplotlib</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import numpy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from matplotlib import pyplot</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.linear_model import LogisticRegression</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">%matplotlib inline</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">matplotlib.rcParams[&quot;figure.figsize&quot;] = (15.0, 10.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">_times = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def checkTime(maxduration, question):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    duration = _times[-1] - _times[-2]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if duration &gt; maxduration:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        print(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            f&quot;[ATTENTION] Votre code pour la question {question} met trop de temps à &quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            f&quot;s&#x27;exécuter! Le temps maximum permis est de {maxduration:.4f} secondes, &quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            f&quot;mais votre code a requis {duration:.4f} secondes! Assurez-vous que vous &quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;ne faites pas d&#x27;appels bloquants (par exemple à show()) dans cette boucle!&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def load_dataset(path):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FR: Charger le jeu de données dans le répertoire donné. Le répertoire doit contient</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    les fichiers `features.npy` et `targets.npy`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            path (str): Le chemin du fichier au répertoire de jeu de données.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    EN: Load the dataset stored in the given directory. The directory must contain</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        the files `features.npy` and `targets.npy`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            path (str): The path to the dataset directory.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    X = numpy.load(os.path.join(path, &quot;features.npy&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y = numpy.load(os.path.join(path, &quot;targets.npy&quot;))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    return X, y</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q5-question">Q5 Question<a href="#q5-question" class="hash-link" aria-label="Direct link to Q5 Question" title="Direct link to Q5 Question">​</a></h3>
<p>Implémentez une classe Python encapsulant le classifieur <code>LogisticRegression</code> de Scikit-learn utilisé précédemment, pour un traitement de type un contre tous pour faire du classement multiclasses. Programmez au minimum les fonctions <code>fit</code>, <code>predict</code> et <code>score</code> de l&#x27;interface de modèles de Scikit-learn.</p>
<p>Pour vous aider avec votre implémentation, nous vous fournissons deux jeux de données de classement binaire. Les données de ces jeux sont montrées ci-dessous.</p>
<p><img loading="lazy" alt="gif4" src="/assets/images/d2q5_public_datasets-49d504ef22dc0ec9f38d0629119c264c.png" width="1800" height="600" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q5-solution">Q5 Solution<a href="#q5-solution" class="hash-link" aria-label="Direct link to Q5 Solution" title="Direct link to Q5 Solution">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import numpy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.linear_model import LogisticRegression</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">class ClassifieurUnContreTous:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FR: Implémentation du classifieur un contre tous utilisant le LogisticRegression de</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        scikit-learn.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    EN: Implementation of the one-against-all classifier the LogisticRegression from</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        scikit-learn.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    def __init__(self, n_classes, **kwargs):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        FR: Constructeur de la classe. Cette fonction est déjà codée pour vous, vous</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            n&#x27;avez qu&#x27;à utiliser les variables membres qu&#x27;elle définit dans les autres</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            fonctions.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                n_classes (int): Le nombre de classes à distinguer.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                **kwargs: Arbitrary keyword arguments. Ces arguments sont passés au</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    constructeur de LogisticRegression.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EN: Class constructor. This function is already coded for you, you just have to</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            use the member variables it defines in the other functions.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                n_classes (int): The number of classes to distinguish.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                **kwargs: Arbitrary keyword arguments. These are passed to the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    LogisticRegression constructor.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self.n_classes = n_classes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self.estimators = [LogisticRegression(**kwargs) for c in range(n_classes)]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    def fit(self, X, y):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        FR: Entraînez chaque classifieur (contenu dans self.estimators) pour distinguer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        une seule classe des autres.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                X (numpy.ndarray): Une table de données de la forme (n, d), où n est le</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    nombre d&#x27;exemples et d le nombre de caractéristiques.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                y (numpy.ndarray): Une table d&#x27;étiquettes de la forme (n,), où n est le</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    nombre d&#x27;exemples.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EN: Train each classifier (contained in self.estimators) to distinguish a single</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        class from the others.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                X (numpy.ndarray): An array of data of shape (n, d), where n is the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    number of examples and d the number of features.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                y (numpy.ndarray): An array of labels of shape (n,), where n is the the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    number of examples.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Convertir les étiquettes pour chaque classe cible en un format binaire</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # (1 pour la classe cible, 0 pour toutes les autres) et entraîner un classifieur</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # sur ce jeu de données binaire.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        for i, est in enumerate(self.estimators):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            # Création d&#x27;un vecteur de labels où les instances de la classe actuelle sont 1 et toutes les autres sont 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            y_binary = np.where(y == i, 1, 0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            est.fit(X, y_binary)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    def predict(self, X):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        FR: Faire les prédictions selon l&#x27;approche un contre tous. Vous pouvez supposer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        que `fit()` a préalablement été exécuté.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                X (np.ndarray): Une table de données de la forme (n, d), où n est le</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    nombre d&#x27;exemples et d le nombre de caractéristiques.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EN: Make predictions using the one vs. all approach. You can assume that `fit()`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        has been previously executed.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                X (np.ndarray): An array of data of shape (n, d), where n is the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    number of examples and d the number of features.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Utiliser la méthode `predict_proba` pour obtenir la probabilité qu&#x27;une instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # appartienne à la classe cible et prendre ensuite l&#x27;argmax pour obtenir la</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # classe avec la plus grande probabilité pour chaque instance.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # Prédiction de probabilité pour chaque classifieur</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        probabilities = np.array([est.predict_proba(X)[:, 1] for est in self.estimators]).T</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        # La prédiction finale est la classe avec la plus grande probabilité pour chaque instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return np.argmax(probabilities, axis=1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    def score(self, X, y):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        FR: Implémentez ici le calcul du score utilisant l&#x27;approche un contre tous. Ce</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        score correspond à la précision (accuracy) moyenne Vous pouvez supposer que</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        `fit()` a préalablement été exécuté.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Indice : Réutiliser votre implémentation de `predict()` réduit de beaucoup</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            la taille de cette fonction !</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                X (np.ndarray): Une table de données de la forme (n, d), où n est le</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    nombre d&#x27;exemples et d le nombre de caractéristiques.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                y (np.ndarray): Une table d&#x27;étiquettes de la forme (n,), où n est le</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    nombre d&#x27;exemples.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EN: Implement here the calculation of the score using the one vs. all approach.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        This score corresponds to the average accuracy You can assume that `fit()` has</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        been executed beforehand.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Tip: Reusing your implementation of `predict()` significantly reduces the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            size of this function!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Args:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                X (np.ndarray): An array of data of shape (n, d), where n is the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    number of examples and d the number of features.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                y (np.ndarray): An array of labels of shape (n,), where n is the the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    number of examples.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        y_pred = self.predict(X)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return np.mean(y_pred == y)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import numpy as np</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X1 = np.array([[-6.93018878, -0.28334284],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [-6.44758292, -0.86889427],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [-6.25263121, 0.01138177],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [-3.06133092, 9.97753306],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [-2.5297393, 9.04123325],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [0.58245648, -6.33307394],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [-5.47421076, -3.56585833],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [-6.73618374, -2.00196916],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [-6.32223027, 0.92769025],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [-0.98413783, -7.20517672],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [-4.1747874, 8.16241714],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              [0.31026681, -5.87760172]])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">y1 = np.array([2, 2, 2, 0, 0, 1, 0, 0,... 1, 0, 1])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X2 = np.array([[ 1.95624482,  1.01268368,  2.17845746],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [-1.3470514,   1.70888558, -1.81589231],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [-1.55198694, -0.01412031, -2.12025435],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [ 2.13727237,  1.01806799,  1.80394315],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [-2.26076938,  0.31156544, -1.86415685],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [-3.32166581,  2.14721561, -2.12641434],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [ 1.75763728,  1.12849801,  2.08245277],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [ 3.26562749, -0.1680842,   2.14228017],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [ 4.02440239,  2.28474973,  1.80410693],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> [ 1.13217511, -1.38111118,  1.44545592]])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">y2 = np.array([1, 0, 0, 1, 0, 0, 1,..., 1, 1])</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">clf = ClassifieurUnContreTous(n_classes=3)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">clf.fit(X1, y1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">score1 = clf.score(X1, y1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(f&quot;Exactitude du modèle sur public1 : {score1}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">clf = ClassifieurUnContreTous(n_classes=2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">clf.fit(X2, y2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">score2 = clf.score(X2, y2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">print(f&quot;Exactitude du modèle sur public2 : {score2}&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Exactitude du modèle sur public1 : 1.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Exactitude du modèle sur public2 : 0.99</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="d2q6---k-plus-proches-voisins">D2Q6 - k-plus proches voisins<a href="#d2q6---k-plus-proches-voisins" class="hash-link" aria-label="Direct link to D2Q6 - k-plus proches voisins" title="Direct link to D2Q6 - k-plus proches voisins">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="code-préambule-d2q6">Code préambule (d2q6)<a href="#code-préambule-d2q6" class="hash-link" aria-label="Direct link to Code préambule (d2q6)" title="Direct link to Code préambule (d2q6)">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">import time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import numpy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pandas.set_option(&#x27;display.max_colwidth&#x27;, 0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import collections</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from warnings import simplefilter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">simplefilter(action=&#x27;ignore&#x27;, category=FutureWarning) # ignore all future warnings</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from IPython import display</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import matplotlib</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">%matplotlib inline</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">matplotlib.rcParams[&#x27;figure.figsize&#x27;] = (6.4, 4.8)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from matplotlib import pyplot</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.datasets import load_iris</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.datasets import load_breast_cancer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.preprocessing import minmax_scale</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.model_selection import LeaveOneOut</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from sklearn.neighbors import KNeighborsClassifier</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">_times = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">def checkTime(maxduration, question):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    duration = _times[-1] - _times[-2]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    if duration &gt; maxduration:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        print(&quot;[ATTENTION] Votre code pour la question {0} met trop de temps à s&#x27;exécuter! &quot;.format(question)+</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Le temps maximum permis est de {0:.4f} secondes, mais votre code a requis {1:.4f} secondes! &quot;.format(maxduration,duration)+</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Assurez-vous que vous ne faites pas d&#x27;appels bloquants (par exemple à show()) dans cette boucle!&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q6a-question">Q6A Question<a href="#q6a-question" class="hash-link" aria-label="Direct link to Q6A Question" title="Direct link to Q6A Question">​</a></h3>
<p>Utilisez une méthode de <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-plus proches voisins sur le jeu de données des Iris de Fisher en normalisant les données. Pour le classifieur, vous pouvez utiliser directement l&#x27;implémentation de scikit-learn (<code>KNeighborsClassifier</code>). Utilisez les paramètres par défaut, sauf pour :</p>
<ul>
<li>Pondération (paramètre <code>weights</code>): Testez avec les valeurs uniform et distance;</li>
<li>Nombre de voisins <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> (paramètre <code>n_neighbors</code>): Pour les deux différentes pondérations, testez avec les valeurs <!-- -->45<!-- -->.</li>
</ul>
<p>Pour l&#x27;évaluation, utilisez une méthode de type <em>leave-one-out</em>. Rapportez la performance de chaque paramétrisation dans une figure synthèse.</p>
<p>Discutez <strong>brièvement</strong> des résultats. Quel est l&#x27;impact de la disposition des données dans l&#x27;espace pour cette méthode? Quel est le nombre de voisins <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> optimal à utiliser?</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q6a-solution">Q6A Solution<a href="#q6a-solution" class="hash-link" aria-label="Direct link to Q6A Solution" title="Direct link to Q6A Solution">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Définition de la durée d&#x27;exécution maximale pour la question</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Definition of the maximum execution duration for the question</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">TMAX_Q6A = 15</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Dictionnaire pour enregistrer les paramètres évalués</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Dictionary for recording the evaluated parameters</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">results = collections.defaultdict(list)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">results[&#x27;Questions&#x27;] = [&quot;Quel est l\&#x27;impact de la disposition des données dans l&#x27;espace?&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;Quel est le K optimal?&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">results[&#x27;Discussion&#x27;] = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">_times.append(time.time())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># *** TODO Q6A ***</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Testez un classifeur K plus proches voisins sur le jeu de données</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># L&#x27;évaluation doit être faite en utilisant une approche leave-one-out</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Testez avec k = {1, 3, 5, 7, 11, 13, 15, 25, 35, 45} et avec les valeurs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># &quot;uniform&quot; et &quot;distance&quot; comme valeur de l&#x27;argument &quot;weights&quot;.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># N&#x27;oubliez pas de normaliser le jeu de données en utilisant minmax_scale!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Test a k-nearest neighbours classifier on the dataset</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># The evaluation should be done using a leave-one-out approach</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Test with k = {1, 3, 5, 7, 11, 13, 15, 25, 35, 45} and with the values</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># &quot;uniform&quot; and &quot;distance&quot; as the value of the &quot;weights&quot; argument.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Don&#x27;t forget to normalize the dataset using minmax_scale!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Stockez les performances obtenues (précision moyenne pour chaque valeur de k)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># dans deux listes, scoresUniformWeights pour weights=uniform et</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># scoresDistanceWeights pour weights=distance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Le premier élément de chacune de ces listes devrait contenir la précision</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># pour k=1, le second la précision pour k=3, et ainsi de suite.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Store the obtained performances (average precision for each value of k)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># in two lists, scoresUniformWeights for weights=uniform and</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># scoresDistanceWeights for weights=distance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># The first element of each of these lists should contain the precision</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># for k=1, the second the precision for k=3, and so on.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Charger le jeu de données Iris.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iris = load_iris()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X, y = iris.data, iris.target</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Normalisation du jeu de données avec minmax_scale().</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X_normalized = minmax_scale(X)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Valeurs de k à tester.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">k_values = [1, 3, 5, 7, 11, 13, 15, 25, 35, 45]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Instanciation de sklearn.model_selection.LeaveOneOut.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">loo = LeaveOneOut()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Vecteurs pour stocker les performances obtenues.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">scoresUniformWeights = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">scoresDistanceWeights = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for k in k_values:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    knn_uniform = KNeighborsClassifier(n_neighbors=k, weights=&#x27;uniform&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    knn_distance = KNeighborsClassifier(n_neighbors=k, weights=&#x27;distance&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    score_uniform = 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    score_distance = 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    for train_index, test_index in loo.split(X_normalized):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        X_train, X_test = X_normalized[train_index], X_normalized[test_index]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        y_train, y_test = y[train_index], y[test_index]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        knn_uniform.fit(X_train, y_train)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        knn_distance.fit(X_train, y_train)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        score_uniform += knn_uniform.score(X_test, y_test)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        score_distance += knn_distance.score(X_test, y_test)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    scoresUniformWeights.append(score_uniform / len(y))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    scoresDistanceWeights.append(score_distance / len(y))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># ******</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">_times.append(time.time())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">checkTime(TMAX_Q6A, &quot;Q6A&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># *** TODO Q6A ***</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Produisez un graphique contenant deux courbes, l&#x27;une pour weights=uniform</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># et l&#x27;autre pour weights=distance. L&#x27;axe x de la figure doit être le nombre</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># de voisins et l&#x27;axe y la performance en leave-one-out</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Produce a graph containing two curves, one for weights=uniform</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># and the other for weights=distance. The x axis of the figure should be the number</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># of neighbours and the y-axis the leave-one-out performance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">fig = pyplot.figure()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ax = fig.add_subplot(111)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ax.set_title(&#x27;Performance of KNN with Different Weights and Values of K&#x27;)  # À modifier / to be modified</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ax.plot(k_values, scoresDistanceWeights, &#x27;b--&#x27;, label=&quot;Distance weights&quot;) # À compléter / to be completed</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ax.plot(k_values, scoresUniformWeights, &#x27;r--&#x27;, label=&quot;Uniform weights&quot;)  # À compléter / to be completed</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ax.set_xticks(k_values)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ax.grid(axis=&#x27;x&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ax.set_xlabel(&quot;Values of K&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ax.set_ylabel(&quot;Accuracy (%)&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ax.legend()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.show()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># ******</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># *** TODO Q6A ***</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Répondez aux quelques questions pour la discussion</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Answer a few questions for discussion</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Quel est l&#x27;impact de la disposition des données dans l&#x27;espace?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># What is the impact of the layout of the data in the space?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">answer = &quot;Les performances relativement élevées (&gt;= 94%) suggèrent que les différentes classes \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          sont généralement bien séparées dans l&#x27;espace des caractéristiques.&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">results[&#x27;Discussion&#x27;].append(answer)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Quel est le nombre de voisins $k$ optimal à utiliser?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># What is the optimal number of $k$ neighbors to use?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">answer = &quot;La valeur optimale de k est k=7 affichant \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          des exactitudes de 96,7% avec `weights=&#x27;uniform&#x27;` \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          et 96,0% avec `weights=&#x27;distance&#x27;`. Notez que nous obtenons les \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          mêmes performances avec k=13.&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">results[&#x27;Discussion&#x27;].append(answer)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># ******</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Affichage des erreurs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df = pandas.DataFrame(results)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">display.display(df)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="png" src="/assets/images/output_50_0-3607e5b53d8ebf7566dacac4dd628e66.png" width="584" height="455" class="img_ev3q"></p>
<ul>
<li>Quel est l&#x27;impact de la disposition des données dans l&#x27;espace? Les performances relativement élevées (&gt;= 94%)
suggèrent que les différentes classes sont généralement bien séparées dans l&#x27;espace des caractéristiques.</li>
<li>Quel est le K optimal? La valeur optimale de k est k=7 affichant des exactitudes de 96,7% avec <code>weights=&#x27;uniform&#x27;</code>
et 96,0% avec <code>weights=&#x27;distance&#x27;</code>. Notez que nous obtenons les mêmes performances avec k=13.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q6b-question">Q6B Question<a href="#q6b-question" class="hash-link" aria-label="Direct link to Q6B Question" title="Direct link to Q6B Question">​</a></h3>
<p>Utilisez une méthode de <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span>-plus proches voisins sur le jeu de données <em>Breast Cancer Wisconsin</em> en normalisant les données. Pour le classifieur, vous pouvez utiliser directement l&#x27;implémentation de scikit-learn (<code>KNeighborsClassifier</code>). Utilisez les paramètres par défaut, sauf pour :</p>
<ul>
<li>Pondération (paramètre <code>weights</code>): Testez avec les valeurs <code>uniform</code> et <code>distance</code>;</li>
<li>Nombre de voisins <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> (paramètre <code>n_neighbors</code>): Pour les deux différentes pondérations, testez avec les valeurs <!-- -->45<!-- -->.</li>
</ul>
<p>Pour l&#x27;évaluation, utilisez une méthode de type <em>leave-one-out</em>. Rapportez la performance de chaque paramétrisation dans une figure synthèse.</p>
<p>Discutez <u><strong>brièvement</strong></u> des résultats. Quel est l&#x27;impact de la disposition des données dans l&#x27;espace pour cette méthode? Quel est le nombre de voisins <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span> optimal à utiliser?</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q6b-solution">Q6B Solution<a href="#q6b-solution" class="hash-link" aria-label="Direct link to Q6B Solution" title="Direct link to Q6B Solution">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Définition de la durée d&#x27;exécution maximale pour la question</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Definition of the maximum execution duration for the question</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">TMAX_Q6B = 260</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Dictionnaire pour enregistrer les paramètres évalués</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Dictionary for recording the evaluated parameters</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">results = collections.defaultdict(list)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">results[&#x27;Questions&#x27;] = [&quot;Quel est l\&#x27;impact de la disposition des données dans l&#x27;espace?&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        &quot;Quel est le K optimal?&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                       ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">results[&#x27;Discussion&#x27;] = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">_times.append(time.time())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># *** TODO Q6B ***</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Testez un classifeur K plus proches voisins sur le jeu de données</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># L&#x27;évaluation doit être faite en utilisant une approche leave-one-out</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Testez avec k = {1, 3, 5, 7, 11, 13, 15, 25, 35, 45} et avec les valeurs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># &quot;uniform&quot; et &quot;distance&quot; comme valeur de l&#x27;argument &quot;weights&quot;.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># N&#x27;oubliez pas de normaliser le jeu de données en utilisant minmax_scale!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Test a k-nearest neighbours classifier on the dataset</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># The evaluation should be done using a leave-one-out approach</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Test with k = {1, 3, 5, 7, 11, 13, 15, 25, 35, 45} and with the values</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># &quot;uniform&quot; and &quot;distance&quot; as the value of the &quot;weights&quot; argument.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Don&#x27;t forget to normalize the dataset using minmax_scale!</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Stockez les performances obtenues (précision moyenne pour chaque valeur de k)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># dans deux listes, scoresUniformWeights pour weights=uniform et</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># scoresDistanceWeights pour weights=distance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Le premier élément de chacune de ces listes devrait contenir la précision</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># pour k=1, le second la précision pour k=3, et ainsi de suite.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Store the obtained performances (average precision for each value of k)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># in two lists, scoresUniformWeights for weights=uniform and</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># scoresDistanceWeights for weights=distance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># The first element of each of these lists should contain the precision</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># for k=1, the second the precision for k=3, and so on.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Charger le jeu de données Breast Cancer Wisconsin</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data = load_breast_cancer()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X, y = data.data, data.target</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Normalisation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X_normalized = minmax_scale(X)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Valeurs de k à tester.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">k_values = [1, 3, 5, 7, 11, 13, 15, 25, 35, 45]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Instanciation de sklearn.model_selection.LeaveOneOut.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">loo = LeaveOneOut()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Vecteurs pour stocker les performances obtenues.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">scoresUniformWeights = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">scoresDistanceWeights = []</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">loo = LeaveOneOut()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for k in k_values:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    knn_uniform = KNeighborsClassifier(n_neighbors=k, weights=&#x27;uniform&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    knn_distance = KNeighborsClassifier(n_neighbors=k, weights=&#x27;distance&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    score_uniform = 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    score_distance = 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    for train_index, test_index in loo.split(X_normalized):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        X_train, X_test = X_normalized[train_index], X_normalized[test_index]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        y_train, y_test = y[train_index], y[test_index]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        knn_uniform.fit(X_train, y_train)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        knn_distance.fit(X_train, y_train)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        score_uniform += knn_uniform.score(X_test, y_test)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        score_distance += knn_distance.score(X_test, y_test)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    scoresUniformWeights.append(score_uniform / len(y))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    scoresDistanceWeights.append(score_distance / len(y))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># ******</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">_times.append(time.time())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">checkTime(TMAX_Q6B, &quot;Q6B&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># *** TODO Q6B ***</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Produisez un graphique contenant deux courbes, l&#x27;une pour weights=uniform</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># et l&#x27;autre pour weights=distance. L&#x27;axe x de la figure doit être le nombre</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># de voisins et l&#x27;axe y la performance en leave-one-out</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Produce a graph containing two curves, one for weights=uniform</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># and the other for weights=distance. The x axis of the figure should be the number</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># of neighbours and the y-axis the leave-one-out performance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">fig = pyplot.figure()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ax = fig.add_subplot(111)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ax.set_title(&#x27;Performance of KNN with Different Weights and Values of K on Breast Cancer Data&#x27;)  # À modifier / to be modified</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ax.plot(k_values, scoresDistanceWeights, &#x27;b--&#x27;, label=&quot;Distance weights&quot;) # À compléter / to be completed</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ax.plot(k_values, scoresUniformWeights, &#x27;r--&#x27;, label=&quot;Uniform weights&quot;) # À compléter / to be completed</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ax.set_xticks(k_values)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ax.grid(axis=&#x27;x&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ax.set_xlabel(&quot;Values of K&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ax.set_ylabel(&quot;Accuracy (%)&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ax.legend()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pyplot.show()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># ******</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># *** TODO Q6B ***</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Répondez aux quelques questions pour la discussion</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Answer a few questions for discussion</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Quel est l&#x27;impact de la disposition des données dans l&#x27;espace?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># What is the impact of the layout of the data in the space?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">answer = &quot;La performance élevée (&gt; 95%) suggère que les échantillons de différentes classes \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (malins vs. bénins) sont généralement bien séparés.&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">results[&#x27;Discussion&#x27;].append(answer)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Quel est le nombre de voisins $k$ optimal à utiliser?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># What is the optimal number of $k$ neighbors to use?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">answer = &quot;k=15 avec une exactitude de 97,7% avec `weights=&#x27;distance&#x27;`.&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">results[&#x27;Discussion&#x27;].append(answer)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># ******</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Affichage des erreurs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df = pandas.DataFrame(results)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">display.display(df)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="png" src="/assets/images/output_53_0-5d692df7140e7dcd1fd8622852b2c989.png" width="705" height="455" class="img_ev3q"></p>
<ul>
<li>Quel est l&#x27;impact de la disposition des données dans l&#x27;espace?
La performance élevée (&gt; 95%) suggère que les échantillons de différentes classes (malins vs. bénins) sont généralement bien séparés.</li>
<li>Quel est le <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span> optimal? <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span>=15 avec une exactitude de 97,7% avec <code>weights=&#x27;distance&#x27;</code>.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/courses/gif-7005/devoir-2.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/courses/gif-7005/devoir-1"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Devoir 1 du 4 octobre 2023</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/courses/gif-7005/devoir-3"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Devoir 3 du 8 novembre 2023</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#d2q1---estimation-de-densité" class="table-of-contents__link toc-highlight">D2Q1 - Estimation de densité</a><ul><li><a href="#code-préambule" class="table-of-contents__link toc-highlight">Code préambule</a></li><li><a href="#q1a---question" class="table-of-contents__link toc-highlight">Q1A - Question</a></li><li><a href="#q1a---solution" class="table-of-contents__link toc-highlight">Q1A - Solution</a></li><li><a href="#q1b-question" class="table-of-contents__link toc-highlight">Q1B Question</a></li><li><a href="#q1b-solution" class="table-of-contents__link toc-highlight">Q1B Solution</a></li><li><a href="#q1c-question" class="table-of-contents__link toc-highlight">Q1C Question</a></li><li><a href="#q1c-solution" class="table-of-contents__link toc-highlight">Q1C Solution</a></li><li><a href="#q1d-question" class="table-of-contents__link toc-highlight">Q1D Question</a></li><li><a href="#q1d-solution" class="table-of-contents__link toc-highlight">Q1D Solution</a></li><li><a href="#avantage-des-k-ppv-pour-le-classement-et-la-régression" class="table-of-contents__link toc-highlight">Avantage des k-PPV pour le classement et la régression</a></li><li><a href="#inconvénient-des-k-ppv-pour-lestimation-de-densité" class="table-of-contents__link toc-highlight">Inconvénient des k-PPV pour l&#39;estimation de densité</a></li></ul></li><li><a href="#d2q2---tracer-les-régions-de-décisions" class="table-of-contents__link toc-highlight">D2Q2 - Tracer les régions de décisions</a><ul><li><a href="#code-préambule-d2q2" class="table-of-contents__link toc-highlight">Code préambule (D2Q2)</a></li><li><a href="#q2-exercice" class="table-of-contents__link toc-highlight">Q2 Exercice</a></li><li><a href="#q2-solution" class="table-of-contents__link toc-highlight">Q2 Solution</a></li></ul></li><li><a href="#d2q3---évaluation-des-discriminants-linéaires" class="table-of-contents__link toc-highlight">D2Q3 - Évaluation des discriminants linéaires</a><ul><li><a href="#code-préambule-d2q3" class="table-of-contents__link toc-highlight">Code préambule (D2Q3)</a></li><li><a href="#q3-question" class="table-of-contents__link toc-highlight">Q3 Question</a></li></ul></li><li><a href="#d2q4---implémentation-dun-discriminant-linéaire" class="table-of-contents__link toc-highlight">D2Q4 - Implémentation d&#39;un discriminant linéaire</a><ul><li><a href="#code-préambule-1" class="table-of-contents__link toc-highlight">Code préambule</a></li><li><a href="#q4a-question" class="table-of-contents__link toc-highlight">Q4A Question</a></li><li><a href="#q4a-solution" class="table-of-contents__link toc-highlight">Q4A Solution</a></li><li><a href="#q4b-question" class="table-of-contents__link toc-highlight">Q4B Question</a></li><li><a href="#q4b-solution" class="table-of-contents__link toc-highlight">Q4B Solution</a></li></ul></li><li><a href="#d2q5---implémentation-dun-classifieur-un-contre-tous" class="table-of-contents__link toc-highlight">D2Q5 - Implémentation d&#39;un classifieur un contre tous</a><ul><li><a href="#code-préambule-d2q5" class="table-of-contents__link toc-highlight">Code préambule (D2Q5)</a></li><li><a href="#q5-question" class="table-of-contents__link toc-highlight">Q5 Question</a></li><li><a href="#q5-solution" class="table-of-contents__link toc-highlight">Q5 Solution</a></li></ul></li><li><a href="#d2q6---k-plus-proches-voisins" class="table-of-contents__link toc-highlight">D2Q6 - k-plus proches voisins</a><ul><li><a href="#code-préambule-d2q6" class="table-of-contents__link toc-highlight">Code préambule (d2q6)</a></li><li><a href="#q6a-question" class="table-of-contents__link toc-highlight">Q6A Question</a></li><li><a href="#q6a-solution" class="table-of-contents__link toc-highlight">Q6A Solution</a></li><li><a href="#q6b-question" class="table-of-contents__link toc-highlight">Q6B Question</a></li><li><a href="#q6b-solution" class="table-of-contents__link toc-highlight">Q6B Solution</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Alain Boisvert. Construit avec Docusaurus.</div></div></div></footer></div>
</body>
</html>